var nw=Object.defineProperty;var rw=(t,e,n)=>e in t?nw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Rt=(t,e,n)=>rw(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function sw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vg={exports:{}},Yl={},Og={exports:{}},ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xa=Symbol.for("react.element"),iw=Symbol.for("react.portal"),aw=Symbol.for("react.fragment"),ow=Symbol.for("react.strict_mode"),lw=Symbol.for("react.profiler"),cw=Symbol.for("react.provider"),uw=Symbol.for("react.context"),dw=Symbol.for("react.forward_ref"),hw=Symbol.for("react.suspense"),mw=Symbol.for("react.memo"),fw=Symbol.for("react.lazy"),bf=Symbol.iterator;function pw(t){return t===null||typeof t!="object"?null:(t=bf&&t[bf]||t["@@iterator"],typeof t=="function"?t:null)}var Mg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fg=Object.assign,Lg={};function vi(t,e,n){this.props=t,this.context=e,this.refs=Lg,this.updater=n||Mg}vi.prototype.isReactComponent={};vi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ug(){}Ug.prototype=vi.prototype;function zd(t,e,n){this.props=t,this.context=e,this.refs=Lg,this.updater=n||Mg}var qd=zd.prototype=new Ug;qd.constructor=zd;Fg(qd,vi.prototype);qd.isPureReactComponent=!0;var Nf=Array.isArray,$g=Object.prototype.hasOwnProperty,Hd={current:null},Bg={key:!0,ref:!0,__self:!0,__source:!0};function zg(t,e,n){var r,s={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)$g.call(e,r)&&!Bg.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),h=0;h<c;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Xa,type:t,key:a,ref:o,props:s,_owner:Hd.current}}function gw(t,e){return{$$typeof:Xa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xa}function xw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jf=/\/+/g;function Hc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xw(""+t.key):e.toString(36)}function Wo(t,e,n,r,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Xa:case iw:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Hc(o,0):r,Nf(s)?(n="",t!=null&&(n=t.replace(jf,"$&/")+"/"),Wo(s,e,n,"",function(h){return h})):s!=null&&(Qd(s)&&(s=gw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(jf,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Nf(t))for(var c=0;c<t.length;c++){a=t[c];var u=r+Hc(a,c);o+=Wo(a,e,n,u,s)}else if(u=pw(t),typeof u=="function")for(t=u.call(t),c=0;!(a=t.next()).done;)a=a.value,u=r+Hc(a,c++),o+=Wo(a,e,n,u,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Eo(t,e,n){if(t==null)return t;var r=[],s=0;return Wo(t,r,"","",function(a){return e.call(n,a,s++)}),r}function yw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kt={current:null},Ko={transition:null},vw={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:Ko,ReactCurrentOwner:Hd};function qg(){throw Error("act(...) is not supported in production builds of React.")}ve.Children={map:Eo,forEach:function(t,e,n){Eo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Eo(t,function(){e++}),e},toArray:function(t){return Eo(t,function(e){return e})||[]},only:function(t){if(!Qd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ve.Component=vi;ve.Fragment=aw;ve.Profiler=lw;ve.PureComponent=zd;ve.StrictMode=ow;ve.Suspense=hw;ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vw;ve.act=qg;ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Fg({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Hd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)$g.call(e,u)&&!Bg.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:Xa,type:t.type,key:s,ref:a,props:r,_owner:o}};ve.createContext=function(t){return t={$$typeof:uw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:cw,_context:t},t.Consumer=t};ve.createElement=zg;ve.createFactory=function(t){var e=zg.bind(null,t);return e.type=t,e};ve.createRef=function(){return{current:null}};ve.forwardRef=function(t){return{$$typeof:dw,render:t}};ve.isValidElement=Qd;ve.lazy=function(t){return{$$typeof:fw,_payload:{_status:-1,_result:t},_init:yw}};ve.memo=function(t,e){return{$$typeof:mw,type:t,compare:e===void 0?null:e}};ve.startTransition=function(t){var e=Ko.transition;Ko.transition={};try{t()}finally{Ko.transition=e}};ve.unstable_act=qg;ve.useCallback=function(t,e){return Kt.current.useCallback(t,e)};ve.useContext=function(t){return Kt.current.useContext(t)};ve.useDebugValue=function(){};ve.useDeferredValue=function(t){return Kt.current.useDeferredValue(t)};ve.useEffect=function(t,e){return Kt.current.useEffect(t,e)};ve.useId=function(){return Kt.current.useId()};ve.useImperativeHandle=function(t,e,n){return Kt.current.useImperativeHandle(t,e,n)};ve.useInsertionEffect=function(t,e){return Kt.current.useInsertionEffect(t,e)};ve.useLayoutEffect=function(t,e){return Kt.current.useLayoutEffect(t,e)};ve.useMemo=function(t,e){return Kt.current.useMemo(t,e)};ve.useReducer=function(t,e,n){return Kt.current.useReducer(t,e,n)};ve.useRef=function(t){return Kt.current.useRef(t)};ve.useState=function(t){return Kt.current.useState(t)};ve.useSyncExternalStore=function(t,e,n){return Kt.current.useSyncExternalStore(t,e,n)};ve.useTransition=function(){return Kt.current.useTransition()};ve.version="18.3.1";Og.exports=ve;var V=Og.exports;const Wd=sw(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=V,_w=Symbol.for("react.element"),bw=Symbol.for("react.fragment"),Nw=Object.prototype.hasOwnProperty,jw=ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ew={key:!0,ref:!0,__self:!0,__source:!0};function Hg(t,e,n){var r,s={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Nw.call(e,r)&&!Ew.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:_w,type:t,key:a,ref:o,props:s,_owner:jw.current}}Yl.Fragment=bw;Yl.jsx=Hg;Yl.jsxs=Hg;Vg.exports=Yl;var i=Vg.exports,Tu={},Qg={exports:{}},mn={},Wg={exports:{}},Kg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,q){var X=U.length;U.push(q);e:for(;0<X;){var ee=X-1>>>1,Q=U[ee];if(0<s(Q,q))U[ee]=q,U[X]=Q,X=ee;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var q=U[0],X=U.pop();if(X!==q){U[0]=X;e:for(var ee=0,Q=U.length,B=Q>>>1;ee<B;){var Ne=2*(ee+1)-1,Je=U[Ne],Ue=Ne+1,ce=U[Ue];if(0>s(Je,X))Ue<Q&&0>s(ce,Je)?(U[ee]=ce,U[Ue]=X,ee=Ue):(U[ee]=Je,U[Ne]=X,ee=Ne);else if(Ue<Q&&0>s(ce,X))U[ee]=ce,U[Ue]=X,ee=Ue;else break e}}return q}function s(U,q){var X=U.sortIndex-q.sortIndex;return X!==0?X:U.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],f=1,g=null,p=3,N=!1,k=!1,T=!1,D=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(U){for(var q=n(h);q!==null;){if(q.callback===null)r(h);else if(q.startTime<=U)r(h),q.sortIndex=q.expirationTime,e(u,q);else break;q=n(h)}}function C(U){if(T=!1,I(U),!k)if(n(u)!==null)k=!0,O(L);else{var q=n(h);q!==null&&G(C,q.startTime-U)}}function L(U,q){k=!1,T&&(T=!1,S(x),x=-1),N=!0;var X=p;try{for(I(q),g=n(u);g!==null&&(!(g.expirationTime>q)||U&&!E());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,p=g.priorityLevel;var Q=ee(g.expirationTime<=q);q=t.unstable_now(),typeof Q=="function"?g.callback=Q:g===n(u)&&r(u),I(q)}else r(u);g=n(u)}if(g!==null)var B=!0;else{var Ne=n(h);Ne!==null&&G(C,Ne.startTime-q),B=!1}return B}finally{g=null,p=X,N=!1}}var R=!1,w=null,x=-1,_=5,j=-1;function E(){return!(t.unstable_now()-j<_)}function A(){if(w!==null){var U=t.unstable_now();j=U;var q=!0;try{q=w(!0,U)}finally{q?v():(R=!1,w=null)}}else R=!1}var v;if(typeof b=="function")v=function(){b(A)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Z=ae.port2;ae.port1.onmessage=A,v=function(){Z.postMessage(null)}}else v=function(){D(A,0)};function O(U){w=U,R||(R=!0,v())}function G(U,q){x=D(function(){U(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){k||N||(k=!0,O(L))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(U){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var X=p;p=q;try{return U()}finally{p=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,q){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var X=p;p=U;try{return q()}finally{p=X}},t.unstable_scheduleCallback=function(U,q,X){var ee=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,U){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=X+Q,U={id:f++,callback:q,priorityLevel:U,startTime:X,expirationTime:Q,sortIndex:-1},X>ee?(U.sortIndex=X,e(h,U),n(u)===null&&U===n(h)&&(T?(S(x),x=-1):T=!0,G(C,X-ee))):(U.sortIndex=Q,e(u,U),k||N||(k=!0,O(L))),U},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(U){var q=p;return function(){var X=p;p=q;try{return U.apply(this,arguments)}finally{p=X}}}})(Kg);Wg.exports=Kg;var Sw=Wg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tw=V,hn=Sw;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gg=new Set,wa={};function vs(t,e){ni(t,e),ni(t+"Capture",e)}function ni(t,e){for(wa[t]=e,t=0;t<e.length;t++)Gg.add(e[t])}var nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Iu=Object.prototype.hasOwnProperty,Iw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ef={},Sf={};function kw(t){return Iu.call(Sf,t)?!0:Iu.call(Ef,t)?!1:Iw.test(t)?Sf[t]=!0:(Ef[t]=!0,!1)}function Aw(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Cw(t,e,n,r){if(e===null||typeof e>"u"||Aw(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gt(t,e,n,r,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){It[t]=new Gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];It[e]=new Gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){It[t]=new Gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){It[t]=new Gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){It[t]=new Gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){It[t]=new Gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){It[t]=new Gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){It[t]=new Gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){It[t]=new Gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kd=/[\-:]([a-z])/g;function Gd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kd,Gd);It[e]=new Gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kd,Gd);It[e]=new Gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kd,Gd);It[e]=new Gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){It[t]=new Gt(t,1,!1,t.toLowerCase(),null,!1,!1)});It.xlinkHref=new Gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){It[t]=new Gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Yd(t,e,n,r){var s=It.hasOwnProperty(e)?It[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Cw(e,n,s,r)&&(n=null),r||s===null?kw(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var cr=Tw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,So=Symbol.for("react.element"),Os=Symbol.for("react.portal"),Ms=Symbol.for("react.fragment"),Xd=Symbol.for("react.strict_mode"),ku=Symbol.for("react.profiler"),Yg=Symbol.for("react.provider"),Xg=Symbol.for("react.context"),Jd=Symbol.for("react.forward_ref"),Au=Symbol.for("react.suspense"),Cu=Symbol.for("react.suspense_list"),Zd=Symbol.for("react.memo"),xr=Symbol.for("react.lazy"),Jg=Symbol.for("react.offscreen"),Tf=Symbol.iterator;function Bi(t){return t===null||typeof t!="object"?null:(t=Tf&&t[Tf]||t["@@iterator"],typeof t=="function"?t:null)}var Qe=Object.assign,Qc;function Xi(t){if(Qc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qc=e&&e[1]||""}return`
`+Qc+t}var Wc=!1;function Kc(t,e){if(!t||Wc)return"";Wc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),a=r.stack.split(`
`),o=s.length-1,c=a.length-1;1<=o&&0<=c&&s[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==a[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{Wc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xi(t):""}function Pw(t){switch(t.tag){case 5:return Xi(t.type);case 16:return Xi("Lazy");case 13:return Xi("Suspense");case 19:return Xi("SuspenseList");case 0:case 2:case 15:return t=Kc(t.type,!1),t;case 11:return t=Kc(t.type.render,!1),t;case 1:return t=Kc(t.type,!0),t;default:return""}}function Pu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ms:return"Fragment";case Os:return"Portal";case ku:return"Profiler";case Xd:return"StrictMode";case Au:return"Suspense";case Cu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Xg:return(t.displayName||"Context")+".Consumer";case Yg:return(t._context.displayName||"Context")+".Provider";case Jd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zd:return e=t.displayName||null,e!==null?e:Pu(t.type)||"Memo";case xr:e=t._payload,t=t._init;try{return Pu(t(e))}catch{}}return null}function Rw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pu(e);case 8:return e===Xd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dw(t){var e=Zg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function To(t){t._valueTracker||(t._valueTracker=Dw(t))}function ex(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Zg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function dl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ru(t,e){var n=e.checked;return Qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function If(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tx(t,e){e=e.checked,e!=null&&Yd(t,"checked",e,!1)}function Du(t,e){tx(t,e);var n=Vr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vu(t,e.type,Vr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function kf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vu(t,e,n){(e!=="number"||dl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ji=Array.isArray;function Ks(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ou(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Af(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(Ji(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vr(n)}}function nx(t,e){var n=Vr(e.value),r=Vr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Io,sx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Io=Io||document.createElement("div"),Io.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Io.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function _a(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vw=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(t){Vw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),oa[e]=oa[t]})});function ix(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||oa.hasOwnProperty(t)&&oa[t]?(""+e).trim():e+"px"}function ax(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ix(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Ow=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fu(t,e){if(e){if(Ow[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Lu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uu=null;function eh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $u=null,Gs=null,Ys=null;function Pf(t){if(t=eo(t)){if(typeof $u!="function")throw Error(H(280));var e=t.stateNode;e&&(e=tc(e),$u(t.stateNode,t.type,e))}}function ox(t){Gs?Ys?Ys.push(t):Ys=[t]:Gs=t}function lx(){if(Gs){var t=Gs,e=Ys;if(Ys=Gs=null,Pf(t),e)for(t=0;t<e.length;t++)Pf(e[t])}}function cx(t,e){return t(e)}function ux(){}var Gc=!1;function dx(t,e,n){if(Gc)return t(e,n);Gc=!0;try{return cx(t,e,n)}finally{Gc=!1,(Gs!==null||Ys!==null)&&(ux(),lx())}}function ba(t,e){var n=t.stateNode;if(n===null)return null;var r=tc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var Bu=!1;if(nr)try{var zi={};Object.defineProperty(zi,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",zi,zi),window.removeEventListener("test",zi,zi)}catch{Bu=!1}function Mw(t,e,n,r,s,a,o,c,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(f){this.onError(f)}}var la=!1,hl=null,ml=!1,zu=null,Fw={onError:function(t){la=!0,hl=t}};function Lw(t,e,n,r,s,a,o,c,u){la=!1,hl=null,Mw.apply(Fw,arguments)}function Uw(t,e,n,r,s,a,o,c,u){if(Lw.apply(this,arguments),la){if(la){var h=hl;la=!1,hl=null}else throw Error(H(198));ml||(ml=!0,zu=h)}}function ws(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rf(t){if(ws(t)!==t)throw Error(H(188))}function $w(t){var e=t.alternate;if(!e){if(e=ws(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return Rf(s),t;if(a===r)return Rf(s),e;a=a.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function mx(t){return t=$w(t),t!==null?fx(t):null}function fx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=fx(t);if(e!==null)return e;t=t.sibling}return null}var px=hn.unstable_scheduleCallback,Df=hn.unstable_cancelCallback,Bw=hn.unstable_shouldYield,zw=hn.unstable_requestPaint,rt=hn.unstable_now,qw=hn.unstable_getCurrentPriorityLevel,th=hn.unstable_ImmediatePriority,gx=hn.unstable_UserBlockingPriority,fl=hn.unstable_NormalPriority,Hw=hn.unstable_LowPriority,xx=hn.unstable_IdlePriority,Xl=null,Ln=null;function Qw(t){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Xl,t,void 0,(t.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:Gw,Ww=Math.log,Kw=Math.LN2;function Gw(t){return t>>>=0,t===0?32:31-(Ww(t)/Kw|0)|0}var ko=64,Ao=4194304;function Zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Zi(c):(a&=o,a!==0&&(r=Zi(a)))}else o=n&~s,o!==0?r=Zi(o):a!==0&&(r=Zi(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-An(e),s=1<<n,r|=t[n],e&=~s;return r}function Yw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xw(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-An(a),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=Yw(c,e)):u<=e&&(t.expiredLanes|=c),a&=~c}}function qu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function yx(){var t=ko;return ko<<=1,!(ko&4194240)&&(ko=64),t}function Yc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ja(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-An(e),t[e]=n}function Jw(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-An(n),a=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~a}}function nh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-An(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ke=0;function vx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wx,rh,_x,bx,Nx,Hu=!1,Co=[],jr=null,Er=null,Sr=null,Na=new Map,ja=new Map,vr=[],Zw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vf(t,e){switch(t){case"focusin":case"focusout":jr=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":Na.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ja.delete(e.pointerId)}}function qi(t,e,n,r,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},e!==null&&(e=eo(e),e!==null&&rh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function e_(t,e,n,r,s){switch(e){case"focusin":return jr=qi(jr,t,e,n,r,s),!0;case"dragenter":return Er=qi(Er,t,e,n,r,s),!0;case"mouseover":return Sr=qi(Sr,t,e,n,r,s),!0;case"pointerover":var a=s.pointerId;return Na.set(a,qi(Na.get(a)||null,t,e,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,ja.set(a,qi(ja.get(a)||null,t,e,n,r,s)),!0}return!1}function jx(t){var e=es(t.target);if(e!==null){var n=ws(e);if(n!==null){if(e=n.tag,e===13){if(e=hx(n),e!==null){t.blockedOn=e,Nx(t.priority,function(){_x(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Go(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Uu=r,n.target.dispatchEvent(r),Uu=null}else return e=eo(n),e!==null&&rh(e),t.blockedOn=n,!1;e.shift()}return!0}function Of(t,e,n){Go(t)&&n.delete(e)}function t_(){Hu=!1,jr!==null&&Go(jr)&&(jr=null),Er!==null&&Go(Er)&&(Er=null),Sr!==null&&Go(Sr)&&(Sr=null),Na.forEach(Of),ja.forEach(Of)}function Hi(t,e){t.blockedOn===e&&(t.blockedOn=null,Hu||(Hu=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,t_)))}function Ea(t){function e(s){return Hi(s,t)}if(0<Co.length){Hi(Co[0],t);for(var n=1;n<Co.length;n++){var r=Co[n];r.blockedOn===t&&(r.blockedOn=null)}}for(jr!==null&&Hi(jr,t),Er!==null&&Hi(Er,t),Sr!==null&&Hi(Sr,t),Na.forEach(e),ja.forEach(e),n=0;n<vr.length;n++)r=vr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vr.length&&(n=vr[0],n.blockedOn===null);)jx(n),n.blockedOn===null&&vr.shift()}var Xs=cr.ReactCurrentBatchConfig,gl=!0;function n_(t,e,n,r){var s=ke,a=Xs.transition;Xs.transition=null;try{ke=1,sh(t,e,n,r)}finally{ke=s,Xs.transition=a}}function r_(t,e,n,r){var s=ke,a=Xs.transition;Xs.transition=null;try{ke=4,sh(t,e,n,r)}finally{ke=s,Xs.transition=a}}function sh(t,e,n,r){if(gl){var s=Qu(t,e,n,r);if(s===null)au(t,e,r,xl,n),Vf(t,r);else if(e_(s,t,e,n,r))r.stopPropagation();else if(Vf(t,r),e&4&&-1<Zw.indexOf(t)){for(;s!==null;){var a=eo(s);if(a!==null&&wx(a),a=Qu(t,e,n,r),a===null&&au(t,e,r,xl,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else au(t,e,r,null,n)}}var xl=null;function Qu(t,e,n,r){if(xl=null,t=eh(r),t=es(t),t!==null)if(e=ws(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xl=t,null}function Ex(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qw()){case th:return 1;case gx:return 4;case fl:case Hw:return 16;case xx:return 536870912;default:return 16}default:return 16}}var _r=null,ih=null,Yo=null;function Sx(){if(Yo)return Yo;var t,e=ih,n=e.length,r,s="value"in _r?_r.value:_r.textContent,a=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[a-r];r++);return Yo=s.slice(t,1<r?1-r:void 0)}function Xo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Po(){return!0}function Mf(){return!1}function fn(t){function e(n,r,s,a,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Po:Mf,this.isPropagationStopped=Mf,this}return Qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Po)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Po)},persist:function(){},isPersistent:Po}),e}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=fn(wi),Za=Qe({},wi,{view:0,detail:0}),s_=fn(Za),Xc,Jc,Qi,Jl=Qe({},Za,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qi&&(Qi&&t.type==="mousemove"?(Xc=t.screenX-Qi.screenX,Jc=t.screenY-Qi.screenY):Jc=Xc=0,Qi=t),Xc)},movementY:function(t){return"movementY"in t?t.movementY:Jc}}),Ff=fn(Jl),i_=Qe({},Jl,{dataTransfer:0}),a_=fn(i_),o_=Qe({},Za,{relatedTarget:0}),Zc=fn(o_),l_=Qe({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),c_=fn(l_),u_=Qe({},wi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),d_=fn(u_),h_=Qe({},wi,{data:0}),Lf=fn(h_),m_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=p_[t])?!!e[t]:!1}function oh(){return g_}var x_=Qe({},Za,{key:function(t){if(t.key){var e=m_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?f_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oh,charCode:function(t){return t.type==="keypress"?Xo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),y_=fn(x_),v_=Qe({},Jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uf=fn(v_),w_=Qe({},Za,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oh}),__=fn(w_),b_=Qe({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),N_=fn(b_),j_=Qe({},Jl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E_=fn(j_),S_=[9,13,27,32],lh=nr&&"CompositionEvent"in window,ca=null;nr&&"documentMode"in document&&(ca=document.documentMode);var T_=nr&&"TextEvent"in window&&!ca,Tx=nr&&(!lh||ca&&8<ca&&11>=ca),$f=" ",Bf=!1;function Ix(t,e){switch(t){case"keyup":return S_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fs=!1;function I_(t,e){switch(t){case"compositionend":return kx(e);case"keypress":return e.which!==32?null:(Bf=!0,$f);case"textInput":return t=e.data,t===$f&&Bf?null:t;default:return null}}function k_(t,e){if(Fs)return t==="compositionend"||!lh&&Ix(t,e)?(t=Sx(),Yo=ih=_r=null,Fs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Tx&&e.locale!=="ko"?null:e.data;default:return null}}var A_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!A_[t.type]:e==="textarea"}function Ax(t,e,n,r){ox(r),e=yl(e,"onChange"),0<e.length&&(n=new ah("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ua=null,Sa=null;function C_(t){$x(t,0)}function Zl(t){var e=$s(t);if(ex(e))return t}function P_(t,e){if(t==="change")return e}var Cx=!1;if(nr){var eu;if(nr){var tu="oninput"in document;if(!tu){var qf=document.createElement("div");qf.setAttribute("oninput","return;"),tu=typeof qf.oninput=="function"}eu=tu}else eu=!1;Cx=eu&&(!document.documentMode||9<document.documentMode)}function Hf(){ua&&(ua.detachEvent("onpropertychange",Px),Sa=ua=null)}function Px(t){if(t.propertyName==="value"&&Zl(Sa)){var e=[];Ax(e,Sa,t,eh(t)),dx(C_,e)}}function R_(t,e,n){t==="focusin"?(Hf(),ua=e,Sa=n,ua.attachEvent("onpropertychange",Px)):t==="focusout"&&Hf()}function D_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zl(Sa)}function V_(t,e){if(t==="click")return Zl(e)}function O_(t,e){if(t==="input"||t==="change")return Zl(e)}function M_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Rn=typeof Object.is=="function"?Object.is:M_;function Ta(t,e){if(Rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Iu.call(e,s)||!Rn(t[s],e[s]))return!1}return!0}function Qf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wf(t,e){var n=Qf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qf(n)}}function Rx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Rx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Dx(){for(var t=window,e=dl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=dl(t.document)}return e}function ch(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function F_(t){var e=Dx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Rx(n.ownerDocument.documentElement,n)){if(r!==null&&ch(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!t.extend&&a>r&&(s=r,r=a,a=s),s=Wf(n,a);var o=Wf(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var L_=nr&&"documentMode"in document&&11>=document.documentMode,Ls=null,Wu=null,da=null,Ku=!1;function Kf(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ku||Ls==null||Ls!==dl(r)||(r=Ls,"selectionStart"in r&&ch(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),da&&Ta(da,r)||(da=r,r=yl(Wu,"onSelect"),0<r.length&&(e=new ah("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ls)))}function Ro(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Us={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},nu={},Vx={};nr&&(Vx=document.createElement("div").style,"AnimationEvent"in window||(delete Us.animationend.animation,delete Us.animationiteration.animation,delete Us.animationstart.animation),"TransitionEvent"in window||delete Us.transitionend.transition);function ec(t){if(nu[t])return nu[t];if(!Us[t])return t;var e=Us[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Vx)return nu[t]=e[n];return t}var Ox=ec("animationend"),Mx=ec("animationiteration"),Fx=ec("animationstart"),Lx=ec("transitionend"),Ux=new Map,Gf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(t,e){Ux.set(t,e),vs(e,[t])}for(var ru=0;ru<Gf.length;ru++){var su=Gf[ru],U_=su.toLowerCase(),$_=su[0].toUpperCase()+su.slice(1);Br(U_,"on"+$_)}Br(Ox,"onAnimationEnd");Br(Mx,"onAnimationIteration");Br(Fx,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(Lx,"onTransitionEnd");ni("onMouseEnter",["mouseout","mouseover"]);ni("onMouseLeave",["mouseout","mouseover"]);ni("onPointerEnter",["pointerout","pointerover"]);ni("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ea="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ea));function Yf(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Uw(r,e,void 0,t),t.currentTarget=null}function $x(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,h=c.currentTarget;if(c=c.listener,u!==a&&s.isPropagationStopped())break e;Yf(s,c,h),a=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,h=c.currentTarget,c=c.listener,u!==a&&s.isPropagationStopped())break e;Yf(s,c,h),a=u}}}if(ml)throw t=zu,ml=!1,zu=null,t}function Oe(t,e){var n=e[Zu];n===void 0&&(n=e[Zu]=new Set);var r=t+"__bubble";n.has(r)||(Bx(e,t,2,!1),n.add(r))}function iu(t,e,n){var r=0;e&&(r|=4),Bx(n,t,r,e)}var Do="_reactListening"+Math.random().toString(36).slice(2);function Ia(t){if(!t[Do]){t[Do]=!0,Gg.forEach(function(n){n!=="selectionchange"&&(B_.has(n)||iu(n,!1,t),iu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Do]||(e[Do]=!0,iu("selectionchange",!1,e))}}function Bx(t,e,n,r){switch(Ex(e)){case 1:var s=n_;break;case 4:s=r_;break;default:s=sh}n=s.bind(null,e,n,t),s=void 0,!Bu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function au(t,e,n,r,s){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=es(c),o===null)return;if(u=o.tag,u===5||u===6){r=a=o;continue e}c=c.parentNode}}r=r.return}dx(function(){var h=a,f=eh(n),g=[];e:{var p=Ux.get(t);if(p!==void 0){var N=ah,k=t;switch(t){case"keypress":if(Xo(n)===0)break e;case"keydown":case"keyup":N=y_;break;case"focusin":k="focus",N=Zc;break;case"focusout":k="blur",N=Zc;break;case"beforeblur":case"afterblur":N=Zc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=Ff;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=a_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=__;break;case Ox:case Mx:case Fx:N=c_;break;case Lx:N=N_;break;case"scroll":N=s_;break;case"wheel":N=E_;break;case"copy":case"cut":case"paste":N=d_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=Uf}var T=(e&4)!==0,D=!T&&t==="scroll",S=T?p!==null?p+"Capture":null:p;T=[];for(var b=h,I;b!==null;){I=b;var C=I.stateNode;if(I.tag===5&&C!==null&&(I=C,S!==null&&(C=ba(b,S),C!=null&&T.push(ka(b,C,I)))),D)break;b=b.return}0<T.length&&(p=new N(p,k,null,n,f),g.push({event:p,listeners:T}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",p&&n!==Uu&&(k=n.relatedTarget||n.fromElement)&&(es(k)||k[rr]))break e;if((N||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,N?(k=n.relatedTarget||n.toElement,N=h,k=k?es(k):null,k!==null&&(D=ws(k),k!==D||k.tag!==5&&k.tag!==6)&&(k=null)):(N=null,k=h),N!==k)){if(T=Ff,C="onMouseLeave",S="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(T=Uf,C="onPointerLeave",S="onPointerEnter",b="pointer"),D=N==null?p:$s(N),I=k==null?p:$s(k),p=new T(C,b+"leave",N,n,f),p.target=D,p.relatedTarget=I,C=null,es(f)===h&&(T=new T(S,b+"enter",k,n,f),T.target=I,T.relatedTarget=D,C=T),D=C,N&&k)t:{for(T=N,S=k,b=0,I=T;I;I=Cs(I))b++;for(I=0,C=S;C;C=Cs(C))I++;for(;0<b-I;)T=Cs(T),b--;for(;0<I-b;)S=Cs(S),I--;for(;b--;){if(T===S||S!==null&&T===S.alternate)break t;T=Cs(T),S=Cs(S)}T=null}else T=null;N!==null&&Xf(g,p,N,T,!1),k!==null&&D!==null&&Xf(g,D,k,T,!0)}}e:{if(p=h?$s(h):window,N=p.nodeName&&p.nodeName.toLowerCase(),N==="select"||N==="input"&&p.type==="file")var L=P_;else if(zf(p))if(Cx)L=O_;else{L=D_;var R=R_}else(N=p.nodeName)&&N.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=V_);if(L&&(L=L(t,h))){Ax(g,L,n,f);break e}R&&R(t,p,h),t==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&Vu(p,"number",p.value)}switch(R=h?$s(h):window,t){case"focusin":(zf(R)||R.contentEditable==="true")&&(Ls=R,Wu=h,da=null);break;case"focusout":da=Wu=Ls=null;break;case"mousedown":Ku=!0;break;case"contextmenu":case"mouseup":case"dragend":Ku=!1,Kf(g,n,f);break;case"selectionchange":if(L_)break;case"keydown":case"keyup":Kf(g,n,f)}var w;if(lh)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Fs?Ix(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(Tx&&n.locale!=="ko"&&(Fs||x!=="onCompositionStart"?x==="onCompositionEnd"&&Fs&&(w=Sx()):(_r=f,ih="value"in _r?_r.value:_r.textContent,Fs=!0)),R=yl(h,x),0<R.length&&(x=new Lf(x,t,null,n,f),g.push({event:x,listeners:R}),w?x.data=w:(w=kx(n),w!==null&&(x.data=w)))),(w=T_?I_(t,n):k_(t,n))&&(h=yl(h,"onBeforeInput"),0<h.length&&(f=new Lf("onBeforeInput","beforeinput",null,n,f),g.push({event:f,listeners:h}),f.data=w))}$x(g,e)})}function ka(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=ba(t,n),a!=null&&r.unshift(ka(t,a,s)),a=ba(t,e),a!=null&&r.push(ka(t,a,s))),t=t.return}return r}function Cs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xf(t,e,n,r,s){for(var a=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,h=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&h!==null&&(c=h,s?(u=ba(n,a),u!=null&&o.unshift(ka(n,u,c))):s||(u=ba(n,a),u!=null&&o.push(ka(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var z_=/\r\n?/g,q_=/\u0000|\uFFFD/g;function Jf(t){return(typeof t=="string"?t:""+t).replace(z_,`
`).replace(q_,"")}function Vo(t,e,n){if(e=Jf(e),Jf(t)!==e&&n)throw Error(H(425))}function vl(){}var Gu=null,Yu=null;function Xu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ju=typeof setTimeout=="function"?setTimeout:void 0,H_=typeof clearTimeout=="function"?clearTimeout:void 0,Zf=typeof Promise=="function"?Promise:void 0,Q_=typeof queueMicrotask=="function"?queueMicrotask:typeof Zf<"u"?function(t){return Zf.resolve(null).then(t).catch(W_)}:Ju;function W_(t){setTimeout(function(){throw t})}function ou(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ea(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ea(e)}function Tr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ep(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _i=Math.random().toString(36).slice(2),Fn="__reactFiber$"+_i,Aa="__reactProps$"+_i,rr="__reactContainer$"+_i,Zu="__reactEvents$"+_i,K_="__reactListeners$"+_i,G_="__reactHandles$"+_i;function es(t){var e=t[Fn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[rr]||n[Fn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ep(t);t!==null;){if(n=t[Fn])return n;t=ep(t)}return e}t=n,n=t.parentNode}return null}function eo(t){return t=t[Fn]||t[rr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $s(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function tc(t){return t[Aa]||null}var ed=[],Bs=-1;function zr(t){return{current:t}}function Le(t){0>Bs||(t.current=ed[Bs],ed[Bs]=null,Bs--)}function De(t,e){Bs++,ed[Bs]=t.current,t.current=e}var Or={},$t=zr(Or),tn=zr(!1),us=Or;function ri(t,e){var n=t.type.contextTypes;if(!n)return Or;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function nn(t){return t=t.childContextTypes,t!=null}function wl(){Le(tn),Le($t)}function tp(t,e,n){if($t.current!==Or)throw Error(H(168));De($t,e),De(tn,n)}function zx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,Rw(t)||"Unknown",s));return Qe({},n,r)}function _l(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Or,us=$t.current,De($t,t),De(tn,tn.current),!0}function np(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=zx(t,e,us),r.__reactInternalMemoizedMergedChildContext=t,Le(tn),Le($t),De($t,t)):Le(tn),De(tn,n)}var Gn=null,nc=!1,lu=!1;function qx(t){Gn===null?Gn=[t]:Gn.push(t)}function Y_(t){nc=!0,qx(t)}function qr(){if(!lu&&Gn!==null){lu=!0;var t=0,e=ke;try{var n=Gn;for(ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gn=null,nc=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(t+1)),px(th,qr),s}finally{ke=e,lu=!1}}return null}var zs=[],qs=0,bl=null,Nl=0,pn=[],gn=0,ds=null,Yn=1,Xn="";function Xr(t,e){zs[qs++]=Nl,zs[qs++]=bl,bl=t,Nl=e}function Hx(t,e,n){pn[gn++]=Yn,pn[gn++]=Xn,pn[gn++]=ds,ds=t;var r=Yn;t=Xn;var s=32-An(r)-1;r&=~(1<<s),n+=1;var a=32-An(e)+s;if(30<a){var o=s-s%5;a=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Yn=1<<32-An(e)+s|n<<s|r,Xn=a+t}else Yn=1<<a|n<<s|r,Xn=t}function uh(t){t.return!==null&&(Xr(t,1),Hx(t,1,0))}function dh(t){for(;t===bl;)bl=zs[--qs],zs[qs]=null,Nl=zs[--qs],zs[qs]=null;for(;t===ds;)ds=pn[--gn],pn[gn]=null,Xn=pn[--gn],pn[gn]=null,Yn=pn[--gn],pn[gn]=null}var dn=null,cn=null,Be=!1,kn=null;function Qx(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,cn=Tr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ds!==null?{id:Yn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,cn=null,!0):!1;default:return!1}}function td(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nd(t){if(Be){var e=cn;if(e){var n=e;if(!rp(t,e)){if(td(t))throw Error(H(418));e=Tr(n.nextSibling);var r=dn;e&&rp(t,e)?Qx(r,n):(t.flags=t.flags&-4097|2,Be=!1,dn=t)}}else{if(td(t))throw Error(H(418));t.flags=t.flags&-4097|2,Be=!1,dn=t}}}function sp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function Oo(t){if(t!==dn)return!1;if(!Be)return sp(t),Be=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Xu(t.type,t.memoizedProps)),e&&(e=cn)){if(td(t))throw Wx(),Error(H(418));for(;e;)Qx(t,e),e=Tr(e.nextSibling)}if(sp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){cn=Tr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}cn=null}}else cn=dn?Tr(t.stateNode.nextSibling):null;return!0}function Wx(){for(var t=cn;t;)t=Tr(t.nextSibling)}function si(){cn=dn=null,Be=!1}function hh(t){kn===null?kn=[t]:kn.push(t)}var X_=cr.ReactCurrentBatchConfig;function Wi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var c=s.refs;o===null?delete c[a]:c[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Mo(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ip(t){var e=t._init;return e(t._payload)}function Kx(t){function e(S,b){if(t){var I=S.deletions;I===null?(S.deletions=[b],S.flags|=16):I.push(b)}}function n(S,b){if(!t)return null;for(;b!==null;)e(S,b),b=b.sibling;return null}function r(S,b){for(S=new Map;b!==null;)b.key!==null?S.set(b.key,b):S.set(b.index,b),b=b.sibling;return S}function s(S,b){return S=Cr(S,b),S.index=0,S.sibling=null,S}function a(S,b,I){return S.index=I,t?(I=S.alternate,I!==null?(I=I.index,I<b?(S.flags|=2,b):I):(S.flags|=2,b)):(S.flags|=1048576,b)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function c(S,b,I,C){return b===null||b.tag!==6?(b=pu(I,S.mode,C),b.return=S,b):(b=s(b,I),b.return=S,b)}function u(S,b,I,C){var L=I.type;return L===Ms?f(S,b,I.props.children,C,I.key):b!==null&&(b.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===xr&&ip(L)===b.type)?(C=s(b,I.props),C.ref=Wi(S,b,I),C.return=S,C):(C=sl(I.type,I.key,I.props,null,S.mode,C),C.ref=Wi(S,b,I),C.return=S,C)}function h(S,b,I,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==I.containerInfo||b.stateNode.implementation!==I.implementation?(b=gu(I,S.mode,C),b.return=S,b):(b=s(b,I.children||[]),b.return=S,b)}function f(S,b,I,C,L){return b===null||b.tag!==7?(b=os(I,S.mode,C,L),b.return=S,b):(b=s(b,I),b.return=S,b)}function g(S,b,I){if(typeof b=="string"&&b!==""||typeof b=="number")return b=pu(""+b,S.mode,I),b.return=S,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case So:return I=sl(b.type,b.key,b.props,null,S.mode,I),I.ref=Wi(S,null,b),I.return=S,I;case Os:return b=gu(b,S.mode,I),b.return=S,b;case xr:var C=b._init;return g(S,C(b._payload),I)}if(Ji(b)||Bi(b))return b=os(b,S.mode,I,null),b.return=S,b;Mo(S,b)}return null}function p(S,b,I,C){var L=b!==null?b.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return L!==null?null:c(S,b,""+I,C);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case So:return I.key===L?u(S,b,I,C):null;case Os:return I.key===L?h(S,b,I,C):null;case xr:return L=I._init,p(S,b,L(I._payload),C)}if(Ji(I)||Bi(I))return L!==null?null:f(S,b,I,C,null);Mo(S,I)}return null}function N(S,b,I,C,L){if(typeof C=="string"&&C!==""||typeof C=="number")return S=S.get(I)||null,c(b,S,""+C,L);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case So:return S=S.get(C.key===null?I:C.key)||null,u(b,S,C,L);case Os:return S=S.get(C.key===null?I:C.key)||null,h(b,S,C,L);case xr:var R=C._init;return N(S,b,I,R(C._payload),L)}if(Ji(C)||Bi(C))return S=S.get(I)||null,f(b,S,C,L,null);Mo(b,C)}return null}function k(S,b,I,C){for(var L=null,R=null,w=b,x=b=0,_=null;w!==null&&x<I.length;x++){w.index>x?(_=w,w=null):_=w.sibling;var j=p(S,w,I[x],C);if(j===null){w===null&&(w=_);break}t&&w&&j.alternate===null&&e(S,w),b=a(j,b,x),R===null?L=j:R.sibling=j,R=j,w=_}if(x===I.length)return n(S,w),Be&&Xr(S,x),L;if(w===null){for(;x<I.length;x++)w=g(S,I[x],C),w!==null&&(b=a(w,b,x),R===null?L=w:R.sibling=w,R=w);return Be&&Xr(S,x),L}for(w=r(S,w);x<I.length;x++)_=N(w,S,x,I[x],C),_!==null&&(t&&_.alternate!==null&&w.delete(_.key===null?x:_.key),b=a(_,b,x),R===null?L=_:R.sibling=_,R=_);return t&&w.forEach(function(E){return e(S,E)}),Be&&Xr(S,x),L}function T(S,b,I,C){var L=Bi(I);if(typeof L!="function")throw Error(H(150));if(I=L.call(I),I==null)throw Error(H(151));for(var R=L=null,w=b,x=b=0,_=null,j=I.next();w!==null&&!j.done;x++,j=I.next()){w.index>x?(_=w,w=null):_=w.sibling;var E=p(S,w,j.value,C);if(E===null){w===null&&(w=_);break}t&&w&&E.alternate===null&&e(S,w),b=a(E,b,x),R===null?L=E:R.sibling=E,R=E,w=_}if(j.done)return n(S,w),Be&&Xr(S,x),L;if(w===null){for(;!j.done;x++,j=I.next())j=g(S,j.value,C),j!==null&&(b=a(j,b,x),R===null?L=j:R.sibling=j,R=j);return Be&&Xr(S,x),L}for(w=r(S,w);!j.done;x++,j=I.next())j=N(w,S,x,j.value,C),j!==null&&(t&&j.alternate!==null&&w.delete(j.key===null?x:j.key),b=a(j,b,x),R===null?L=j:R.sibling=j,R=j);return t&&w.forEach(function(A){return e(S,A)}),Be&&Xr(S,x),L}function D(S,b,I,C){if(typeof I=="object"&&I!==null&&I.type===Ms&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case So:e:{for(var L=I.key,R=b;R!==null;){if(R.key===L){if(L=I.type,L===Ms){if(R.tag===7){n(S,R.sibling),b=s(R,I.props.children),b.return=S,S=b;break e}}else if(R.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===xr&&ip(L)===R.type){n(S,R.sibling),b=s(R,I.props),b.ref=Wi(S,R,I),b.return=S,S=b;break e}n(S,R);break}else e(S,R);R=R.sibling}I.type===Ms?(b=os(I.props.children,S.mode,C,I.key),b.return=S,S=b):(C=sl(I.type,I.key,I.props,null,S.mode,C),C.ref=Wi(S,b,I),C.return=S,S=C)}return o(S);case Os:e:{for(R=I.key;b!==null;){if(b.key===R)if(b.tag===4&&b.stateNode.containerInfo===I.containerInfo&&b.stateNode.implementation===I.implementation){n(S,b.sibling),b=s(b,I.children||[]),b.return=S,S=b;break e}else{n(S,b);break}else e(S,b);b=b.sibling}b=gu(I,S.mode,C),b.return=S,S=b}return o(S);case xr:return R=I._init,D(S,b,R(I._payload),C)}if(Ji(I))return k(S,b,I,C);if(Bi(I))return T(S,b,I,C);Mo(S,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,b!==null&&b.tag===6?(n(S,b.sibling),b=s(b,I),b.return=S,S=b):(n(S,b),b=pu(I,S.mode,C),b.return=S,S=b),o(S)):n(S,b)}return D}var ii=Kx(!0),Gx=Kx(!1),jl=zr(null),El=null,Hs=null,mh=null;function fh(){mh=Hs=El=null}function ph(t){var e=jl.current;Le(jl),t._currentValue=e}function rd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Js(t,e){El=t,mh=Hs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zt=!0),t.firstContext=null)}function _n(t){var e=t._currentValue;if(mh!==t)if(t={context:t,memoizedValue:e,next:null},Hs===null){if(El===null)throw Error(H(308));Hs=t,El.dependencies={lanes:0,firstContext:t}}else Hs=Hs.next=t;return e}var ts=null;function gh(t){ts===null?ts=[t]:ts.push(t)}function Yx(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,gh(e)):(n.next=s.next,s.next=n),e.interleaved=n,sr(t,r)}function sr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var yr=!1;function xh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ir(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ee&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,sr(t,n)}return s=r.interleaved,s===null?(e.next=e,gh(r)):(e.next=s.next,s.next=e),r.interleaved=e,sr(t,n)}function Jo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nh(t,n)}}function ap(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?s=a=e:a=a.next=e}else s=a=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sl(t,e,n,r){var s=t.updateQueue;yr=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,h=u.next;u.next=null,o===null?a=h:o.next=h,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=h:c.next=h,f.lastBaseUpdate=u))}if(a!==null){var g=s.baseState;o=0,f=h=u=null,c=a;do{var p=c.lane,N=c.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:N,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var k=t,T=c;switch(p=e,N=n,T.tag){case 1:if(k=T.payload,typeof k=="function"){g=k.call(N,g,p);break e}g=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=T.payload,p=typeof k=="function"?k.call(N,g,p):k,p==null)break e;g=Qe({},g,p);break e;case 2:yr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[c]:p.push(c))}else N={eventTime:N,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(h=f=N,u=g):f=f.next=N,o|=p;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;p=c,c=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);ms|=o,t.lanes=o,t.memoizedState=g}}function op(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var to={},Un=zr(to),Ca=zr(to),Pa=zr(to);function ns(t){if(t===to)throw Error(H(174));return t}function yh(t,e){switch(De(Pa,e),De(Ca,t),De(Un,to),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Mu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Mu(e,t)}Le(Un),De(Un,e)}function ai(){Le(Un),Le(Ca),Le(Pa)}function Jx(t){ns(Pa.current);var e=ns(Un.current),n=Mu(e,t.type);e!==n&&(De(Ca,t),De(Un,n))}function vh(t){Ca.current===t&&(Le(Un),Le(Ca))}var ze=zr(0);function Tl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cu=[];function wh(){for(var t=0;t<cu.length;t++)cu[t]._workInProgressVersionPrimary=null;cu.length=0}var Zo=cr.ReactCurrentDispatcher,uu=cr.ReactCurrentBatchConfig,hs=0,He=null,dt=null,gt=null,Il=!1,ha=!1,Ra=0,J_=0;function Dt(){throw Error(H(321))}function _h(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Rn(t[n],e[n]))return!1;return!0}function bh(t,e,n,r,s,a){if(hs=a,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zo.current=t===null||t.memoizedState===null?n1:r1,t=n(r,s),ha){a=0;do{if(ha=!1,Ra=0,25<=a)throw Error(H(301));a+=1,gt=dt=null,e.updateQueue=null,Zo.current=s1,t=n(r,s)}while(ha)}if(Zo.current=kl,e=dt!==null&&dt.next!==null,hs=0,gt=dt=He=null,Il=!1,e)throw Error(H(300));return t}function Nh(){var t=Ra!==0;return Ra=0,t}function Mn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?He.memoizedState=gt=t:gt=gt.next=t,gt}function bn(){if(dt===null){var t=He.alternate;t=t!==null?t.memoizedState:null}else t=dt.next;var e=gt===null?He.memoizedState:gt.next;if(e!==null)gt=e,dt=t;else{if(t===null)throw Error(H(310));dt=t,t={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},gt===null?He.memoizedState=gt=t:gt=gt.next=t}return gt}function Da(t,e){return typeof e=="function"?e(t):e}function du(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=dt,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var c=o=null,u=null,h=a;do{var f=h.lane;if((hs&f)===f)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,He.lanes|=f,ms|=f}h=h.next}while(h!==null&&h!==a);u===null?o=r:u.next=c,Rn(r,e.memoizedState)||(Zt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do a=s.lane,He.lanes|=a,ms|=a,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function hu(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,a=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);Rn(a,e.memoizedState)||(Zt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Zx(){}function ey(t,e){var n=He,r=bn(),s=e(),a=!Rn(r.memoizedState,s);if(a&&(r.memoizedState=s,Zt=!0),r=r.queue,jh(ry.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,Va(9,ny.bind(null,n,r,s,e),void 0,null),xt===null)throw Error(H(349));hs&30||ty(n,e,s)}return s}function ty(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ny(t,e,n,r){e.value=n,e.getSnapshot=r,sy(e)&&iy(t)}function ry(t,e,n){return n(function(){sy(e)&&iy(t)})}function sy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Rn(t,n)}catch{return!0}}function iy(t){var e=sr(t,1);e!==null&&Cn(e,t,1,-1)}function lp(t){var e=Mn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:t},e.queue=t,t=t.dispatch=t1.bind(null,He,t),[e.memoizedState,t]}function Va(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ay(){return bn().memoizedState}function el(t,e,n,r){var s=Mn();He.flags|=t,s.memoizedState=Va(1|e,n,void 0,r===void 0?null:r)}function rc(t,e,n,r){var s=bn();r=r===void 0?null:r;var a=void 0;if(dt!==null){var o=dt.memoizedState;if(a=o.destroy,r!==null&&_h(r,o.deps)){s.memoizedState=Va(e,n,a,r);return}}He.flags|=t,s.memoizedState=Va(1|e,n,a,r)}function cp(t,e){return el(8390656,8,t,e)}function jh(t,e){return rc(2048,8,t,e)}function oy(t,e){return rc(4,2,t,e)}function ly(t,e){return rc(4,4,t,e)}function cy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function uy(t,e,n){return n=n!=null?n.concat([t]):null,rc(4,4,cy.bind(null,e,t),n)}function Eh(){}function dy(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_h(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function hy(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_h(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function my(t,e,n){return hs&21?(Rn(n,e)||(n=yx(),He.lanes|=n,ms|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zt=!0),t.memoizedState=n)}function Z_(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var r=uu.transition;uu.transition={};try{t(!1),e()}finally{ke=n,uu.transition=r}}function fy(){return bn().memoizedState}function e1(t,e,n){var r=Ar(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},py(t))gy(e,n);else if(n=Yx(t,e,n,r),n!==null){var s=Qt();Cn(n,t,r,s),xy(n,e,r)}}function t1(t,e,n){var r=Ar(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(py(t))gy(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,c=a(o,n);if(s.hasEagerState=!0,s.eagerState=c,Rn(c,o)){var u=e.interleaved;u===null?(s.next=s,gh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Yx(t,e,s,r),n!==null&&(s=Qt(),Cn(n,t,r,s),xy(n,e,r))}}function py(t){var e=t.alternate;return t===He||e!==null&&e===He}function gy(t,e){ha=Il=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nh(t,n)}}var kl={readContext:_n,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},n1={readContext:_n,useCallback:function(t,e){return Mn().memoizedState=[t,e===void 0?null:e],t},useContext:_n,useEffect:cp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,el(4194308,4,cy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return el(4194308,4,t,e)},useInsertionEffect:function(t,e){return el(4,2,t,e)},useMemo:function(t,e){var n=Mn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=e1.bind(null,He,t),[r.memoizedState,t]},useRef:function(t){var e=Mn();return t={current:t},e.memoizedState=t},useState:lp,useDebugValue:Eh,useDeferredValue:function(t){return Mn().memoizedState=t},useTransition:function(){var t=lp(!1),e=t[0];return t=Z_.bind(null,t[1]),Mn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=He,s=Mn();if(Be){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),xt===null)throw Error(H(349));hs&30||ty(r,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,cp(ry.bind(null,r,a,t),[t]),r.flags|=2048,Va(9,ny.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Mn(),e=xt.identifierPrefix;if(Be){var n=Xn,r=Yn;n=(r&~(1<<32-An(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ra++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=J_++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},r1={readContext:_n,useCallback:dy,useContext:_n,useEffect:jh,useImperativeHandle:uy,useInsertionEffect:oy,useLayoutEffect:ly,useMemo:hy,useReducer:du,useRef:ay,useState:function(){return du(Da)},useDebugValue:Eh,useDeferredValue:function(t){var e=bn();return my(e,dt.memoizedState,t)},useTransition:function(){var t=du(Da)[0],e=bn().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:ey,useId:fy,unstable_isNewReconciler:!1},s1={readContext:_n,useCallback:dy,useContext:_n,useEffect:jh,useImperativeHandle:uy,useInsertionEffect:oy,useLayoutEffect:ly,useMemo:hy,useReducer:hu,useRef:ay,useState:function(){return hu(Da)},useDebugValue:Eh,useDeferredValue:function(t){var e=bn();return dt===null?e.memoizedState=t:my(e,dt.memoizedState,t)},useTransition:function(){var t=hu(Da)[0],e=bn().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:ey,useId:fy,unstable_isNewReconciler:!1};function Tn(t,e){if(t&&t.defaultProps){e=Qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var sc={isMounted:function(t){return(t=t._reactInternals)?ws(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qt(),s=Ar(t),a=Zn(r,s);a.payload=e,n!=null&&(a.callback=n),e=Ir(t,a,s),e!==null&&(Cn(e,t,s,r),Jo(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qt(),s=Ar(t),a=Zn(r,s);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Ir(t,a,s),e!==null&&(Cn(e,t,s,r),Jo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qt(),r=Ar(t),s=Zn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ir(t,s,r),e!==null&&(Cn(e,t,r,n),Jo(e,t,r))}};function up(t,e,n,r,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Ta(n,r)||!Ta(s,a):!0}function yy(t,e,n){var r=!1,s=Or,a=e.contextType;return typeof a=="object"&&a!==null?a=_n(a):(s=nn(e)?us:$t.current,r=e.contextTypes,a=(r=r!=null)?ri(t,s):Or),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function dp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&sc.enqueueReplaceState(e,e.state,null)}function id(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},xh(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=_n(a):(a=nn(e)?us:$t.current,s.context=ri(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(sd(t,e,a,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&sc.enqueueReplaceState(s,s.state,null),Sl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function oi(t,e){try{var n="",r=e;do n+=Pw(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function mu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ad(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var i1=typeof WeakMap=="function"?WeakMap:Map;function vy(t,e,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cl||(Cl=!0,gd=r),ad(t,e)},n}function wy(t,e,n){n=Zn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ad(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){ad(t,e),typeof r!="function"&&(kr===null?kr=new Set([this]):kr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function hp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new i1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=v1.bind(null,t,e,n),e.then(t,t))}function mp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zn(-1,1),e.tag=2,Ir(n,e,1))),n.lanes|=1),t)}var a1=cr.ReactCurrentOwner,Zt=!1;function qt(t,e,n,r){e.child=t===null?Gx(e,null,n,r):ii(e,t.child,n,r)}function pp(t,e,n,r,s){n=n.render;var a=e.ref;return Js(e,s),r=bh(t,e,n,r,a,s),n=Nh(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ir(t,e,s)):(Be&&n&&uh(e),e.flags|=1,qt(t,e,r,s),e.child)}function gp(t,e,n,r,s){if(t===null){var a=n.type;return typeof a=="function"&&!Rh(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,_y(t,e,a,r,s)):(t=sl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ta,n(o,r)&&t.ref===e.ref)return ir(t,e,s)}return e.flags|=1,t=Cr(a,r),t.ref=e.ref,t.return=e,e.child=t}function _y(t,e,n,r,s){if(t!==null){var a=t.memoizedProps;if(Ta(a,r)&&t.ref===e.ref)if(Zt=!1,e.pendingProps=r=a,(t.lanes&s)!==0)t.flags&131072&&(Zt=!0);else return e.lanes=t.lanes,ir(t,e,s)}return od(t,e,n,r,s)}function by(t,e,n){var r=e.pendingProps,s=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Ws,ln),ln|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Ws,ln),ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,De(Ws,ln),ln|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,De(Ws,ln),ln|=r;return qt(t,e,s,n),e.child}function Ny(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function od(t,e,n,r,s){var a=nn(n)?us:$t.current;return a=ri(e,a),Js(e,s),n=bh(t,e,n,r,a,s),r=Nh(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ir(t,e,s)):(Be&&r&&uh(e),e.flags|=1,qt(t,e,n,s),e.child)}function xp(t,e,n,r,s){if(nn(n)){var a=!0;_l(e)}else a=!1;if(Js(e,s),e.stateNode===null)tl(t,e),yy(e,n,r),id(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=_n(h):(h=nn(n)?us:$t.current,h=ri(e,h));var f=n.getDerivedStateFromProps,g=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==h)&&dp(e,o,r,h),yr=!1;var p=e.memoizedState;o.state=p,Sl(e,r,o,s),u=e.memoizedState,c!==r||p!==u||tn.current||yr?(typeof f=="function"&&(sd(e,n,f,r),u=e.memoizedState),(c=yr||up(e,n,c,r,p,u,h))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Xx(t,e),c=e.memoizedProps,h=e.type===e.elementType?c:Tn(e.type,c),o.props=h,g=e.pendingProps,p=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=_n(u):(u=nn(n)?us:$t.current,u=ri(e,u));var N=n.getDerivedStateFromProps;(f=typeof N=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||p!==u)&&dp(e,o,r,u),yr=!1,p=e.memoizedState,o.state=p,Sl(e,r,o,s);var k=e.memoizedState;c!==g||p!==k||tn.current||yr?(typeof N=="function"&&(sd(e,n,N,r),k=e.memoizedState),(h=yr||up(e,n,h,r,p,k,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,k,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,k,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return ld(t,e,n,r,a,s)}function ld(t,e,n,r,s,a){Ny(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&np(e,n,!1),ir(t,e,a);r=e.stateNode,a1.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ii(e,t.child,null,a),e.child=ii(e,null,c,a)):qt(t,e,c,a),e.memoizedState=r.state,s&&np(e,n,!0),e.child}function jy(t){var e=t.stateNode;e.pendingContext?tp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&tp(t,e.context,!1),yh(t,e.containerInfo)}function yp(t,e,n,r,s){return si(),hh(s),e.flags|=256,qt(t,e,n,r),e.child}var cd={dehydrated:null,treeContext:null,retryLane:0};function ud(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ey(t,e,n){var r=e.pendingProps,s=ze.current,a=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),De(ze,s&1),t===null)return nd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=oc(o,r,0,null),t=os(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=ud(n),e.memoizedState=cd,t):Sh(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return o1(t,e,o,r,c,s,n);if(a){a=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Cr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?a=Cr(c,a):(a=os(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?ud(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=cd,r}return a=t.child,t=a.sibling,r=Cr(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Sh(t,e){return e=oc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fo(t,e,n,r){return r!==null&&hh(r),ii(e,t.child,null,n),t=Sh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function o1(t,e,n,r,s,a,o){if(n)return e.flags&256?(e.flags&=-257,r=mu(Error(H(422))),Fo(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=oc({mode:"visible",children:r.children},s,0,null),a=os(a,s,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&ii(e,t.child,null,o),e.child.memoizedState=ud(o),e.memoizedState=cd,a);if(!(e.mode&1))return Fo(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,a=Error(H(419)),r=mu(a,r,void 0),Fo(t,e,o,r)}if(c=(o&t.childLanes)!==0,Zt||c){if(r=xt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,sr(t,s),Cn(r,t,s,-1))}return Ph(),r=mu(Error(H(421))),Fo(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=w1.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,cn=Tr(s.nextSibling),dn=e,Be=!0,kn=null,t!==null&&(pn[gn++]=Yn,pn[gn++]=Xn,pn[gn++]=ds,Yn=t.id,Xn=t.overflow,ds=e),e=Sh(e,r.children),e.flags|=4096,e)}function vp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),rd(t.return,e,n)}function fu(t,e,n,r,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Sy(t,e,n){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(qt(t,e,r.children,n),r=ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vp(t,n,e);else if(t.tag===19)vp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(De(ze,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Tl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),fu(e,!1,s,n,a);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Tl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}fu(e,!0,n,null,a);break;case"together":fu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ms|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Cr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Cr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function l1(t,e,n){switch(e.tag){case 3:jy(e),si();break;case 5:Jx(e);break;case 1:nn(e.type)&&_l(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;De(jl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(ze,ze.current&1),e.flags|=128,null):n&e.child.childLanes?Ey(t,e,n):(De(ze,ze.current&1),t=ir(t,e,n),t!==null?t.sibling:null);De(ze,ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Sy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(ze,ze.current),r)break;return null;case 22:case 23:return e.lanes=0,by(t,e,n)}return ir(t,e,n)}var Ty,dd,Iy,ky;Ty=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dd=function(){};Iy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ns(Un.current);var a=null;switch(n){case"input":s=Ru(t,s),r=Ru(t,r),a=[];break;case"select":s=Qe({},s,{value:void 0}),r=Qe({},r,{value:void 0}),a=[];break;case"textarea":s=Ou(t,s),r=Ou(t,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vl)}Fu(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(wa.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var u=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==c&&(u!=null||c!=null))if(h==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(a=a||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(wa.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Oe("scroll",t),a||c===u||(a=[])):(a=a||[]).push(h,u))}n&&(a=a||[]).push("style",n);var h=a;(e.updateQueue=h)&&(e.flags|=4)}};ky=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ki(t,e){if(!Be)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Vt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function c1(t,e,n){var r=e.pendingProps;switch(dh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(e),null;case 1:return nn(e.type)&&wl(),Vt(e),null;case 3:return r=e.stateNode,ai(),Le(tn),Le($t),wh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Oo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kn!==null&&(vd(kn),kn=null))),dd(t,e),Vt(e),null;case 5:vh(e);var s=ns(Pa.current);if(n=e.type,t!==null&&e.stateNode!=null)Iy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Vt(e),null}if(t=ns(Un.current),Oo(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Fn]=e,r[Aa]=a,t=(e.mode&1)!==0,n){case"dialog":Oe("cancel",r),Oe("close",r);break;case"iframe":case"object":case"embed":Oe("load",r);break;case"video":case"audio":for(s=0;s<ea.length;s++)Oe(ea[s],r);break;case"source":Oe("error",r);break;case"img":case"image":case"link":Oe("error",r),Oe("load",r);break;case"details":Oe("toggle",r);break;case"input":If(r,a),Oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Oe("invalid",r);break;case"textarea":Af(r,a),Oe("invalid",r)}Fu(n,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?r.textContent!==c&&(a.suppressHydrationWarning!==!0&&Vo(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&Vo(r.textContent,c,t),s=["children",""+c]):wa.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Oe("scroll",r)}switch(n){case"input":To(r),kf(r,a,!0);break;case"textarea":To(r),Cf(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=vl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fn]=e,t[Aa]=r,Ty(t,e,!1,!1),e.stateNode=t;e:{switch(o=Lu(n,r),n){case"dialog":Oe("cancel",t),Oe("close",t),s=r;break;case"iframe":case"object":case"embed":Oe("load",t),s=r;break;case"video":case"audio":for(s=0;s<ea.length;s++)Oe(ea[s],t);s=r;break;case"source":Oe("error",t),s=r;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),s=r;break;case"details":Oe("toggle",t),s=r;break;case"input":If(t,r),s=Ru(t,r),Oe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Qe({},r,{value:void 0}),Oe("invalid",t);break;case"textarea":Af(t,r),s=Ou(t,r),Oe("invalid",t);break;default:s=r}Fu(n,s),c=s;for(a in c)if(c.hasOwnProperty(a)){var u=c[a];a==="style"?ax(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&sx(t,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&_a(t,u):typeof u=="number"&&_a(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wa.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Oe("scroll",t):u!=null&&Yd(t,a,u,o))}switch(n){case"input":To(t),kf(t,r,!1);break;case"textarea":To(t),Cf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vr(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Ks(t,!!r.multiple,a,!1):r.defaultValue!=null&&Ks(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vt(e),null;case 6:if(t&&e.stateNode!=null)ky(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=ns(Pa.current),ns(Un.current),Oo(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fn]=e,(a=r.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:Vo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Vo(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fn]=e,e.stateNode=r}return Vt(e),null;case 13:if(Le(ze),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Be&&cn!==null&&e.mode&1&&!(e.flags&128))Wx(),si(),e.flags|=98560,a=!1;else if(a=Oo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(H(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(H(317));a[Fn]=e}else si(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vt(e),a=!1}else kn!==null&&(vd(kn),kn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?ht===0&&(ht=3):Ph())),e.updateQueue!==null&&(e.flags|=4),Vt(e),null);case 4:return ai(),dd(t,e),t===null&&Ia(e.stateNode.containerInfo),Vt(e),null;case 10:return ph(e.type._context),Vt(e),null;case 17:return nn(e.type)&&wl(),Vt(e),null;case 19:if(Le(ze),a=e.memoizedState,a===null)return Vt(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Ki(a,!1);else{if(ht!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Tl(t),o!==null){for(e.flags|=128,Ki(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(ze,ze.current&1|2),e.child}t=t.sibling}a.tail!==null&&rt()>li&&(e.flags|=128,r=!0,Ki(a,!1),e.lanes=4194304)}else{if(!r)if(t=Tl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ki(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Be)return Vt(e),null}else 2*rt()-a.renderingStartTime>li&&n!==1073741824&&(e.flags|=128,r=!0,Ki(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=rt(),e.sibling=null,n=ze.current,De(ze,r?n&1|2:n&1),e):(Vt(e),null);case 22:case 23:return Ch(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ln&1073741824&&(Vt(e),e.subtreeFlags&6&&(e.flags|=8192)):Vt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function u1(t,e){switch(dh(e),e.tag){case 1:return nn(e.type)&&wl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ai(),Le(tn),Le($t),wh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vh(e),null;case 13:if(Le(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));si()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(ze),null;case 4:return ai(),null;case 10:return ph(e.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var Lo=!1,Lt=!1,d1=typeof WeakSet=="function"?WeakSet:Set,re=null;function Qs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function hd(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var wp=!1;function h1(t,e){if(Gu=gl,t=Dx(),ch(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,h=0,f=0,g=t,p=null;t:for(;;){for(var N;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==a||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(N=g.firstChild)!==null;)p=g,g=N;for(;;){if(g===t)break t;if(p===n&&++h===s&&(c=o),p===a&&++f===r&&(u=o),(N=g.nextSibling)!==null)break;g=p,p=g.parentNode}g=N}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yu={focusedElem:t,selectionRange:n},gl=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var T=k.memoizedProps,D=k.memoizedState,S=e.stateNode,b=S.getSnapshotBeforeUpdate(e.elementType===e.type?T:Tn(e.type,T),D);S.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(C){Xe(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return k=wp,wp=!1,k}function ma(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&hd(e,n,a)}s=s.next}while(s!==r)}}function ic(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function md(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ay(t){var e=t.alternate;e!==null&&(t.alternate=null,Ay(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fn],delete e[Aa],delete e[Zu],delete e[K_],delete e[G_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Cy(t){return t.tag===5||t.tag===3||t.tag===4}function _p(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Cy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vl));else if(r!==4&&(t=t.child,t!==null))for(fd(t,e,n),t=t.sibling;t!==null;)fd(t,e,n),t=t.sibling}function pd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pd(t,e,n),t=t.sibling;t!==null;)pd(t,e,n),t=t.sibling}var Nt=null,In=!1;function gr(t,e,n){for(n=n.child;n!==null;)Py(t,e,n),n=n.sibling}function Py(t,e,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Xl,n)}catch{}switch(n.tag){case 5:Lt||Qs(n,e);case 6:var r=Nt,s=In;Nt=null,gr(t,e,n),Nt=r,In=s,Nt!==null&&(In?(t=Nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Nt.removeChild(n.stateNode));break;case 18:Nt!==null&&(In?(t=Nt,n=n.stateNode,t.nodeType===8?ou(t.parentNode,n):t.nodeType===1&&ou(t,n),Ea(t)):ou(Nt,n.stateNode));break;case 4:r=Nt,s=In,Nt=n.stateNode.containerInfo,In=!0,gr(t,e,n),Nt=r,In=s;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&hd(n,e,o),s=s.next}while(s!==r)}gr(t,e,n);break;case 1:if(!Lt&&(Qs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Xe(n,e,c)}gr(t,e,n);break;case 21:gr(t,e,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,gr(t,e,n),Lt=r):gr(t,e,n);break;default:gr(t,e,n)}}function bp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new d1),e.forEach(function(r){var s=_1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Sn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Nt=c.stateNode,In=!1;break e;case 3:Nt=c.stateNode.containerInfo,In=!0;break e;case 4:Nt=c.stateNode.containerInfo,In=!0;break e}c=c.return}if(Nt===null)throw Error(H(160));Py(a,o,s),Nt=null,In=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){Xe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ry(e,t),e=e.sibling}function Ry(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sn(e,t),On(t),r&4){try{ma(3,t,t.return),ic(3,t)}catch(T){Xe(t,t.return,T)}try{ma(5,t,t.return)}catch(T){Xe(t,t.return,T)}}break;case 1:Sn(e,t),On(t),r&512&&n!==null&&Qs(n,n.return);break;case 5:if(Sn(e,t),On(t),r&512&&n!==null&&Qs(n,n.return),t.flags&32){var s=t.stateNode;try{_a(s,"")}catch(T){Xe(t,t.return,T)}}if(r&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&tx(s,a),Lu(c,o);var h=Lu(c,a);for(o=0;o<u.length;o+=2){var f=u[o],g=u[o+1];f==="style"?ax(s,g):f==="dangerouslySetInnerHTML"?sx(s,g):f==="children"?_a(s,g):Yd(s,f,g,h)}switch(c){case"input":Du(s,a);break;case"textarea":nx(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var N=a.value;N!=null?Ks(s,!!a.multiple,N,!1):p!==!!a.multiple&&(a.defaultValue!=null?Ks(s,!!a.multiple,a.defaultValue,!0):Ks(s,!!a.multiple,a.multiple?[]:"",!1))}s[Aa]=a}catch(T){Xe(t,t.return,T)}}break;case 6:if(Sn(e,t),On(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(T){Xe(t,t.return,T)}}break;case 3:if(Sn(e,t),On(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ea(e.containerInfo)}catch(T){Xe(t,t.return,T)}break;case 4:Sn(e,t),On(t);break;case 13:Sn(e,t),On(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(kh=rt())),r&4&&bp(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Lt=(h=Lt)||f,Sn(e,t),Lt=h):Sn(e,t),On(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!f&&t.mode&1)for(re=t,f=t.child;f!==null;){for(g=re=f;re!==null;){switch(p=re,N=p.child,p.tag){case 0:case 11:case 14:case 15:ma(4,p,p.return);break;case 1:Qs(p,p.return);var k=p.stateNode;if(typeof k.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(T){Xe(r,n,T)}}break;case 5:Qs(p,p.return);break;case 22:if(p.memoizedState!==null){jp(g);continue}}N!==null?(N.return=p,re=N):jp(g)}f=f.sibling}e:for(f=null,g=t;;){if(g.tag===5){if(f===null){f=g;try{s=g.stateNode,h?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=ix("display",o))}catch(T){Xe(t,t.return,T)}}}else if(g.tag===6){if(f===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(T){Xe(t,t.return,T)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;f===g&&(f=null),g=g.return}f===g&&(f=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Sn(e,t),On(t),r&4&&bp(t);break;case 21:break;default:Sn(e,t),On(t)}}function On(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Cy(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(_a(s,""),r.flags&=-33);var a=_p(t);pd(t,a,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=_p(t);fd(t,c,o);break;default:throw Error(H(161))}}catch(u){Xe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function m1(t,e,n){re=t,Dy(t)}function Dy(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,a=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Lo;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||Lt;c=Lo;var h=Lt;if(Lo=o,(Lt=u)&&!h)for(re=s;re!==null;)o=re,u=o.child,o.tag===22&&o.memoizedState!==null?Ep(s):u!==null?(u.return=o,re=u):Ep(s);for(;a!==null;)re=a,Dy(a),a=a.sibling;re=s,Lo=c,Lt=h}Np(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,re=a):Np(t)}}function Np(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lt||ic(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Tn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&op(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}op(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var g=f.dehydrated;g!==null&&Ea(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Lt||e.flags&512&&md(e)}catch(p){Xe(e,e.return,p)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function jp(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function Ep(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ic(4,e)}catch(u){Xe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Xe(e,s,u)}}var a=e.return;try{md(e)}catch(u){Xe(e,a,u)}break;case 5:var o=e.return;try{md(e)}catch(u){Xe(e,o,u)}}}catch(u){Xe(e,e.return,u)}if(e===t){re=null;break}var c=e.sibling;if(c!==null){c.return=e.return,re=c;break}re=e.return}}var f1=Math.ceil,Al=cr.ReactCurrentDispatcher,Th=cr.ReactCurrentOwner,vn=cr.ReactCurrentBatchConfig,Ee=0,xt=null,at=null,St=0,ln=0,Ws=zr(0),ht=0,Oa=null,ms=0,ac=0,Ih=0,fa=null,Xt=null,kh=0,li=1/0,Kn=null,Cl=!1,gd=null,kr=null,Uo=!1,br=null,Pl=0,pa=0,xd=null,nl=-1,rl=0;function Qt(){return Ee&6?rt():nl!==-1?nl:nl=rt()}function Ar(t){return t.mode&1?Ee&2&&St!==0?St&-St:X_.transition!==null?(rl===0&&(rl=yx()),rl):(t=ke,t!==0||(t=window.event,t=t===void 0?16:Ex(t.type)),t):1}function Cn(t,e,n,r){if(50<pa)throw pa=0,xd=null,Error(H(185));Ja(t,n,r),(!(Ee&2)||t!==xt)&&(t===xt&&(!(Ee&2)&&(ac|=n),ht===4&&wr(t,St)),rn(t,r),n===1&&Ee===0&&!(e.mode&1)&&(li=rt()+500,nc&&qr()))}function rn(t,e){var n=t.callbackNode;Xw(t,e);var r=pl(t,t===xt?St:0);if(r===0)n!==null&&Df(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Df(n),e===1)t.tag===0?Y_(Sp.bind(null,t)):qx(Sp.bind(null,t)),Q_(function(){!(Ee&6)&&qr()}),n=null;else{switch(vx(r)){case 1:n=th;break;case 4:n=gx;break;case 16:n=fl;break;case 536870912:n=xx;break;default:n=fl}n=By(n,Vy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Vy(t,e){if(nl=-1,rl=0,Ee&6)throw Error(H(327));var n=t.callbackNode;if(Zs()&&t.callbackNode!==n)return null;var r=pl(t,t===xt?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rl(t,r);else{e=r;var s=Ee;Ee|=2;var a=My();(xt!==t||St!==e)&&(Kn=null,li=rt()+500,as(t,e));do try{x1();break}catch(c){Oy(t,c)}while(!0);fh(),Al.current=a,Ee=s,at!==null?e=0:(xt=null,St=0,e=ht)}if(e!==0){if(e===2&&(s=qu(t),s!==0&&(r=s,e=yd(t,s))),e===1)throw n=Oa,as(t,0),wr(t,r),rn(t,rt()),n;if(e===6)wr(t,r);else{if(s=t.current.alternate,!(r&30)&&!p1(s)&&(e=Rl(t,r),e===2&&(a=qu(t),a!==0&&(r=a,e=yd(t,a))),e===1))throw n=Oa,as(t,0),wr(t,r),rn(t,rt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Jr(t,Xt,Kn);break;case 3:if(wr(t,r),(r&130023424)===r&&(e=kh+500-rt(),10<e)){if(pl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Qt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ju(Jr.bind(null,t,Xt,Kn),e);break}Jr(t,Xt,Kn);break;case 4:if(wr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-An(r);a=1<<o,o=e[o],o>s&&(s=o),r&=~a}if(r=s,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*f1(r/1960))-r,10<r){t.timeoutHandle=Ju(Jr.bind(null,t,Xt,Kn),r);break}Jr(t,Xt,Kn);break;case 5:Jr(t,Xt,Kn);break;default:throw Error(H(329))}}}return rn(t,rt()),t.callbackNode===n?Vy.bind(null,t):null}function yd(t,e){var n=fa;return t.current.memoizedState.isDehydrated&&(as(t,e).flags|=256),t=Rl(t,e),t!==2&&(e=Xt,Xt=n,e!==null&&vd(e)),t}function vd(t){Xt===null?Xt=t:Xt.push.apply(Xt,t)}function p1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!Rn(a(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~Ih,e&=~ac,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-An(e),r=1<<n;t[n]=-1,e&=~r}}function Sp(t){if(Ee&6)throw Error(H(327));Zs();var e=pl(t,0);if(!(e&1))return rn(t,rt()),null;var n=Rl(t,e);if(t.tag!==0&&n===2){var r=qu(t);r!==0&&(e=r,n=yd(t,r))}if(n===1)throw n=Oa,as(t,0),wr(t,e),rn(t,rt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Jr(t,Xt,Kn),rn(t,rt()),null}function Ah(t,e){var n=Ee;Ee|=1;try{return t(e)}finally{Ee=n,Ee===0&&(li=rt()+500,nc&&qr())}}function fs(t){br!==null&&br.tag===0&&!(Ee&6)&&Zs();var e=Ee;Ee|=1;var n=vn.transition,r=ke;try{if(vn.transition=null,ke=1,t)return t()}finally{ke=r,vn.transition=n,Ee=e,!(Ee&6)&&qr()}}function Ch(){ln=Ws.current,Le(Ws)}function as(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,H_(n)),at!==null)for(n=at.return;n!==null;){var r=n;switch(dh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wl();break;case 3:ai(),Le(tn),Le($t),wh();break;case 5:vh(r);break;case 4:ai();break;case 13:Le(ze);break;case 19:Le(ze);break;case 10:ph(r.type._context);break;case 22:case 23:Ch()}n=n.return}if(xt=t,at=t=Cr(t.current,null),St=ln=e,ht=0,Oa=null,Ih=ac=ms=0,Xt=fa=null,ts!==null){for(e=0;e<ts.length;e++)if(n=ts[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=s,r.next=o}n.pending=r}ts=null}return t}function Oy(t,e){do{var n=at;try{if(fh(),Zo.current=kl,Il){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Il=!1}if(hs=0,gt=dt=He=null,ha=!1,Ra=0,Th.current=null,n===null||n.return===null){ht=1,Oa=e,at=null;break}e:{var a=t,o=n.return,c=n,u=e;if(e=St,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,f=c,g=f.tag;if(!(f.mode&1)&&(g===0||g===11||g===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var N=mp(o);if(N!==null){N.flags&=-257,fp(N,o,c,a,e),N.mode&1&&hp(a,h,e),e=N,u=h;var k=e.updateQueue;if(k===null){var T=new Set;T.add(u),e.updateQueue=T}else k.add(u);break e}else{if(!(e&1)){hp(a,h,e),Ph();break e}u=Error(H(426))}}else if(Be&&c.mode&1){var D=mp(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),fp(D,o,c,a,e),hh(oi(u,c));break e}}a=u=oi(u,c),ht!==4&&(ht=2),fa===null?fa=[a]:fa.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var S=vy(a,u,e);ap(a,S);break e;case 1:c=u;var b=a.type,I=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(kr===null||!kr.has(I)))){a.flags|=65536,e&=-e,a.lanes|=e;var C=wy(a,c,e);ap(a,C);break e}}a=a.return}while(a!==null)}Ly(n)}catch(L){e=L,at===n&&n!==null&&(at=n=n.return);continue}break}while(!0)}function My(){var t=Al.current;return Al.current=kl,t===null?kl:t}function Ph(){(ht===0||ht===3||ht===2)&&(ht=4),xt===null||!(ms&268435455)&&!(ac&268435455)||wr(xt,St)}function Rl(t,e){var n=Ee;Ee|=2;var r=My();(xt!==t||St!==e)&&(Kn=null,as(t,e));do try{g1();break}catch(s){Oy(t,s)}while(!0);if(fh(),Ee=n,Al.current=r,at!==null)throw Error(H(261));return xt=null,St=0,ht}function g1(){for(;at!==null;)Fy(at)}function x1(){for(;at!==null&&!Bw();)Fy(at)}function Fy(t){var e=$y(t.alternate,t,ln);t.memoizedProps=t.pendingProps,e===null?Ly(t):at=e,Th.current=null}function Ly(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=u1(n,e),n!==null){n.flags&=32767,at=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ht=6,at=null;return}}else if(n=c1(n,e,ln),n!==null){at=n;return}if(e=e.sibling,e!==null){at=e;return}at=e=t}while(e!==null);ht===0&&(ht=5)}function Jr(t,e,n){var r=ke,s=vn.transition;try{vn.transition=null,ke=1,y1(t,e,n,r)}finally{vn.transition=s,ke=r}return null}function y1(t,e,n,r){do Zs();while(br!==null);if(Ee&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(Jw(t,a),t===xt&&(at=xt=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Uo||(Uo=!0,By(fl,function(){return Zs(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=vn.transition,vn.transition=null;var o=ke;ke=1;var c=Ee;Ee|=4,Th.current=null,h1(t,n),Ry(n,t),F_(Yu),gl=!!Gu,Yu=Gu=null,t.current=n,m1(n),zw(),Ee=c,ke=o,vn.transition=a}else t.current=n;if(Uo&&(Uo=!1,br=t,Pl=s),a=t.pendingLanes,a===0&&(kr=null),Qw(n.stateNode),rn(t,rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cl)throw Cl=!1,t=gd,gd=null,t;return Pl&1&&t.tag!==0&&Zs(),a=t.pendingLanes,a&1?t===xd?pa++:(pa=0,xd=t):pa=0,qr(),null}function Zs(){if(br!==null){var t=vx(Pl),e=vn.transition,n=ke;try{if(vn.transition=null,ke=16>t?16:t,br===null)var r=!1;else{if(t=br,br=null,Pl=0,Ee&6)throw Error(H(331));var s=Ee;for(Ee|=4,re=t.current;re!==null;){var a=re,o=a.child;if(re.flags&16){var c=a.deletions;if(c!==null){for(var u=0;u<c.length;u++){var h=c[u];for(re=h;re!==null;){var f=re;switch(f.tag){case 0:case 11:case 15:ma(8,f,a)}var g=f.child;if(g!==null)g.return=f,re=g;else for(;re!==null;){f=re;var p=f.sibling,N=f.return;if(Ay(f),f===h){re=null;break}if(p!==null){p.return=N,re=p;break}re=N}}}var k=a.alternate;if(k!==null){var T=k.child;if(T!==null){k.child=null;do{var D=T.sibling;T.sibling=null,T=D}while(T!==null)}}re=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,re=o;else e:for(;re!==null;){if(a=re,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ma(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,re=S;break e}re=a.return}}var b=t.current;for(re=b;re!==null;){o=re;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,re=I;else e:for(o=b;re!==null;){if(c=re,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(L){Xe(c,c.return,L)}if(c===o){re=null;break e}var C=c.sibling;if(C!==null){C.return=c.return,re=C;break e}re=c.return}}if(Ee=s,qr(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Xl,t)}catch{}r=!0}return r}finally{ke=n,vn.transition=e}}return!1}function Tp(t,e,n){e=oi(n,e),e=vy(t,e,1),t=Ir(t,e,1),e=Qt(),t!==null&&(Ja(t,1,e),rn(t,e))}function Xe(t,e,n){if(t.tag===3)Tp(t,t,n);else for(;e!==null;){if(e.tag===3){Tp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(kr===null||!kr.has(r))){t=oi(n,t),t=wy(e,t,1),e=Ir(e,t,1),t=Qt(),e!==null&&(Ja(e,1,t),rn(e,t));break}}e=e.return}}function v1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Qt(),t.pingedLanes|=t.suspendedLanes&n,xt===t&&(St&n)===n&&(ht===4||ht===3&&(St&130023424)===St&&500>rt()-kh?as(t,0):Ih|=n),rn(t,e)}function Uy(t,e){e===0&&(t.mode&1?(e=Ao,Ao<<=1,!(Ao&130023424)&&(Ao=4194304)):e=1);var n=Qt();t=sr(t,e),t!==null&&(Ja(t,e,n),rn(t,n))}function w1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Uy(t,n)}function _1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),Uy(t,n)}var $y;$y=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tn.current)Zt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Zt=!1,l1(t,e,n);Zt=!!(t.flags&131072)}else Zt=!1,Be&&e.flags&1048576&&Hx(e,Nl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;tl(t,e),t=e.pendingProps;var s=ri(e,$t.current);Js(e,n),s=bh(null,e,r,t,s,n);var a=Nh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nn(r)?(a=!0,_l(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xh(e),s.updater=sc,e.stateNode=s,s._reactInternals=e,id(e,r,t,n),e=ld(null,e,r,!0,a,n)):(e.tag=0,Be&&a&&uh(e),qt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(tl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=N1(r),t=Tn(r,t),s){case 0:e=od(null,e,r,t,n);break e;case 1:e=xp(null,e,r,t,n);break e;case 11:e=pp(null,e,r,t,n);break e;case 14:e=gp(null,e,r,Tn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),od(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),xp(t,e,r,s,n);case 3:e:{if(jy(e),t===null)throw Error(H(387));r=e.pendingProps,a=e.memoizedState,s=a.element,Xx(t,e),Sl(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=oi(Error(H(423)),e),e=yp(t,e,r,n,s);break e}else if(r!==s){s=oi(Error(H(424)),e),e=yp(t,e,r,n,s);break e}else for(cn=Tr(e.stateNode.containerInfo.firstChild),dn=e,Be=!0,kn=null,n=Gx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(si(),r===s){e=ir(t,e,n);break e}qt(t,e,r,n)}e=e.child}return e;case 5:return Jx(e),t===null&&nd(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,Xu(r,s)?o=null:a!==null&&Xu(r,a)&&(e.flags|=32),Ny(t,e),qt(t,e,o,n),e.child;case 6:return t===null&&nd(e),null;case 13:return Ey(t,e,n);case 4:return yh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ii(e,null,r,n):qt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),pp(t,e,r,s,n);case 7:return qt(t,e,e.pendingProps,n),e.child;case 8:return qt(t,e,e.pendingProps.children,n),e.child;case 12:return qt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,De(jl,r._currentValue),r._currentValue=o,a!==null)if(Rn(a.value,o)){if(a.children===s.children&&!tn.current){e=ir(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(a.tag===1){u=Zn(-1,n&-n),u.tag=2;var h=a.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?u.next=u:(u.next=f.next,f.next=u),h.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),rd(a.return,n,e),c.lanes|=n;break}u=u.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(H(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),rd(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}qt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Js(e,n),s=_n(s),r=r(s),e.flags|=1,qt(t,e,r,n),e.child;case 14:return r=e.type,s=Tn(r,e.pendingProps),s=Tn(r.type,s),gp(t,e,r,s,n);case 15:return _y(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),tl(t,e),e.tag=1,nn(r)?(t=!0,_l(e)):t=!1,Js(e,n),yy(e,r,s),id(e,r,s,n),ld(null,e,r,!0,t,n);case 19:return Sy(t,e,n);case 22:return by(t,e,n)}throw Error(H(156,e.tag))};function By(t,e){return px(t,e)}function b1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,r){return new b1(t,e,n,r)}function Rh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function N1(t){if(typeof t=="function")return Rh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jd)return 11;if(t===Zd)return 14}return 2}function Cr(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function sl(t,e,n,r,s,a){var o=2;if(r=t,typeof t=="function")Rh(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ms:return os(n.children,s,a,e);case Xd:o=8,s|=8;break;case ku:return t=xn(12,n,e,s|2),t.elementType=ku,t.lanes=a,t;case Au:return t=xn(13,n,e,s),t.elementType=Au,t.lanes=a,t;case Cu:return t=xn(19,n,e,s),t.elementType=Cu,t.lanes=a,t;case Jg:return oc(n,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Yg:o=10;break e;case Xg:o=9;break e;case Jd:o=11;break e;case Zd:o=14;break e;case xr:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=xn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=a,e}function os(t,e,n,r){return t=xn(7,t,r,e),t.lanes=n,t}function oc(t,e,n,r){return t=xn(22,t,r,e),t.elementType=Jg,t.lanes=n,t.stateNode={isHidden:!1},t}function pu(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function gu(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function j1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yc(0),this.expirationTimes=Yc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Dh(t,e,n,r,s,a,o,c,u){return t=new j1(t,e,n,c,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=xn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xh(a),t}function E1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Os,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function zy(t){if(!t)return Or;t=t._reactInternals;e:{if(ws(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(nn(n))return zx(t,n,e)}return e}function qy(t,e,n,r,s,a,o,c,u){return t=Dh(n,r,!0,t,s,a,o,c,u),t.context=zy(null),n=t.current,r=Qt(),s=Ar(n),a=Zn(r,s),a.callback=e??null,Ir(n,a,s),t.current.lanes=s,Ja(t,s,r),rn(t,r),t}function lc(t,e,n,r){var s=e.current,a=Qt(),o=Ar(s);return n=zy(n),e.context===null?e.context=n:e.pendingContext=n,e=Zn(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ir(s,e,o),t!==null&&(Cn(t,s,o,a),Jo(t,s,o)),o}function Dl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ip(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vh(t,e){Ip(t,e),(t=t.alternate)&&Ip(t,e)}function S1(){return null}var Hy=typeof reportError=="function"?reportError:function(t){console.error(t)};function Oh(t){this._internalRoot=t}cc.prototype.render=Oh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));lc(t,e,null,null)};cc.prototype.unmount=Oh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fs(function(){lc(null,t,null,null)}),e[rr]=null}};function cc(t){this._internalRoot=t}cc.prototype.unstable_scheduleHydration=function(t){if(t){var e=bx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vr.length&&e!==0&&e<vr[n].priority;n++);vr.splice(n,0,t),n===0&&jx(t)}};function Mh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function uc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kp(){}function T1(t,e,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var h=Dl(o);a.call(h)}}var o=qy(e,r,t,0,null,!1,!1,"",kp);return t._reactRootContainer=o,t[rr]=o.current,Ia(t.nodeType===8?t.parentNode:t),fs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=Dl(u);c.call(h)}}var u=Dh(t,0,!1,null,null,!1,!1,"",kp);return t._reactRootContainer=u,t[rr]=u.current,Ia(t.nodeType===8?t.parentNode:t),fs(function(){lc(e,u,n,r)}),u}function dc(t,e,n,r,s){var a=n._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var c=s;s=function(){var u=Dl(o);c.call(u)}}lc(e,o,t,s)}else o=T1(n,e,t,s,r);return Dl(o)}wx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zi(e.pendingLanes);n!==0&&(nh(e,n|1),rn(e,rt()),!(Ee&6)&&(li=rt()+500,qr()))}break;case 13:fs(function(){var r=sr(t,1);if(r!==null){var s=Qt();Cn(r,t,1,s)}}),Vh(t,1)}};rh=function(t){if(t.tag===13){var e=sr(t,134217728);if(e!==null){var n=Qt();Cn(e,t,134217728,n)}Vh(t,134217728)}};_x=function(t){if(t.tag===13){var e=Ar(t),n=sr(t,e);if(n!==null){var r=Qt();Cn(n,t,e,r)}Vh(t,e)}};bx=function(){return ke};Nx=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};$u=function(t,e,n){switch(e){case"input":if(Du(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=tc(r);if(!s)throw Error(H(90));ex(r),Du(r,s)}}}break;case"textarea":nx(t,n);break;case"select":e=n.value,e!=null&&Ks(t,!!n.multiple,e,!1)}};cx=Ah;ux=fs;var I1={usingClientEntryPoint:!1,Events:[eo,$s,tc,ox,lx,Ah]},Gi={findFiberByHostInstance:es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k1={bundleType:Gi.bundleType,version:Gi.version,rendererPackageName:Gi.rendererPackageName,rendererConfig:Gi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=mx(t),t===null?null:t.stateNode},findFiberByHostInstance:Gi.findFiberByHostInstance||S1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$o.isDisabled&&$o.supportsFiber)try{Xl=$o.inject(k1),Ln=$o}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I1;mn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mh(e))throw Error(H(200));return E1(t,e,null,n)};mn.createRoot=function(t,e){if(!Mh(t))throw Error(H(299));var n=!1,r="",s=Hy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Dh(t,1,!1,null,null,n,!1,r,s),t[rr]=e.current,Ia(t.nodeType===8?t.parentNode:t),new Oh(e)};mn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=mx(e),t=t===null?null:t.stateNode,t};mn.flushSync=function(t){return fs(t)};mn.hydrate=function(t,e,n){if(!uc(e))throw Error(H(200));return dc(null,t,e,!0,n)};mn.hydrateRoot=function(t,e,n){if(!Mh(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",o=Hy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=qy(e,null,t,1,n??null,s,!1,a,o),t[rr]=e.current,Ia(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new cc(e)};mn.render=function(t,e,n){if(!uc(e))throw Error(H(200));return dc(null,t,e,!1,n)};mn.unmountComponentAtNode=function(t){if(!uc(t))throw Error(H(40));return t._reactRootContainer?(fs(function(){dc(null,null,t,!1,function(){t._reactRootContainer=null,t[rr]=null})}),!0):!1};mn.unstable_batchedUpdates=Ah;mn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!uc(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return dc(t,e,n,!1,r)};mn.version="18.3.1-next-f1338f8080-20240426";function Qy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qy)}catch(t){console.error(t)}}Qy(),Qg.exports=mn;var A1=Qg.exports,Ap=A1;Tu.createRoot=Ap.createRoot,Tu.hydrateRoot=Ap.hydrateRoot;var Cp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wy=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},C1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[n++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},Ky={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,f=a>>2,g=(a&3)<<4|c>>4;let p=(c&15)<<2|h>>6,N=h&63;u||(N=64,o||(p=64)),r.push(n[f],n[g],n[p],n[N])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Wy(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):C1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const a=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,a==null||c==null||h==null||g==null)throw new P1;const p=a<<2|c>>4;if(r.push(p),h!==64){const N=c<<4&240|h>>2;if(r.push(N),g!==64){const k=h<<6&192|g;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R1=function(t){const e=Wy(t);return Ky.encodeByteArray(e,!0)},Vl=function(t){return R1(t).replace(/\./g,"")},D1=function(t){try{return Ky.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1=()=>V1().__FIREBASE_DEFAULTS__,M1=()=>{if(typeof process>"u"||typeof Cp>"u")return;const t=Cp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},F1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Fh=()=>{try{return O1()||M1()||F1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L1=t=>{var e,n;return(n=(e=Fh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},U1=t=>{const e=L1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Gy=()=>{var t;return(t=Fh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Vl(JSON.stringify(n)),Vl(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function q1(){var t;const e=(t=Fh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function H1(){return!q1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Q1(){try{return typeof indexedDB=="object"}catch{return!1}}function W1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1="FirebaseError";class bi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=K1,Object.setPrototypeOf(this,bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yy.prototype.create)}}class Yy{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?G1(a,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new bi(s,c,r)}}function G1(t,e){return t.replace(Y1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Y1=/\{\$([^}]+)}/g;function wd(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const a=t[s],o=e[s];if(Pp(a)&&Pp(o)){if(!wd(a,o))return!1}else if(a!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Pp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t){return t&&t._delegate?t._delegate:t}class Ma{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new $1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Z1(e))try{this.getOrInitializeService({instanceIdentifier:Zr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Zr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zr){return this.instances.has(e)}getOptions(e=Zr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:J1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zr){return this.component?this.component.multipleInstances?e:Zr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function J1(t){return t===Zr?void 0:t}function Z1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new X1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const tb={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},nb=je.INFO,rb={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},sb=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rb[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xy{constructor(e){this.name=e,this._logLevel=nb,this._logHandler=sb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const ib=(t,e)=>e.some(n=>t instanceof n);let Rp,Dp;function ab(){return Rp||(Rp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ob(){return Dp||(Dp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jy=new WeakMap,_d=new WeakMap,Zy=new WeakMap,xu=new WeakMap,Lh=new WeakMap;function lb(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(Pr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Jy.set(n,t)}).catch(()=>{}),Lh.set(e,t),e}function cb(t){if(_d.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});_d.set(t,e)}let bd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _d.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zy.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ub(t){bd=t(bd)}function db(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(yu(this),e,...n);return Zy.set(r,e.sort?e.sort():[e]),Pr(r)}:ob().includes(t)?function(...e){return t.apply(yu(this),e),Pr(Jy.get(this))}:function(...e){return Pr(t.apply(yu(this),e))}}function hb(t){return typeof t=="function"?db(t):(t instanceof IDBTransaction&&cb(t),ib(t,ab())?new Proxy(t,bd):t)}function Pr(t){if(t instanceof IDBRequest)return lb(t);if(xu.has(t))return xu.get(t);const e=hb(t);return e!==t&&(xu.set(t,e),Lh.set(e,t)),e}const yu=t=>Lh.get(t);function mb(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),c=Pr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Pr(o.result),u.oldVersion,u.newVersion,Pr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const fb=["get","getKey","getAll","getAllKeys","count"],pb=["put","add","delete","clear"],vu=new Map;function Vp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vu.get(e))return vu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=pb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fb.includes(n)))return;const a=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),s&&u.done]))[0]};return vu.set(e,a),a}ub(t=>({...t,get:(e,n,r)=>Vp(e,n)||t.get(e,n,r),has:(e,n)=>!!Vp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xb(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function xb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nd="@firebase/app",Op="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar=new Xy("@firebase/app"),yb="@firebase/app-compat",vb="@firebase/analytics-compat",wb="@firebase/analytics",_b="@firebase/app-check-compat",bb="@firebase/app-check",Nb="@firebase/auth",jb="@firebase/auth-compat",Eb="@firebase/database",Sb="@firebase/data-connect",Tb="@firebase/database-compat",Ib="@firebase/functions",kb="@firebase/functions-compat",Ab="@firebase/installations",Cb="@firebase/installations-compat",Pb="@firebase/messaging",Rb="@firebase/messaging-compat",Db="@firebase/performance",Vb="@firebase/performance-compat",Ob="@firebase/remote-config",Mb="@firebase/remote-config-compat",Fb="@firebase/storage",Lb="@firebase/storage-compat",Ub="@firebase/firestore",$b="@firebase/vertexai-preview",Bb="@firebase/firestore-compat",zb="firebase",qb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd="[DEFAULT]",Hb={[Nd]:"fire-core",[yb]:"fire-core-compat",[wb]:"fire-analytics",[vb]:"fire-analytics-compat",[bb]:"fire-app-check",[_b]:"fire-app-check-compat",[Nb]:"fire-auth",[jb]:"fire-auth-compat",[Eb]:"fire-rtdb",[Sb]:"fire-data-connect",[Tb]:"fire-rtdb-compat",[Ib]:"fire-fn",[kb]:"fire-fn-compat",[Ab]:"fire-iid",[Cb]:"fire-iid-compat",[Pb]:"fire-fcm",[Rb]:"fire-fcm-compat",[Db]:"fire-perf",[Vb]:"fire-perf-compat",[Ob]:"fire-rc",[Mb]:"fire-rc-compat",[Fb]:"fire-gcs",[Lb]:"fire-gcs-compat",[Ub]:"fire-fst",[Bb]:"fire-fst-compat",[$b]:"fire-vertex","fire-js":"fire-js",[zb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=new Map,Qb=new Map,Ed=new Map;function Mp(t,e){try{t.container.addComponent(e)}catch(n){ar.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ml(t){const e=t.name;if(Ed.has(e))return ar.debug(`There were multiple attempts to register component ${e}.`),!1;Ed.set(e,t);for(const n of Ol.values())Mp(n,t);for(const n of Qb.values())Mp(n,t);return!0}function Wb(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rr=new Yy("app","Firebase",Kb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ma("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=qb;function ev(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:jd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Rr.create("bad-app-name",{appName:String(s)});if(n||(n=Gy()),!n)throw Rr.create("no-options");const a=Ol.get(s);if(a){if(wd(n,a.options)&&wd(r,a.config))return a;throw Rr.create("duplicate-app",{appName:s})}const o=new eb(s);for(const u of Ed.values())o.addComponent(u);const c=new Gb(n,r,o);return Ol.set(s,c),c}function Xb(t=jd){const e=Ol.get(t);if(!e&&t===jd&&Gy())return ev();if(!e)throw Rr.create("no-app",{appName:t});return e}function ei(t,e,n){var r;let s=(r=Hb[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${s}" with version "${e}":`];a&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ar.warn(c.join(" "));return}Ml(new Ma(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb="firebase-heartbeat-database",Zb=1,Fa="firebase-heartbeat-store";let wu=null;function tv(){return wu||(wu=mb(Jb,Zb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Fa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Rr.create("idb-open",{originalErrorMessage:t.message})})),wu}async function eN(t){try{const n=(await tv()).transaction(Fa),r=await n.objectStore(Fa).get(nv(t));return await n.done,r}catch(e){if(e instanceof bi)ar.warn(e.message);else{const n=Rr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ar.warn(n.message)}}}async function Fp(t,e){try{const r=(await tv()).transaction(Fa,"readwrite");await r.objectStore(Fa).put(e,nv(t)),await r.done}catch(n){if(n instanceof bi)ar.warn(n.message);else{const r=Rr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ar.warn(r.message)}}}function nv(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=1024,nN=30*24*60*60*1e3;class rN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new iN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Lp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=nN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ar.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Lp(),{heartbeatsToSend:r,unsentEntries:s}=sN(this._heartbeatsCache.heartbeats),a=Vl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return ar.warn(n),""}}}function Lp(){return new Date().toISOString().substring(0,10)}function sN(t,e=tN){const n=[];let r=t.slice();for(const s of t){const a=n.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),Up(n)>e){a.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Up(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class iN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Q1()?W1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await eN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Fp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Fp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Up(t){return Vl(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(t){Ml(new Ma("platform-logger",e=>new gb(e),"PRIVATE")),Ml(new Ma("heartbeat",e=>new rN(e),"PRIVATE")),ei(Nd,Op,t),ei(Nd,Op,"esm2017"),ei("fire-js","")}aN("");var oN="firebase",lN="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ei(oN,lN,"app");var $p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ls,rv;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,x){function _(){}_.prototype=x.prototype,w.D=x.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(j,E,A){for(var v=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)v[ae-2]=arguments[ae];return x.prototype[E].apply(j,v)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,x,_){_||(_=0);var j=Array(16);if(typeof x=="string")for(var E=0;16>E;++E)j[E]=x.charCodeAt(_++)|x.charCodeAt(_++)<<8|x.charCodeAt(_++)<<16|x.charCodeAt(_++)<<24;else for(E=0;16>E;++E)j[E]=x[_++]|x[_++]<<8|x[_++]<<16|x[_++]<<24;x=w.g[0],_=w.g[1],E=w.g[2];var A=w.g[3],v=x+(A^_&(E^A))+j[0]+3614090360&4294967295;x=_+(v<<7&4294967295|v>>>25),v=A+(E^x&(_^E))+j[1]+3905402710&4294967295,A=x+(v<<12&4294967295|v>>>20),v=E+(_^A&(x^_))+j[2]+606105819&4294967295,E=A+(v<<17&4294967295|v>>>15),v=_+(x^E&(A^x))+j[3]+3250441966&4294967295,_=E+(v<<22&4294967295|v>>>10),v=x+(A^_&(E^A))+j[4]+4118548399&4294967295,x=_+(v<<7&4294967295|v>>>25),v=A+(E^x&(_^E))+j[5]+1200080426&4294967295,A=x+(v<<12&4294967295|v>>>20),v=E+(_^A&(x^_))+j[6]+2821735955&4294967295,E=A+(v<<17&4294967295|v>>>15),v=_+(x^E&(A^x))+j[7]+4249261313&4294967295,_=E+(v<<22&4294967295|v>>>10),v=x+(A^_&(E^A))+j[8]+1770035416&4294967295,x=_+(v<<7&4294967295|v>>>25),v=A+(E^x&(_^E))+j[9]+2336552879&4294967295,A=x+(v<<12&4294967295|v>>>20),v=E+(_^A&(x^_))+j[10]+4294925233&4294967295,E=A+(v<<17&4294967295|v>>>15),v=_+(x^E&(A^x))+j[11]+2304563134&4294967295,_=E+(v<<22&4294967295|v>>>10),v=x+(A^_&(E^A))+j[12]+1804603682&4294967295,x=_+(v<<7&4294967295|v>>>25),v=A+(E^x&(_^E))+j[13]+4254626195&4294967295,A=x+(v<<12&4294967295|v>>>20),v=E+(_^A&(x^_))+j[14]+2792965006&4294967295,E=A+(v<<17&4294967295|v>>>15),v=_+(x^E&(A^x))+j[15]+1236535329&4294967295,_=E+(v<<22&4294967295|v>>>10),v=x+(E^A&(_^E))+j[1]+4129170786&4294967295,x=_+(v<<5&4294967295|v>>>27),v=A+(_^E&(x^_))+j[6]+3225465664&4294967295,A=x+(v<<9&4294967295|v>>>23),v=E+(x^_&(A^x))+j[11]+643717713&4294967295,E=A+(v<<14&4294967295|v>>>18),v=_+(A^x&(E^A))+j[0]+3921069994&4294967295,_=E+(v<<20&4294967295|v>>>12),v=x+(E^A&(_^E))+j[5]+3593408605&4294967295,x=_+(v<<5&4294967295|v>>>27),v=A+(_^E&(x^_))+j[10]+38016083&4294967295,A=x+(v<<9&4294967295|v>>>23),v=E+(x^_&(A^x))+j[15]+3634488961&4294967295,E=A+(v<<14&4294967295|v>>>18),v=_+(A^x&(E^A))+j[4]+3889429448&4294967295,_=E+(v<<20&4294967295|v>>>12),v=x+(E^A&(_^E))+j[9]+568446438&4294967295,x=_+(v<<5&4294967295|v>>>27),v=A+(_^E&(x^_))+j[14]+3275163606&4294967295,A=x+(v<<9&4294967295|v>>>23),v=E+(x^_&(A^x))+j[3]+4107603335&4294967295,E=A+(v<<14&4294967295|v>>>18),v=_+(A^x&(E^A))+j[8]+1163531501&4294967295,_=E+(v<<20&4294967295|v>>>12),v=x+(E^A&(_^E))+j[13]+2850285829&4294967295,x=_+(v<<5&4294967295|v>>>27),v=A+(_^E&(x^_))+j[2]+4243563512&4294967295,A=x+(v<<9&4294967295|v>>>23),v=E+(x^_&(A^x))+j[7]+1735328473&4294967295,E=A+(v<<14&4294967295|v>>>18),v=_+(A^x&(E^A))+j[12]+2368359562&4294967295,_=E+(v<<20&4294967295|v>>>12),v=x+(_^E^A)+j[5]+4294588738&4294967295,x=_+(v<<4&4294967295|v>>>28),v=A+(x^_^E)+j[8]+2272392833&4294967295,A=x+(v<<11&4294967295|v>>>21),v=E+(A^x^_)+j[11]+1839030562&4294967295,E=A+(v<<16&4294967295|v>>>16),v=_+(E^A^x)+j[14]+4259657740&4294967295,_=E+(v<<23&4294967295|v>>>9),v=x+(_^E^A)+j[1]+2763975236&4294967295,x=_+(v<<4&4294967295|v>>>28),v=A+(x^_^E)+j[4]+1272893353&4294967295,A=x+(v<<11&4294967295|v>>>21),v=E+(A^x^_)+j[7]+4139469664&4294967295,E=A+(v<<16&4294967295|v>>>16),v=_+(E^A^x)+j[10]+3200236656&4294967295,_=E+(v<<23&4294967295|v>>>9),v=x+(_^E^A)+j[13]+681279174&4294967295,x=_+(v<<4&4294967295|v>>>28),v=A+(x^_^E)+j[0]+3936430074&4294967295,A=x+(v<<11&4294967295|v>>>21),v=E+(A^x^_)+j[3]+3572445317&4294967295,E=A+(v<<16&4294967295|v>>>16),v=_+(E^A^x)+j[6]+76029189&4294967295,_=E+(v<<23&4294967295|v>>>9),v=x+(_^E^A)+j[9]+3654602809&4294967295,x=_+(v<<4&4294967295|v>>>28),v=A+(x^_^E)+j[12]+3873151461&4294967295,A=x+(v<<11&4294967295|v>>>21),v=E+(A^x^_)+j[15]+530742520&4294967295,E=A+(v<<16&4294967295|v>>>16),v=_+(E^A^x)+j[2]+3299628645&4294967295,_=E+(v<<23&4294967295|v>>>9),v=x+(E^(_|~A))+j[0]+4096336452&4294967295,x=_+(v<<6&4294967295|v>>>26),v=A+(_^(x|~E))+j[7]+1126891415&4294967295,A=x+(v<<10&4294967295|v>>>22),v=E+(x^(A|~_))+j[14]+2878612391&4294967295,E=A+(v<<15&4294967295|v>>>17),v=_+(A^(E|~x))+j[5]+4237533241&4294967295,_=E+(v<<21&4294967295|v>>>11),v=x+(E^(_|~A))+j[12]+1700485571&4294967295,x=_+(v<<6&4294967295|v>>>26),v=A+(_^(x|~E))+j[3]+2399980690&4294967295,A=x+(v<<10&4294967295|v>>>22),v=E+(x^(A|~_))+j[10]+4293915773&4294967295,E=A+(v<<15&4294967295|v>>>17),v=_+(A^(E|~x))+j[1]+2240044497&4294967295,_=E+(v<<21&4294967295|v>>>11),v=x+(E^(_|~A))+j[8]+1873313359&4294967295,x=_+(v<<6&4294967295|v>>>26),v=A+(_^(x|~E))+j[15]+4264355552&4294967295,A=x+(v<<10&4294967295|v>>>22),v=E+(x^(A|~_))+j[6]+2734768916&4294967295,E=A+(v<<15&4294967295|v>>>17),v=_+(A^(E|~x))+j[13]+1309151649&4294967295,_=E+(v<<21&4294967295|v>>>11),v=x+(E^(_|~A))+j[4]+4149444226&4294967295,x=_+(v<<6&4294967295|v>>>26),v=A+(_^(x|~E))+j[11]+3174756917&4294967295,A=x+(v<<10&4294967295|v>>>22),v=E+(x^(A|~_))+j[2]+718787259&4294967295,E=A+(v<<15&4294967295|v>>>17),v=_+(A^(E|~x))+j[9]+3951481745&4294967295,w.g[0]=w.g[0]+x&4294967295,w.g[1]=w.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,x){x===void 0&&(x=w.length);for(var _=x-this.blockSize,j=this.B,E=this.h,A=0;A<x;){if(E==0)for(;A<=_;)s(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<x;)if(j[E++]=w.charCodeAt(A++),E==this.blockSize){s(this,j),E=0;break}}else for(;A<x;)if(j[E++]=w[A++],E==this.blockSize){s(this,j),E=0;break}}this.h=E,this.o+=x},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var x=1;x<w.length-8;++x)w[x]=0;var _=8*this.o;for(x=w.length-8;x<w.length;++x)w[x]=_&255,_/=256;for(this.u(w),w=Array(16),x=_=0;4>x;++x)for(var j=0;32>j;j+=8)w[_++]=this.g[x]>>>j&255;return w};function a(w,x){var _=c;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=x(w)}function o(w,x){this.h=x;for(var _=[],j=!0,E=w.length-1;0<=E;E--){var A=w[E]|0;j&&A==x||(_[E]=A,j=!1)}this.g=_}var c={};function u(w){return-128<=w&&128>w?a(w,function(x){return new o([x|0],0>x?-1:0)}):new o([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return D(h(-w));for(var x=[],_=1,j=0;w>=_;j++)x[j]=w/_|0,_*=4294967296;return new o(x,0)}function f(w,x){if(w.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(w.charAt(0)=="-")return D(f(w.substring(1),x));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(x,8)),j=g,E=0;E<w.length;E+=8){var A=Math.min(8,w.length-E),v=parseInt(w.substring(E,E+A),x);8>A?(A=h(Math.pow(x,A)),j=j.j(A).add(h(v))):(j=j.j(_),j=j.add(h(v)))}return j}var g=u(0),p=u(1),N=u(16777216);t=o.prototype,t.m=function(){if(T(this))return-D(this).m();for(var w=0,x=1,_=0;_<this.g.length;_++){var j=this.i(_);w+=(0<=j?j:4294967296+j)*x,x*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(k(this))return"0";if(T(this))return"-"+D(this).toString(w);for(var x=h(Math.pow(w,6)),_=this,j="";;){var E=C(_,x).g;_=S(_,E.j(x));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,k(_))return A+j;for(;6>A.length;)A="0"+A;j=A+j}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function k(w){if(w.h!=0)return!1;for(var x=0;x<w.g.length;x++)if(w.g[x]!=0)return!1;return!0}function T(w){return w.h==-1}t.l=function(w){return w=S(this,w),T(w)?-1:k(w)?0:1};function D(w){for(var x=w.g.length,_=[],j=0;j<x;j++)_[j]=~w.g[j];return new o(_,~w.h).add(p)}t.abs=function(){return T(this)?D(this):this},t.add=function(w){for(var x=Math.max(this.g.length,w.g.length),_=[],j=0,E=0;E<=x;E++){var A=j+(this.i(E)&65535)+(w.i(E)&65535),v=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);j=v>>>16,A&=65535,v&=65535,_[E]=v<<16|A}return new o(_,_[_.length-1]&-2147483648?-1:0)};function S(w,x){return w.add(D(x))}t.j=function(w){if(k(this)||k(w))return g;if(T(this))return T(w)?D(this).j(D(w)):D(D(this).j(w));if(T(w))return D(this.j(D(w)));if(0>this.l(N)&&0>w.l(N))return h(this.m()*w.m());for(var x=this.g.length+w.g.length,_=[],j=0;j<2*x;j++)_[j]=0;for(j=0;j<this.g.length;j++)for(var E=0;E<w.g.length;E++){var A=this.i(j)>>>16,v=this.i(j)&65535,ae=w.i(E)>>>16,Z=w.i(E)&65535;_[2*j+2*E]+=v*Z,b(_,2*j+2*E),_[2*j+2*E+1]+=A*Z,b(_,2*j+2*E+1),_[2*j+2*E+1]+=v*ae,b(_,2*j+2*E+1),_[2*j+2*E+2]+=A*ae,b(_,2*j+2*E+2)}for(j=0;j<x;j++)_[j]=_[2*j+1]<<16|_[2*j];for(j=x;j<2*x;j++)_[j]=0;return new o(_,0)};function b(w,x){for(;(w[x]&65535)!=w[x];)w[x+1]+=w[x]>>>16,w[x]&=65535,x++}function I(w,x){this.g=w,this.h=x}function C(w,x){if(k(x))throw Error("division by zero");if(k(w))return new I(g,g);if(T(w))return x=C(D(w),x),new I(D(x.g),D(x.h));if(T(x))return x=C(w,D(x)),new I(D(x.g),x.h);if(30<w.g.length){if(T(w)||T(x))throw Error("slowDivide_ only works with positive integers.");for(var _=p,j=x;0>=j.l(w);)_=L(_),j=L(j);var E=R(_,1),A=R(j,1);for(j=R(j,2),_=R(_,2);!k(j);){var v=A.add(j);0>=v.l(w)&&(E=E.add(_),A=v),j=R(j,1),_=R(_,1)}return x=S(w,E.j(x)),new I(E,x)}for(E=g;0<=w.l(x);){for(_=Math.max(1,Math.floor(w.m()/x.m())),j=Math.ceil(Math.log(_)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),A=h(_),v=A.j(x);T(v)||0<v.l(w);)_-=j,A=h(_),v=A.j(x);k(A)&&(A=p),E=E.add(A),w=S(w,v)}return new I(E,w)}t.A=function(w){return C(this,w).h},t.and=function(w){for(var x=Math.max(this.g.length,w.g.length),_=[],j=0;j<x;j++)_[j]=this.i(j)&w.i(j);return new o(_,this.h&w.h)},t.or=function(w){for(var x=Math.max(this.g.length,w.g.length),_=[],j=0;j<x;j++)_[j]=this.i(j)|w.i(j);return new o(_,this.h|w.h)},t.xor=function(w){for(var x=Math.max(this.g.length,w.g.length),_=[],j=0;j<x;j++)_[j]=this.i(j)^w.i(j);return new o(_,this.h^w.h)};function L(w){for(var x=w.g.length+1,_=[],j=0;j<x;j++)_[j]=w.i(j)<<1|w.i(j-1)>>>31;return new o(_,w.h)}function R(w,x){var _=x>>5;x%=32;for(var j=w.g.length-_,E=[],A=0;A<j;A++)E[A]=0<x?w.i(A+_)>>>x|w.i(A+_+1)<<32-x:w.i(A+_);return new o(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,rv=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,ls=o}).apply(typeof $p<"u"?$p:typeof self<"u"?self:typeof window<"u"?window:{});var Bo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sv,ta,iv,il,Sd,av,ov,lv;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,m){return l==Array.prototype||l==Object.prototype||(l[d]=m.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bo=="object"&&Bo];for(var d=0;d<l.length;++d){var m=l[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(l,d){if(d)e:{var m=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var P=l[y];if(!(P in m))break e;m=m[P]}l=l[l.length-1],y=m[l],d=d(y),d!=y&&d!=null&&e(m,l,{configurable:!0,writable:!0,value:d})}}function a(l,d){l instanceof String&&(l+="");var m=0,y=!1,P={next:function(){if(!y&&m<l.length){var F=m++;return{value:d(F,l[F]),done:!1}}return y=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}s("Array.prototype.values",function(l){return l||function(){return a(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function h(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function f(l,d,m){return l.call.apply(l.bind,arguments)}function g(l,d,m){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,y),l.apply(d,P)}}return function(){return l.apply(d,arguments)}}function p(l,d,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,p.apply(null,arguments)}function N(l,d){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function k(l,d){function m(){}m.prototype=d.prototype,l.aa=d.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(y,P,F){for(var K=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)K[Pe-2]=arguments[Pe];return d.prototype[P].apply(y,K)}}function T(l){const d=l.length;if(0<d){const m=Array(d);for(let y=0;y<d;y++)m[y]=l[y];return m}return[]}function D(l,d){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(u(y)){const P=l.length||0,F=y.length||0;l.length=P+F;for(let K=0;K<F;K++)l[P+K]=y[K]}else l.push(y)}}class S{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function b(l){return/^[\s\xa0]*$/.test(l)}function I(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function C(l){return C[" "](l),l}C[" "]=function(){};var L=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function R(l,d,m){for(const y in l)d.call(m,l[y],y,l)}function w(l,d){for(const m in l)d.call(void 0,l[m],m,l)}function x(l){const d={};for(const m in l)d[m]=l[m];return d}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(l,d){let m,y;for(let P=1;P<arguments.length;P++){y=arguments[P];for(m in y)l[m]=y[m];for(let F=0;F<_.length;F++)m=_[F],Object.prototype.hasOwnProperty.call(y,m)&&(l[m]=y[m])}}function E(l){var d=1;l=l.split(":");const m=[];for(;0<d&&l.length;)m.push(l.shift()),d--;return l.length&&m.push(l.join(":")),m}function A(l){c.setTimeout(()=>{throw l},0)}function v(){var l=q;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class ae{constructor(){this.h=this.g=null}add(d,m){const y=Z.get();y.set(d,m),this.h?this.h.next=y:this.g=y,this.h=y}}var Z=new S(()=>new O,l=>l.reset());class O{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let G,U=!1,q=new ae,X=()=>{const l=c.Promise.resolve(void 0);G=()=>{l.then(ee)}};var ee=()=>{for(var l;l=v();){try{l.h.call(l.g)}catch(m){A(m)}var d=Z;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}U=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var Ne=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};c.addEventListener("test",m,d),c.removeEventListener("test",m,d)}catch{}return l}();function Je(l,d){if(B.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(L){e:{try{C(d.nodeName);var P=!0;break e}catch{}P=!1}P||(d=null)}}else m=="mouseover"?d=l.fromElement:m=="mouseout"&&(d=l.toElement);this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Ue[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Je.aa.h.call(this)}}k(Je,B);var Ue={2:"touch",3:"pen",4:"mouse"};Je.prototype.h=function(){Je.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),vt=0;function sn(l,d,m,y,P){this.listener=l,this.proxy=null,this.src=d,this.type=m,this.capture=!!y,this.ha=P,this.key=++vt,this.da=this.fa=!1}function At(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function ne(l){this.src=l,this.g={},this.h=0}ne.prototype.add=function(l,d,m,y,P){var F=l.toString();l=this.g[F],l||(l=this.g[F]=[],this.h++);var K=Ke(l,d,y,P);return-1<K?(d=l[K],m||(d.fa=!1)):(d=new sn(d,this.src,F,!!y,P),d.fa=m,l.push(d)),d};function ye(l,d){var m=d.type;if(m in l.g){var y=l.g[m],P=Array.prototype.indexOf.call(y,d,void 0),F;(F=0<=P)&&Array.prototype.splice.call(y,P,1),F&&(At(d),l.g[m].length==0&&(delete l.g[m],l.h--))}}function Ke(l,d,m,y){for(var P=0;P<l.length;++P){var F=l[P];if(!F.da&&F.listener==d&&F.capture==!!m&&F.ha==y)return P}return-1}var wt="closure_lm_"+(1e6*Math.random()|0),Bt={};function M(l,d,m,y,P){if(Array.isArray(d)){for(var F=0;F<d.length;F++)M(l,d[F],m,y,P);return null}return m=Qr(m),l&&l[ce]?l.K(d,m,h(y)?!!y.capture:!1,P):J(l,d,m,!1,y,P)}function J(l,d,m,y,P,F){if(!d)throw Error("Invalid event type");var K=h(P)?!!P.capture:!!P,Pe=fe(l);if(Pe||(l[wt]=Pe=new ne(l)),m=Pe.add(d,m,y,K,F),m.proxy)return m;if(y=he(),m.proxy=y,y.src=l,y.listener=m,l.addEventListener)Ne||(P=K),P===void 0&&(P=!1),l.addEventListener(d.toString(),y,P);else if(l.attachEvent)l.attachEvent(xe(d.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function he(){function l(m){return d.call(l.src,l.listener,m)}const d=Ce;return l}function de(l,d,m,y,P){if(Array.isArray(d))for(var F=0;F<d.length;F++)de(l,d[F],m,y,P);else y=h(y)?!!y.capture:!!y,m=Qr(m),l&&l[ce]?(l=l.i,d=String(d).toString(),d in l.g&&(F=l.g[d],m=Ke(F,m,y,P),-1<m&&(At(F[m]),Array.prototype.splice.call(F,m,1),F.length==0&&(delete l.g[d],l.h--)))):l&&(l=fe(l))&&(d=l.g[d.toString()],l=-1,d&&(l=Ke(d,m,y,P)),(m=-1<l?d[l]:null)&&ue(m))}function ue(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[ce])ye(d.i,l);else{var m=l.type,y=l.proxy;d.removeEventListener?d.removeEventListener(m,y,l.capture):d.detachEvent?d.detachEvent(xe(m),y):d.addListener&&d.removeListener&&d.removeListener(y),(m=fe(d))?(ye(m,l),m.h==0&&(m.src=null,d[wt]=null)):At(l)}}}function xe(l){return l in Bt?Bt[l]:Bt[l]="on"+l}function Ce(l,d){if(l.da)l=!0;else{d=new Je(d,this);var m=l.listener,y=l.ha||l.src;l.fa&&ue(l),l=m.call(y,d)}return l}function fe(l){return l=l[wt],l instanceof ne?l:null}var ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qr(l){return typeof l=="function"?l:(l[ct]||(l[ct]=function(d){return l.handleEvent(d)}),l[ct])}function Ze(){Q.call(this),this.i=new ne(this),this.M=this,this.F=null}k(Ze,Q),Ze.prototype[ce]=!0,Ze.prototype.removeEventListener=function(l,d,m,y){de(this,l,d,m,y)};function _t(l,d){var m,y=l.F;if(y)for(m=[];y;y=y.F)m.push(y);if(l=l.M,y=d.type||d,typeof d=="string")d=new B(d,l);else if(d instanceof B)d.target=d.target||l;else{var P=d;d=new B(y,l),j(d,P)}if(P=!0,m)for(var F=m.length-1;0<=F;F--){var K=d.g=m[F];P=W(K,y,!0,d)&&P}if(K=d.g=l,P=W(K,y,!0,d)&&P,P=W(K,y,!1,d)&&P,m)for(F=0;F<m.length;F++)K=d.g=m[F],P=W(K,y,!1,d)&&P}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var m=l.g[d],y=0;y<m.length;y++)At(m[y]);delete l.g[d],l.h--}}this.F=null},Ze.prototype.K=function(l,d,m,y){return this.i.add(String(l),d,!1,m,y)},Ze.prototype.L=function(l,d,m,y){return this.i.add(String(l),d,!0,m,y)};function W(l,d,m,y){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var P=!0,F=0;F<d.length;++F){var K=d[F];if(K&&!K.da&&K.capture==m){var Pe=K.listener,bt=K.ha||K.src;K.fa&&ye(l.i,K),P=Pe.call(bt,y)!==!1&&P}}return P&&!y.defaultPrevented}function Y(l,d,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(l,d||0)}function mt(l){l.g=Y(()=>{l.g=null,l.i&&(l.i=!1,mt(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class an extends Q{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function st(l){Q.call(this),this.h=l,this.g={}}k(st,Q);var et=[];function ie(l){R(l.g,function(d,m){this.g.hasOwnProperty(m)&&ue(d)},l),l.g={}}st.prototype.N=function(){st.aa.N.call(this),ie(this)},st.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ut=c.JSON.stringify,ft=c.JSON.parse,tt=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function $e(){}$e.prototype.h=null;function dr(l){return l.h||(l.h=l.i())}function Hn(){}var Yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ti(){B.call(this,"d")}k(Ti,B);function Ii(){B.call(this,"c")}k(Ii,B);var hr={},ki=null;function Ss(){return ki=ki||new Ze}hr.La="serverreachability";function Ai(l){B.call(this,hr.La,l)}k(Ai,B);function jn(l){const d=Ss();_t(d,new Ai(d))}hr.STAT_EVENT="statevent";function Ci(l,d){B.call(this,hr.STAT_EVENT,l),this.stat=d}k(Ci,B);function zt(l){const d=Ss();_t(d,new Ci(d,l))}hr.Ma="timingevent";function Vm(l,d){B.call(this,hr.Ma,l),this.size=d}k(Vm,B);function Pi(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},d)}function Ri(){this.g=!0}Ri.prototype.xa=function(){this.g=!1};function R0(l,d,m,y,P,F){l.info(function(){if(l.g)if(F)for(var K="",Pe=F.split("&"),bt=0;bt<Pe.length;bt++){var Se=Pe[bt].split("=");if(1<Se.length){var Ct=Se[0];Se=Se[1];var Pt=Ct.split("_");K=2<=Pt.length&&Pt[1]=="type"?K+(Ct+"="+Se+"&"):K+(Ct+"=redacted&")}}else K=null;else K=F;return"XMLHTTP REQ ("+y+") [attempt "+P+"]: "+d+`
`+m+`
`+K})}function D0(l,d,m,y,P,F,K){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+P+"]: "+d+`
`+m+`
`+F+" "+K})}function Ts(l,d,m,y){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+O0(l,m)+(y?" "+y:"")})}function V0(l,d){l.info(function(){return"TIMEOUT: "+d})}Ri.prototype.info=function(){};function O0(l,d){if(!l.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var y=m[l];if(!(2>y.length)){var P=y[1];if(Array.isArray(P)&&!(1>P.length)){var F=P[0];if(F!="noop"&&F!="stop"&&F!="close")for(var K=1;K<P.length;K++)P[K]=""}}}}return ut(m)}catch{return d}}var uo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Om={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rc;function ho(){}k(ho,$e),ho.prototype.g=function(){return new XMLHttpRequest},ho.prototype.i=function(){return{}},Rc=new ho;function mr(l,d,m,y){this.j=l,this.i=d,this.l=m,this.R=y||1,this.U=new st(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Mm}function Mm(){this.i=null,this.g="",this.h=!1}var Fm={},Dc={};function Vc(l,d,m){l.L=1,l.v=go(Qn(d)),l.m=m,l.P=!0,Lm(l,null)}function Lm(l,d){l.F=Date.now(),mo(l),l.A=Qn(l.v);var m=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),Zm(m.i,"t",y),l.C=0,m=l.j.J,l.h=new Mm,l.g=yf(l.j,m?d:null,!l.m),0<l.O&&(l.M=new an(p(l.Y,l,l.g),l.O)),d=l.U,m=l.g,y=l.ca;var P="readystatechange";Array.isArray(P)||(P&&(et[0]=P.toString()),P=et);for(var F=0;F<P.length;F++){var K=M(m,P[F],y||d.handleEvent,!1,d.h||d);if(!K)break;d.g[K.key]=K}d=l.H?x(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),jn(),R0(l.i,l.u,l.A,l.l,l.R,l.m)}mr.prototype.ca=function(l){l=l.target;const d=this.M;d&&Wn(l)==3?d.j():this.Y(l)},mr.prototype.Y=function(l){try{if(l==this.g)e:{const Pt=Wn(this.g);var d=this.g.Ba();const As=this.g.Z();if(!(3>Pt)&&(Pt!=3||this.g&&(this.h.h||this.g.oa()||of(this.g)))){this.J||Pt!=4||d==7||(d==8||0>=As?jn(3):jn(2)),Oc(this);var m=this.g.Z();this.X=m;t:if(Um(this)){var y=of(this.g);l="";var P=y.length,F=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wr(this),Di(this);var K="";break t}this.h.i=new c.TextDecoder}for(d=0;d<P;d++)this.h.h=!0,l+=this.h.i.decode(y[d],{stream:!(F&&d==P-1)});y.length=0,this.h.g+=l,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=m==200,D0(this.i,this.u,this.A,this.l,this.R,Pt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Pe,bt=this.g;if((Pe=bt.g?bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Pe)){var Se=Pe;break t}}Se=null}if(m=Se)Ts(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mc(this,m);else{this.o=!1,this.s=3,zt(12),Wr(this),Di(this);break e}}if(this.P){m=!0;let En;for(;!this.J&&this.C<K.length;)if(En=M0(this,K),En==Dc){Pt==4&&(this.s=4,zt(14),m=!1),Ts(this.i,this.l,null,"[Incomplete Response]");break}else if(En==Fm){this.s=4,zt(15),Ts(this.i,this.l,K,"[Invalid Chunk]"),m=!1;break}else Ts(this.i,this.l,En,null),Mc(this,En);if(Um(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||K.length!=0||this.h.h||(this.s=1,zt(16),m=!1),this.o=this.o&&m,!m)Ts(this.i,this.l,K,"[Invalid Chunked Response]"),Wr(this),Di(this);else if(0<K.length&&!this.W){this.W=!0;var Ct=this.j;Ct.g==this&&Ct.ba&&!Ct.M&&(Ct.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),zc(Ct),Ct.M=!0,zt(11))}}else Ts(this.i,this.l,K,null),Mc(this,K);Pt==4&&Wr(this),this.o&&!this.J&&(Pt==4?ff(this.j,this):(this.o=!1,mo(this)))}else ew(this.g),m==400&&0<K.indexOf("Unknown SID")?(this.s=3,zt(12)):(this.s=0,zt(13)),Wr(this),Di(this)}}}catch{}finally{}};function Um(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function M0(l,d){var m=l.C,y=d.indexOf(`
`,m);return y==-1?Dc:(m=Number(d.substring(m,y)),isNaN(m)?Fm:(y+=1,y+m>d.length?Dc:(d=d.slice(y,y+m),l.C=y+m,d)))}mr.prototype.cancel=function(){this.J=!0,Wr(this)};function mo(l){l.S=Date.now()+l.I,$m(l,l.I)}function $m(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Pi(p(l.ba,l),d)}function Oc(l){l.B&&(c.clearTimeout(l.B),l.B=null)}mr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(V0(this.i,this.A),this.L!=2&&(jn(),zt(17)),Wr(this),this.s=2,Di(this)):$m(this,this.S-l)};function Di(l){l.j.G==0||l.J||ff(l.j,l)}function Wr(l){Oc(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,ie(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function Mc(l,d){try{var m=l.j;if(m.G!=0&&(m.g==l||Fc(m.h,l))){if(!l.K&&Fc(m.h,l)&&m.G==3){try{var y=m.Da.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var P=y;if(P[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)bo(m),wo(m);else break e;Bc(m),zt(18)}}else m.za=P[1],0<m.za-m.T&&37500>P[2]&&m.F&&m.v==0&&!m.C&&(m.C=Pi(p(m.Za,m),6e3));if(1>=qm(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Gr(m,11)}else if((l.K||m.g==l)&&bo(m),!b(d))for(P=m.Da.g.parse(d),d=0;d<P.length;d++){let Se=P[d];if(m.T=Se[0],Se=Se[1],m.G==2)if(Se[0]=="c"){m.K=Se[1],m.ia=Se[2];const Ct=Se[3];Ct!=null&&(m.la=Ct,m.j.info("VER="+m.la));const Pt=Se[4];Pt!=null&&(m.Aa=Pt,m.j.info("SVER="+m.Aa));const As=Se[5];As!=null&&typeof As=="number"&&0<As&&(y=1.5*As,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const En=l.g;if(En){const jo=En.g?En.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jo){var F=y.h;F.g||jo.indexOf("spdy")==-1&&jo.indexOf("quic")==-1&&jo.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Lc(F,F.h),F.h=null))}if(y.D){const qc=En.g?En.g.getResponseHeader("X-HTTP-Session-Id"):null;qc&&(y.ya=qc,Ve(y.I,y.D,qc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var K=l;if(y.qa=xf(y,y.J?y.ia:null,y.W),K.K){Hm(y.h,K);var Pe=K,bt=y.L;bt&&(Pe.I=bt),Pe.B&&(Oc(Pe),mo(Pe)),y.g=K}else hf(y);0<m.i.length&&_o(m)}else Se[0]!="stop"&&Se[0]!="close"||Gr(m,7);else m.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?Gr(m,7):$c(m):Se[0]!="noop"&&m.l&&m.l.ta(Se),m.v=0)}}jn(4)}catch{}}var F0=class{constructor(l,d){this.g=l,this.map=d}};function Bm(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function qm(l){return l.h?1:l.g?l.g.size:0}function Fc(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function Lc(l,d){l.g?l.g.add(d):l.h=d}function Hm(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}Bm.prototype.cancel=function(){if(this.i=Qm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Qm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const m of l.g.values())d=d.concat(m.D);return d}return T(l.i)}function L0(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var d=[],m=l.length,y=0;y<m;y++)d.push(l[y]);return d}d=[],m=0;for(y in l)d[m++]=l[y];return d}function U0(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var d=[];l=l.length;for(var m=0;m<l;m++)d.push(m);return d}d=[],m=0;for(const y in l)d[m++]=y;return d}}}function Wm(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var m=U0(l),y=L0(l),P=y.length,F=0;F<P;F++)d.call(void 0,y[F],m&&m[F],l)}var Km=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $0(l,d){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var y=l[m].indexOf("="),P=null;if(0<=y){var F=l[m].substring(0,y);P=l[m].substring(y+1)}else F=l[m];d(F,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Kr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Kr){this.h=l.h,fo(this,l.j),this.o=l.o,this.g=l.g,po(this,l.s),this.l=l.l;var d=l.i,m=new Mi;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),Gm(this,m),this.m=l.m}else l&&(d=String(l).match(Km))?(this.h=!1,fo(this,d[1]||"",!0),this.o=Vi(d[2]||""),this.g=Vi(d[3]||"",!0),po(this,d[4]),this.l=Vi(d[5]||"",!0),Gm(this,d[6]||"",!0),this.m=Vi(d[7]||"")):(this.h=!1,this.i=new Mi(null,this.h))}Kr.prototype.toString=function(){var l=[],d=this.j;d&&l.push(Oi(d,Ym,!0),":");var m=this.g;return(m||d=="file")&&(l.push("//"),(d=this.o)&&l.push(Oi(d,Ym,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Oi(m,m.charAt(0)=="/"?q0:z0,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Oi(m,Q0)),l.join("")};function Qn(l){return new Kr(l)}function fo(l,d,m){l.j=m?Vi(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function po(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function Gm(l,d,m){d instanceof Mi?(l.i=d,W0(l.i,l.h)):(m||(d=Oi(d,H0)),l.i=new Mi(d,l.h))}function Ve(l,d,m){l.i.set(d,m)}function go(l){return Ve(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Vi(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Oi(l,d,m){return typeof l=="string"?(l=encodeURI(l).replace(d,B0),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function B0(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ym=/[#\/\?@]/g,z0=/[#\?:]/g,q0=/[#\?]/g,H0=/[#\?@]/g,Q0=/#/g;function Mi(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function fr(l){l.g||(l.g=new Map,l.h=0,l.i&&$0(l.i,function(d,m){l.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}t=Mi.prototype,t.add=function(l,d){fr(this),this.i=null,l=Is(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(d),this.h+=1,this};function Xm(l,d){fr(l),d=Is(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function Jm(l,d){return fr(l),d=Is(l,d),l.g.has(d)}t.forEach=function(l,d){fr(this),this.g.forEach(function(m,y){m.forEach(function(P){l.call(d,P,y,this)},this)},this)},t.na=function(){fr(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let y=0;y<d.length;y++){const P=l[y];for(let F=0;F<P.length;F++)m.push(d[y])}return m},t.V=function(l){fr(this);let d=[];if(typeof l=="string")Jm(this,l)&&(d=d.concat(this.g.get(Is(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)d=d.concat(l[m])}return d},t.set=function(l,d){return fr(this),this.i=null,l=Is(this,l),Jm(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function Zm(l,d,m){Xm(l,d),0<m.length&&(l.i=null,l.g.set(Is(l,d),T(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var y=d[m];const F=encodeURIComponent(String(y)),K=this.V(y);for(y=0;y<K.length;y++){var P=F;K[y]!==""&&(P+="="+encodeURIComponent(String(K[y]))),l.push(P)}}return this.i=l.join("&")};function Is(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function W0(l,d){d&&!l.j&&(fr(l),l.i=null,l.g.forEach(function(m,y){var P=y.toLowerCase();y!=P&&(Xm(this,y),Zm(this,P,m))},l)),l.j=d}function K0(l,d){const m=new Ri;if(c.Image){const y=new Image;y.onload=N(pr,m,"TestLoadImage: loaded",!0,d,y),y.onerror=N(pr,m,"TestLoadImage: error",!1,d,y),y.onabort=N(pr,m,"TestLoadImage: abort",!1,d,y),y.ontimeout=N(pr,m,"TestLoadImage: timeout",!1,d,y),c.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else d(!1)}function G0(l,d){const m=new Ri,y=new AbortController,P=setTimeout(()=>{y.abort(),pr(m,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:y.signal}).then(F=>{clearTimeout(P),F.ok?pr(m,"TestPingServer: ok",!0,d):pr(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(P),pr(m,"TestPingServer: error",!1,d)})}function pr(l,d,m,y,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),y(m)}catch{}}function Y0(){this.g=new tt}function X0(l,d,m){const y=m||"";try{Wm(l,function(P,F){let K=P;h(P)&&(K=ut(P)),d.push(y+F+"="+encodeURIComponent(K))})}catch(P){throw d.push(y+"type="+encodeURIComponent("_badmap")),P}}function xo(l){this.l=l.Ub||null,this.j=l.eb||!1}k(xo,$e),xo.prototype.g=function(){return new yo(this.l,this.j)},xo.prototype.i=function(l){return function(){return l}}({});function yo(l,d){Ze.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(yo,Ze),t=yo.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,Li(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Li(this)),this.g&&(this.readyState=3,Li(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ef(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function ef(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?Fi(this):Li(this),this.readyState==3&&ef(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Fi(this))},t.Qa=function(l){this.g&&(this.response=l,Fi(this))},t.ga=function(){this.g&&Fi(this)};function Fi(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Li(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=d.next();return l.join(`\r
`)};function Li(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(yo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function tf(l){let d="";return R(l,function(m,y){d+=y,d+=":",d+=m,d+=`\r
`}),d}function Uc(l,d,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=tf(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):Ve(l,d,m))}function Ge(l){Ze.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(Ge,Ze);var J0=/^https?$/i,Z0=["POST","PUT"];t=Ge.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rc.g(),this.v=this.o?dr(this.o):dr(Rc),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch(F){nf(this,F);return}if(l=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var P in y)m.set(P,y[P]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const F of y.keys())m.set(F,y.get(F));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(F=>F.toLowerCase()=="content-type"),P=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Z0,d,void 0))||y||P||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,K]of m)this.g.setRequestHeader(F,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{af(this),this.u=!0,this.g.send(l),this.u=!1}catch(F){nf(this,F)}};function nf(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,rf(l),vo(l)}function rf(l){l.A||(l.A=!0,_t(l,"complete"),_t(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,_t(this,"complete"),_t(this,"abort"),vo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vo(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?sf(this):this.bb())},t.bb=function(){sf(this)};function sf(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Wn(l)!=4||l.Z()!=2)){if(l.u&&Wn(l)==4)Y(l.Ea,0,l);else if(_t(l,"readystatechange"),Wn(l)==4){l.h=!1;try{const K=l.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var y;if(y=K===0){var P=String(l.D).match(Km)[1]||null;!P&&c.self&&c.self.location&&(P=c.self.location.protocol.slice(0,-1)),y=!J0.test(P?P.toLowerCase():"")}m=y}if(m)_t(l,"complete"),_t(l,"success");else{l.m=6;try{var F=2<Wn(l)?l.g.statusText:""}catch{F=""}l.l=F+" ["+l.Z()+"]",rf(l)}}finally{vo(l)}}}}function vo(l,d){if(l.g){af(l);const m=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||_t(l,"ready");try{m.onreadystatechange=y}catch{}}}function af(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Wn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),ft(d)}};function of(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function ew(l){const d={};l=(l.g&&2<=Wn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(b(l[y]))continue;var m=E(l[y]);const P=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const F=d[P]||[];d[P]=F,F.push(m)}w(d,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ui(l,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||d}function lf(l){this.Aa=0,this.i=[],this.j=new Ri,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ui("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ui("baseRetryDelayMs",5e3,l),this.cb=Ui("retryDelaySeedMs",1e4,l),this.Wa=Ui("forwardChannelMaxRetries",2,l),this.wa=Ui("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Bm(l&&l.concurrentRequestLimit),this.Da=new Y0,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=lf.prototype,t.la=8,t.G=1,t.connect=function(l,d,m,y){zt(0),this.W=l,this.H=d||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=xf(this,null,this.W),_o(this)};function $c(l){if(cf(l),l.G==3){var d=l.U++,m=Qn(l.I);if(Ve(m,"SID",l.K),Ve(m,"RID",d),Ve(m,"TYPE","terminate"),$i(l,m),d=new mr(l,l.j,d),d.L=2,d.v=go(Qn(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=d.v,m=!0),m||(d.g=yf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),mo(d)}gf(l)}function wo(l){l.g&&(zc(l),l.g.cancel(),l.g=null)}function cf(l){wo(l),l.u&&(c.clearTimeout(l.u),l.u=null),bo(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function _o(l){if(!zm(l.h)&&!l.s){l.s=!0;var d=l.Ga;G||X(),U||(G(),U=!0),q.add(d,l),l.B=0}}function tw(l,d){return qm(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Pi(p(l.Ga,l,d),pf(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const P=new mr(this,this.j,l);let F=this.o;if(this.S&&(F?(F=x(F),j(F,this.S)):F=this.S),this.m!==null||this.O||(P.H=F,F=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(d+=y,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=df(this,P,d),m=Qn(this.I),Ve(m,"RID",l),Ve(m,"CVER",22),this.D&&Ve(m,"X-HTTP-Session-Id",this.D),$i(this,m),F&&(this.O?d="headers="+encodeURIComponent(String(tf(F)))+"&"+d:this.m&&Uc(m,this.m,F)),Lc(this.h,P),this.Ua&&Ve(m,"TYPE","init"),this.P?(Ve(m,"$req",d),Ve(m,"SID","null"),P.T=!0,Vc(P,m,null)):Vc(P,m,d),this.G=2}}else this.G==3&&(l?uf(this,l):this.i.length==0||zm(this.h)||uf(this))};function uf(l,d){var m;d?m=d.l:m=l.U++;const y=Qn(l.I);Ve(y,"SID",l.K),Ve(y,"RID",m),Ve(y,"AID",l.T),$i(l,y),l.m&&l.o&&Uc(y,l.m,l.o),m=new mr(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),d&&(l.i=d.D.concat(l.i)),d=df(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Lc(l.h,m),Vc(m,y,d)}function $i(l,d){l.H&&R(l.H,function(m,y){Ve(d,y,m)}),l.l&&Wm({},function(m,y){Ve(d,y,m)})}function df(l,d,m){m=Math.min(l.i.length,m);var y=l.l?p(l.l.Na,l.l,l):null;e:{var P=l.i;let F=-1;for(;;){const K=["count="+m];F==-1?0<m?(F=P[0].g,K.push("ofs="+F)):F=0:K.push("ofs="+F);let Pe=!0;for(let bt=0;bt<m;bt++){let Se=P[bt].g;const Ct=P[bt].map;if(Se-=F,0>Se)F=Math.max(0,P[bt].g-100),Pe=!1;else try{X0(Ct,K,"req"+Se+"_")}catch{y&&y(Ct)}}if(Pe){y=K.join("&");break e}}}return l=l.i.splice(0,m),d.D=l,y}function hf(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;G||X(),U||(G(),U=!0),q.add(d,l),l.v=0}}function Bc(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Pi(p(l.Fa,l),pf(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,mf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Pi(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,zt(10),wo(this),mf(this))};function zc(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function mf(l){l.g=new mr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=Qn(l.qa);Ve(d,"RID","rpc"),Ve(d,"SID",l.K),Ve(d,"AID",l.T),Ve(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ve(d,"TO",l.ja),Ve(d,"TYPE","xmlhttp"),$i(l,d),l.m&&l.o&&Uc(d,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=go(Qn(d)),m.m=null,m.P=!0,Lm(m,l)}t.Za=function(){this.C!=null&&(this.C=null,wo(this),Bc(this),zt(19))};function bo(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function ff(l,d){var m=null;if(l.g==d){bo(l),zc(l),l.g=null;var y=2}else if(Fc(l.h,d))m=d.D,Hm(l.h,d),y=1;else return;if(l.G!=0){if(d.o)if(y==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var P=l.B;y=Ss(),_t(y,new Vm(y,m)),_o(l)}else hf(l);else if(P=d.s,P==3||P==0&&0<d.X||!(y==1&&tw(l,d)||y==2&&Bc(l)))switch(m&&0<m.length&&(d=l.h,d.i=d.i.concat(m)),P){case 1:Gr(l,5);break;case 4:Gr(l,10);break;case 3:Gr(l,6);break;default:Gr(l,2)}}}function pf(l,d){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*d}function Gr(l,d){if(l.j.info("Error code "+d),d==2){var m=p(l.fb,l),y=l.Xa;const P=!y;y=new Kr(y||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||fo(y,"https"),go(y),P?K0(y.toString(),m):G0(y.toString(),m)}else zt(2);l.G=0,l.l&&l.l.sa(d),gf(l),cf(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function gf(l){if(l.G=0,l.ka=[],l.l){const d=Qm(l.h);(d.length!=0||l.i.length!=0)&&(D(l.ka,d),D(l.ka,l.i),l.h.i.length=0,T(l.i),l.i.length=0),l.l.ra()}}function xf(l,d,m){var y=m instanceof Kr?Qn(m):new Kr(m);if(y.g!="")d&&(y.g=d+"."+y.g),po(y,y.s);else{var P=c.location;y=P.protocol,d=d?d+"."+P.hostname:P.hostname,P=+P.port;var F=new Kr(null);y&&fo(F,y),d&&(F.g=d),P&&po(F,P),m&&(F.l=m),y=F}return m=l.D,d=l.ya,m&&d&&Ve(y,m,d),Ve(y,"VER",l.la),$i(l,y),y}function yf(l,d,m){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new Ge(new xo({eb:m})):new Ge(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vf(){}t=vf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function No(){}No.prototype.g=function(l,d){return new on(l,d)};function on(l,d){Ze.call(this),this.g=new lf(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!b(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!b(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new ks(this)}k(on,Ze),on.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},on.prototype.close=function(){$c(this.g)},on.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=ut(l),l=m);d.i.push(new F0(d.Ya++,l)),d.G==3&&_o(d)},on.prototype.N=function(){this.g.l=null,delete this.j,$c(this.g),delete this.g,on.aa.N.call(this)};function wf(l){Ti.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const m in d){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}k(wf,Ti);function _f(){Ii.call(this),this.status=1}k(_f,Ii);function ks(l){this.g=l}k(ks,vf),ks.prototype.ua=function(){_t(this.g,"a")},ks.prototype.ta=function(l){_t(this.g,new wf(l))},ks.prototype.sa=function(l){_t(this.g,new _f)},ks.prototype.ra=function(){_t(this.g,"b")},No.prototype.createWebChannel=No.prototype.g,on.prototype.send=on.prototype.o,on.prototype.open=on.prototype.m,on.prototype.close=on.prototype.close,lv=function(){return new No},ov=function(){return Ss()},av=hr,Sd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},uo.NO_ERROR=0,uo.TIMEOUT=8,uo.HTTP_ERROR=6,il=uo,Om.COMPLETE="complete",iv=Om,Hn.EventType=Yt,Yt.OPEN="a",Yt.CLOSE="b",Yt.ERROR="c",Yt.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,ta=Hn,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,sv=Ge}).apply(typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{});const Bp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ft=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ni="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps=new Xy("@firebase/firestore");function Yi(){return ps.logLevel}function se(t,...e){if(ps.logLevel<=je.DEBUG){const n=e.map(Uh);ps.debug(`Firestore (${Ni}): ${t}`,...n)}}function or(t,...e){if(ps.logLevel<=je.ERROR){const n=e.map(Uh);ps.error(`Firestore (${Ni}): ${t}`,...n)}}function ci(t,...e){if(ps.logLevel<=je.WARN){const n=e.map(Uh);ps.warn(`Firestore (${Ni}): ${t}`,...n)}}function Uh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${Ni}) INTERNAL ASSERTION FAILED: `+t;throw or(e),new Error(e)}function Ae(t,e){t||me()}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends bi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class uN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class dN{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ae(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new er;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ae(typeof r.accessToken=="string"),new cv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ae(e===null||typeof e=="string"),new Ft(e)}}class hN{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class mN{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new hN(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pN{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ae(this.o===void 0);const r=a=>{a.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const s=a=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ae(typeof n.token=="string"),this.R=n.token,new fN(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=gN(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<n&&(r+=e.charAt(s[a]%e.length))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function ui(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new lt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new lt(0,0))}static max(){return new pe(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(),r===void 0?r=e.length-n:r>e.length-n&&me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const a=e.get(s),o=n.get(s);if(a<o)return-1;if(a>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Fe extends La{construct(e,n,r){return new Fe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Fe(n)}static emptyPath(){return new Fe([])}}const xN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends La{construct(e,n,r){return new Et(e,n,r)}static isValidIdentifier(e){return xN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Et(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const a=()=>{if(r.length===0)throw new te($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new te($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new te($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(a(),s++)}if(a(),o)throw new te($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(n)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe(Fe.fromString(e))}static fromName(e){return new oe(Fe.fromString(e).popFirst(5))}static empty(){return new oe(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Fe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new Fe(e.slice()))}}function yN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new Mr(s,oe.empty(),e)}function vN(t){return new Mr(t.readTime,t.key,-1)}class Mr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mr(pe.min(),oe.empty(),-1)}static max(){return new Mr(pe.max(),oe.empty(),-1)}}function wN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==_N)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,a=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++a,o&&a===s&&n()},u=>r(u))}),o=!0,a===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,a)=>{r.push(n.call(this,s,a))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;n(e[h]).next(f=>{o[h]=f,++c,c===a&&r(o)},f=>s(f))}})}static doWhile(e,n){return new z((r,s)=>{const a=()=>{e()===!0?n().next(()=>{a()},s):r()};a()})}}function NN(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ro(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}$h.oe=-1;function hc(t){return t==null}function Fl(t){return t===0&&1/t==-1/0}function jN(t){return typeof t=="number"&&Number.isInteger(t)&&!Fl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _s(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function dv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new We(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zo(this.root,e,this.comparator,!1)}getReverseIterator(){return new zo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zo(this.root,e,this.comparator,!0)}}class zo{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,r,s,a){this.key=e,this.value=n,this.color=r??jt.RED,this.left=s??jt.EMPTY,this.right=a??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,a){return new jt(e??this.key,n??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,n,r),null):a===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return jt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,n,r,s,a){return this}insert(e,n,r){return new jt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qp(this.data.getIterator())}getIteratorFrom(e){return new qp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Tt(this.comparator);return n.data=e,n}}class qp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new un([])}unionWith(e){let n=new Tt(Et.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new un(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ui(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new hv("Invalid base64 string: "+a):a}}(e);return new kt(n)}static fromUint8Array(e){const n=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new kt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const EN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fr(t){if(Ae(!!t),typeof t=="string"){let e=0;const n=EN.exec(t);if(Ae(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gs(t){return typeof t=="string"?kt.fromBase64String(t):kt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function zh(t){const e=t.mapValue.fields.__previous_value__;return Bh(e)?zh(e):e}function Ua(t){const e=Fr(t.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n,r,s,a,o,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class $a{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new $a("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof $a&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo={mapValue:{}};function xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bh(t)?4:IN(t)?9007199254740991:TN(t)?10:11:me()}function qn(t,e){if(t===e)return!0;const n=xs(t);if(n!==xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ua(t).isEqual(Ua(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=Fr(s.timestampValue),c=Fr(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return gs(s.bytesValue).isEqual(gs(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return nt(s.geoPointValue.latitude)===nt(a.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return nt(s.integerValue)===nt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=nt(s.doubleValue),c=nt(a.doubleValue);return o===c?Fl(o)===Fl(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return ui(t.arrayValue.values||[],e.arrayValue.values||[],qn);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},c=a.mapValue.fields||{};if(zp(o)!==zp(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!qn(o[u],c[u])))return!1;return!0}(t,e);default:return me()}}function Ba(t,e){return(t.values||[]).find(n=>qn(n,e))!==void 0}function di(t,e){if(t===e)return 0;const n=xs(t),r=xs(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=nt(a.integerValue||a.doubleValue),u=nt(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Hp(t.timestampValue,e.timestampValue);case 4:return Hp(Ua(t),Ua(e));case 5:return Te(t.stringValue,e.stringValue);case 6:return function(a,o){const c=gs(a),u=gs(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=Te(c[h],u[h]);if(f!==0)return f}return Te(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=Te(nt(a.latitude),nt(o.latitude));return c!==0?c:Te(nt(a.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Qp(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,h,f;const g=a.fields||{},p=o.fields||{},N=(c=g.value)===null||c===void 0?void 0:c.arrayValue,k=(u=p.value)===null||u===void 0?void 0:u.arrayValue,T=Te(((h=N==null?void 0:N.values)===null||h===void 0?void 0:h.length)||0,((f=k==null?void 0:k.values)===null||f===void 0?void 0:f.length)||0);return T!==0?T:Qp(N,k)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===qo.mapValue&&o===qo.mapValue)return 0;if(a===qo.mapValue)return 1;if(o===qo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){const p=Te(u[g],f[g]);if(p!==0)return p;const N=di(c[u[g]],h[f[g]]);if(N!==0)return N}return Te(u.length,f.length)}(t.mapValue,e.mapValue);default:throw me()}}function Hp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=Fr(t),r=Fr(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function Qp(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const a=di(n[s],r[s]);if(a)return a}return Te(n.length,r.length)}function hi(t){return Td(t)}function Td(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const a of n.values||[])s?s=!1:r+=",",r+=Td(a);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",a=!0;for(const o of r)a?a=!1:s+=",",s+=`${o}:${Td(n.fields[o])}`;return s+"}"}(t.mapValue):me()}function Wp(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Id(t){return!!t&&"integerValue"in t}function qh(t){return!!t&&"arrayValue"in t}function Kp(t){return!!t&&"nullValue"in t}function Gp(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function al(t){return!!t&&"mapValue"in t}function TN(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ga(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return _s(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ga(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ga(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.value=e}static empty(){return new Jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!al(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ga(n)}setAll(e){let n=Et.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=ga(o):s.push(c.lastSegment())});const a=this.getFieldsMap(n);this.applyChanges(a,r,s)}delete(e){const n=this.field(e.popLast());al(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return qn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];al(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){_s(n,(s,a)=>e[s]=a);for(const s of r)delete e[s]}clone(){return new Jt(ga(this.value))}}function mv(t){const e=[];return _s(t.fields,(n,r)=>{const s=new Et([n]);if(al(r)){const a=mv(r.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n,r,s,a,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Ut(e,0,pe.min(),pe.min(),pe.min(),Jt.empty(),0)}static newFoundDocument(e,n,r,s){return new Ut(e,1,n,pe.min(),r,s,0)}static newNoDocument(e,n){return new Ut(e,2,n,pe.min(),pe.min(),Jt.empty(),0)}static newUnknownDocument(e,n){return new Ut(e,3,n,pe.min(),pe.min(),Jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.position=e,this.inclusive=n}}function Yp(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=di(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Xp(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!qn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,n="asc"){this.field=e,this.dir=n}}function kN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fv=class{};class ot extends fv{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new CN(e,n,r):n==="array-contains"?new DN(e,r):n==="in"?new VN(e,r):n==="not-in"?new ON(e,r):n==="array-contains-any"?new MN(e,r):new ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new PN(e,r):new RN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(di(n,this.value)):n!==null&&xs(this.value)===xs(n)&&this.matchesComparison(di(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dn extends fv{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Dn(e,n)}matches(e){return pv(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function pv(t){return t.op==="and"}function gv(t){return AN(t)&&pv(t)}function AN(t){for(const e of t.filters)if(e instanceof Dn)return!1;return!0}function kd(t){if(t instanceof ot)return t.field.canonicalString()+t.op.toString()+hi(t.value);if(gv(t))return t.filters.map(e=>kd(e)).join(",");{const e=t.filters.map(n=>kd(n)).join(",");return`${t.op}(${e})`}}function xv(t,e){return t instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&qn(r.value,s.value)}(t,e):t instanceof Dn?function(r,s){return s instanceof Dn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((a,o,c)=>a&&xv(o,s.filters[c]),!0):!1}(t,e):void me()}function yv(t){return t instanceof ot?function(n){return`${n.field.canonicalString()} ${n.op} ${hi(n.value)}`}(t):t instanceof Dn?function(n){return n.op.toString()+" {"+n.getFilters().map(yv).join(" ,")+"}"}(t):"Filter"}class CN extends ot{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class PN extends ot{constructor(e,n){super(e,"in",n),this.keys=vv("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RN extends ot{constructor(e,n){super(e,"not-in",n),this.keys=vv("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function vv(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class DN extends ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return qh(n)&&Ba(n.arrayValue,this.value)}}class VN extends ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ba(this.value.arrayValue,n)}}class ON extends ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ba(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ba(this.value.arrayValue,n)}}class MN extends ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!qh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ba(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,n=null,r=[],s=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=o,this.endAt=c,this.ue=null}}function Jp(t,e=null,n=[],r=[],s=null,a=null,o=null){return new FN(t,e,n,r,s,a,o)}function Hh(t){const e=ge(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>kd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),hc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>hi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>hi(r)).join(",")),e.ue=n}return e.ue}function Qh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kN(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!xv(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xp(t.startAt,e.startAt)&&Xp(t.endAt,e.endAt)}function Ad(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n=null,r=[],s=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function LN(t,e,n,r,s,a,o,c){return new ji(t,e,n,r,s,a,o,c)}function mc(t){return new ji(t)}function Zp(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wv(t){return t.collectionGroup!==null}function xa(t){const e=ge(t);if(e.ce===null){e.ce=[];const n=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Tt(Et.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{n.has(a.canonicalString())||a.isKeyField()||e.ce.push(new za(a,r))}),n.has(Et.keyField().canonicalString())||e.ce.push(new za(Et.keyField(),r))}return e.ce}function $n(t){const e=ge(t);return e.le||(e.le=UN(e,xa(t))),e.le}function UN(t,e){if(t.limitType==="F")return Jp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new za(s.field,a)});const n=t.endAt?new Ll(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ll(t.startAt.position,t.startAt.inclusive):null;return Jp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Cd(t,e){const n=t.filters.concat([e]);return new ji(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ul(t,e,n){return new ji(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fc(t,e){return Qh($n(t),$n(e))&&t.limitType===e.limitType}function _v(t){return`${Hh($n(t))}|lt:${t.limitType}`}function Ps(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>yv(s)).join(", ")}]`),hc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>hi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>hi(s)).join(",")),`Target(${r})`}($n(t))}; limitType=${t.limitType})`}function pc(t,e){return e.isFoundDocument()&&function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):oe.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(t,e)&&function(r,s){for(const a of xa(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const h=Yp(o,c,u);return o.inclusive?h<=0:h<0}(r.startAt,xa(r),s)||r.endAt&&!function(o,c,u){const h=Yp(o,c,u);return o.inclusive?h>=0:h>0}(r.endAt,xa(r),s))}(t,e)}function $N(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bv(t){return(e,n)=>{let r=!1;for(const s of xa(t)){const a=BN(s,e,n);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function BN(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(a,o,c){const u=o.data.field(a),h=c.data.field(a);return u!==null&&h!==null?di(u,h):me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){_s(this.inner,(n,r)=>{for(const[s,a]of r)e(s,a)})}isEmpty(){return dv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN=new We(oe.comparator);function lr(){return zN}const Nv=new We(oe.comparator);function na(...t){let e=Nv;for(const n of t)e=e.insert(n.key,n);return e}function jv(t){let e=Nv;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function rs(){return ya()}function Ev(){return ya()}function ya(){return new Ei(t=>t.toString(),(t,e)=>t.isEqual(e))}const qN=new We(oe.comparator),HN=new Tt(oe.comparator);function we(...t){let e=HN;for(const n of t)e=e.add(n);return e}const QN=new Tt(Te);function WN(){return QN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fl(e)?"-0":e}}function Sv(t){return{integerValue:""+t}}function KN(t,e){return jN(e)?Sv(e):Wh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this._=void 0}}function GN(t,e,n){return t instanceof qa?function(s,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&Bh(a)&&(a=zh(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(n,e):t instanceof Ha?Iv(t,e):t instanceof Qa?kv(t,e):function(s,a){const o=Tv(s,a),c=eg(o)+eg(s.Pe);return Id(o)&&Id(s.Pe)?Sv(c):Wh(s.serializer,c)}(t,e)}function YN(t,e,n){return t instanceof Ha?Iv(t,e):t instanceof Qa?kv(t,e):n}function Tv(t,e){return t instanceof $l?function(r){return Id(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class qa extends gc{}class Ha extends gc{constructor(e){super(),this.elements=e}}function Iv(t,e){const n=Av(e);for(const r of t.elements)n.some(s=>qn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Qa extends gc{constructor(e){super(),this.elements=e}}function kv(t,e){let n=Av(e);for(const r of t.elements)n=n.filter(s=>!qn(s,r));return{arrayValue:{values:n}}}class $l extends gc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function eg(t){return nt(t.integerValue||t.doubleValue)}function Av(t){return qh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,n){this.field=e,this.transform=n}}function JN(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ha&&s instanceof Ha||r instanceof Qa&&s instanceof Qa?ui(r.elements,s.elements,qn):r instanceof $l&&s instanceof $l?qn(r.Pe,s.Pe):r instanceof qa&&s instanceof qa}(t.transform,e.transform)}class ZN{constructor(e,n){this.version=e,this.transformResults=n}}class Pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ol(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xc{}function Cv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Kh(t.key,Pn.none()):new so(t.key,t.data,Pn.none());{const n=t.data,r=Jt.empty();let s=new Tt(Et.comparator);for(let a of e.fields)if(!s.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),s=s.add(a)}return new Hr(t.key,r,new un(s.toArray()),Pn.none())}}function ej(t,e,n){t instanceof so?function(s,a,o){const c=s.value.clone(),u=ng(s.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Hr?function(s,a,o){if(!ol(s.precondition,a))return void a.convertToUnknownDocument(o.version);const c=ng(s.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(Pv(s)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function va(t,e,n,r){return t instanceof so?function(a,o,c,u){if(!ol(a.precondition,o))return c;const h=a.value.clone(),f=rg(a.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hr?function(a,o,c,u){if(!ol(a.precondition,o))return c;const h=rg(a.fieldTransforms,u,o),f=o.data;return f.setAll(Pv(a)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(a,o,c){return ol(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function tj(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),a=Tv(r.transform,s||null);a!=null&&(n===null&&(n=Jt.empty()),n.set(r.field,a))}return n||null}function tg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ui(r,s,(a,o)=>JN(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class so extends xc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Hr extends xc{constructor(e,n,r,s,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Pv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ng(t,e,n){const r=new Map;Ae(t.length===n.length);for(let s=0;s<n.length;s++){const a=t[s],o=a.transform,c=e.data.field(a.field);r.set(a.field,YN(o,c,n[s]))}return r}function rg(t,e,n){const r=new Map;for(const s of t){const a=s.transform,o=n.data.field(s.field);r.set(s.field,GN(a,o,e))}return r}class Kh extends xc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nj extends xc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&ej(a,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=va(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=va(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Ev();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=n.has(s.key)?null:c;const u=Cv(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&ui(this.mutations,e.mutations,(n,r)=>tg(n,r))&&ui(this.baseMutations,e.baseMutations,(n,r)=>tg(n,r))}}class Gh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ae(e.mutations.length===r.length);let s=function(){return qN}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,r[o].version);return new Gh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it,_e;function aj(t){switch(t){default:return me();case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0}}function Rv(t){if(t===void 0)return or("GRPC error has no .code"),$.UNKNOWN;switch(t){case it.OK:return $.OK;case it.CANCELLED:return $.CANCELLED;case it.UNKNOWN:return $.UNKNOWN;case it.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case it.INTERNAL:return $.INTERNAL;case it.UNAVAILABLE:return $.UNAVAILABLE;case it.UNAUTHENTICATED:return $.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case it.NOT_FOUND:return $.NOT_FOUND;case it.ALREADY_EXISTS:return $.ALREADY_EXISTS;case it.PERMISSION_DENIED:return $.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case it.ABORTED:return $.ABORTED;case it.OUT_OF_RANGE:return $.OUT_OF_RANGE;case it.UNIMPLEMENTED:return $.UNIMPLEMENTED;case it.DATA_LOSS:return $.DATA_LOSS;default:return me()}}(_e=it||(it={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=new ls([4294967295,4294967295],0);function sg(t){const e=oj().encode(t),n=new rv;return n.update(e),new Uint8Array(n.digest())}function ig(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ls([n,r],0),new ls([s,a],0)]}class Yh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ra(`Invalid padding: ${n}`);if(r<0)throw new ra(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ra(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ra(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ls.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(ls.fromNumber(r)));return s.compare(lj)===1&&(s=new ls([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=sg(e),[r,s]=ig(n);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,s,a);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Yh(a,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const n=sg(e),[r,s]=ig(n);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,s,a);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n,r,s,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,io.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new yc(pe.min(),s,new We(Te),lr(),we())}}class io{constructor(e,n,r,s,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new io(r,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Dv{constructor(e,n){this.targetId=e,this.me=n}}class Vv{constructor(e,n,r=kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ag{constructor(){this.fe=0,this.ge=lg(),this.pe=kt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),r=we();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:me()}}),new io(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=lg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class cj{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=og(),this.Qe=new We(Te)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const a=s.target;if(Ad(a))if(r===0){const o=new oe(a.path);this.Ue(n,o,Ut.newNoDocument(o,pe.min()))}else Ae(r===1);else{const o=this.Ye(n);if(o!==r){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=n;let o,c;try{o=gs(r).toUint8Array()}catch(u){if(u instanceof hv)return ci("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Yh(o,s,a)}catch(u){return ci(u instanceof ra?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(a=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,a,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((a,o)=>{const c=this.Je(o);if(c){if(a.current&&Ad(c.target)){const u=new oe(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Ut.newNoDocument(u,e))}a.be&&(n.set(o,a.ve()),a.Ce())}});let r=we();this.qe.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const s=new yc(e,n,this.Qe,this.ke,r);return this.ke=lr(),this.qe=og(),this.Qe=new We(Te),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new ag,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Tt(Te),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||se("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ag),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function og(){return new We(oe.comparator)}function lg(){return new We(oe.comparator)}const uj={asc:"ASCENDING",desc:"DESCENDING"},dj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hj={and:"AND",or:"OR"};class mj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Pd(t,e){return t.useProto3Json||hc(e)?e:{value:e}}function Bl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ov(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fj(t,e){return Bl(t,e.toTimestamp())}function Bn(t){return Ae(!!t),pe.fromTimestamp(function(n){const r=Fr(n);return new lt(r.seconds,r.nanos)}(t))}function Xh(t,e){return Rd(t,e).canonicalString()}function Rd(t,e){const n=function(s){return new Fe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Mv(t){const e=Fe.fromString(t);return Ae(Bv(e)),e}function Dd(t,e){return Xh(t.databaseId,e.path)}function _u(t,e){const n=Mv(e);if(n.get(1)!==t.databaseId.projectId)throw new te($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(Lv(n))}function Fv(t,e){return Xh(t.databaseId,e)}function pj(t){const e=Mv(t);return e.length===4?Fe.emptyPath():Lv(e)}function Vd(t){return new Fe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Lv(t){return Ae(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function cg(t,e,n){return{name:Dd(t,e),fields:n.value.mapValue.fields}}function gj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(h,f){return h.useProto3Json?(Ae(f===void 0||typeof f=="string"),kt.fromBase64String(f||"")):(Ae(f===void 0||f instanceof Buffer||f instanceof Uint8Array),kt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const f=h.code===void 0?$.UNKNOWN:Rv(h.code);return new te(f,h.message||"")}(o);n=new Vv(r,s,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=_u(t,r.document.name),a=Bn(r.document.updateTime),o=r.document.createTime?Bn(r.document.createTime):pe.min(),c=new Jt({mapValue:{fields:r.document.fields}}),u=Ut.newFoundDocument(s,a,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];n=new ll(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=_u(t,r.document),a=r.readTime?Bn(r.readTime):pe.min(),o=Ut.newNoDocument(s,a),c=r.removedTargetIds||[];n=new ll([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=_u(t,r.document),a=r.removedTargetIds||[];n=new ll([],a,s,null)}else{if(!("filter"in e))return me();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,o=new ij(s,a),c=r.targetId;n=new Dv(c,o)}}return n}function xj(t,e){let n;if(e instanceof so)n={update:cg(t,e.key,e.value)};else if(e instanceof Kh)n={delete:Dd(t,e.key)};else if(e instanceof Hr)n={update:cg(t,e.key,e.data),updateMask:Sj(e.fieldMask)};else{if(!(e instanceof nj))return me();n={verify:Dd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(a,o){const c=o.transform;if(c instanceof qa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ha)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Qa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof $l)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:fj(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me()}(t,e.precondition)),n}function yj(t,e){return t&&t.length>0?(Ae(e!==void 0),t.map(n=>function(s,a){let o=s.updateTime?Bn(s.updateTime):Bn(a);return o.isEqual(pe.min())&&(o=Bn(a)),new ZN(o,s.transformResults||[])}(n,e))):[]}function vj(t,e){return{documents:[Fv(t,e.path)]}}function wj(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Fv(t,s);const a=function(h){if(h.length!==0)return $v(Dn.create(h,"and"))}(e.filters);a&&(n.structuredQuery.where=a);const o=function(h){if(h.length!==0)return h.map(f=>function(p){return{field:Rs(p.field),direction:Nj(p.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=Pd(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function _j(t){let e=pj(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ae(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let a=[];n.where&&(a=function(g){const p=Uv(g);return p instanceof Dn&&gv(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(p=>function(k){return new za(Ds(k.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(g){let p;return p=typeof g=="object"?g.value:g,hc(p)?null:p}(n.limit));let u=null;n.startAt&&(u=function(g){const p=!!g.before,N=g.values||[];return new Ll(N,p)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const p=!g.before,N=g.values||[];return new Ll(N,p)}(n.endAt)),LN(e,s,o,a,c,"F",u,h)}function bj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Uv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ds(n.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ds(n.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ds(n.unaryFilter.field);return ot.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ds(n.unaryFilter.field);return ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(n){return ot.create(Ds(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Dn.create(n.compositeFilter.filters.map(r=>Uv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me()}}(n.compositeFilter.op))}(t):me()}function Nj(t){return uj[t]}function jj(t){return dj[t]}function Ej(t){return hj[t]}function Rs(t){return{fieldPath:t.canonicalString()}}function Ds(t){return Et.fromServerFormat(t.fieldPath)}function $v(t){return t instanceof ot?function(n){if(n.op==="=="){if(Gp(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NAN"}};if(Kp(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Gp(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NOT_NAN"}};if(Kp(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rs(n.field),op:jj(n.op),value:n.value}}}(t):t instanceof Dn?function(n){const r=n.getFilters().map(s=>$v(s));return r.length===1?r[0]:{compositeFilter:{op:Ej(n.op),filters:r}}}(t):me()}function Sj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Bv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n,r,s,a=pe.min(),o=pe.min(),c=kt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Nr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.ct=e}}function Ij(t){const e=_j({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ul(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.un=new Aj}addToCollectionParentIndex(e,n){return this.un.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(Mr.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class Aj{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Tt(Fe.comparator),a=!s.has(r);return this.index[n]=s.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Tt(Fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new mi(0)}static kn(){return new mi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.changes=new Ei(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&va(r.mutation,s,un.empty(),lt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,n,r=we()){const s=rs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(a=>{let o=na();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=rs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,we()))}populateOverlays(e,n,r){const s=[];return r.forEach(a=>{n.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let a=lr();const o=ya(),c=function(){return ya()}();return n.forEach((u,h)=>{const f=r.get(h.key);s.has(h.key)&&(f===void 0||f.mutation instanceof Hr)?a=a.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),va(f.mutation,h,f.mutation.getFieldMask(),lt.now())):o.set(h.key,un.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,f)=>o.set(h,f)),n.forEach((h,f)=>{var g;return c.set(h,new Pj(f,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=ya();let s=new We((o,c)=>o-c),a=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let f=r.get(u)||un.empty();f=c.applyToLocalView(h,f),r.set(u,f);const g=(s.get(c.batchId)||we()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,g=Ev();f.forEach(p=>{if(!a.has(p)){const N=Cv(n.get(p),r.get(p));N!==null&&g.set(p,N),a=a.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return oe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-a.size):z.resolve(rs());let c=-1,u=a;return o.next(h=>z.forEach(h,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{u=u.insert(f,p)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,we())).next(f=>({batchId:c,changes:jv(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let s=na();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const a=n.collectionGroup;let o=na();return this.indexManager.getCollectionParents(e,a).next(c=>z.forEach(c,u=>{const h=function(g,p){return new ji(p,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(f=>{f.forEach((g,p)=>{o=o.insert(g,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,s))).next(o=>{a.forEach((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Ut.newInvalidDocument(f)))});let c=na();return o.forEach((u,h)=>{const f=a.get(u);f!==void 0&&va(f.mutation,h,un.empty(),lt.now()),pc(n,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return z.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Bn(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:Ij(s.bundledQuery),readTime:Bn(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(){this.overlays=new We(oe.comparator),this.Ir=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=rs();return z.forEach(n,s=>this.getOverlay(e,s).next(a=>{a!==null&&r.set(s,a)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,a)=>{this.ht(e,n,a)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=rs(),a=n.length+1,o=new oe(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let a=new We((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let f=a.get(h.largestBatchId);f===null&&(f=rs(),a=a.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=rs(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=s)););return z.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sj(n,r));let a=this.Ir.get(n);a===void 0&&(a=we(),this.Ir.set(n,a)),this.Ir.set(n,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(){this.Tr=new Tt(pt.Er),this.dr=new Tt(pt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new pt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new pt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new oe(new Fe([])),r=new pt(n,e),s=new pt(n,e+1),a=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new oe(new Fe([])),r=new pt(n,e),s=new pt(n,e+1);let a=we();return this.dr.forEachInRange([r,s],o=>{a=a.add(o.key)}),a}containsKey(e){const n=new pt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class pt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return oe.comparator(e.key,n.key)||Te(e.wr,n.wr)}static Ar(e,n){return Te(e.wr,n.wr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Tt(pt.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rj(a,n,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new pt(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),a=s<0?0:s;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new pt(n,0),s=new pt(n,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);a.push(c)}),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Tt(Te);return n.forEach(s=>{const a=new pt(s,0),o=new pt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],c=>{r=r.add(c.wr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let a=r;oe.isDocumentKey(a)||(a=a.child(""));const o=new pt(new oe(a),0);let c=new Tt(Te);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.wr)),!0)},o),z.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ae(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return z.forEach(n.mutations,s=>{const a=new pt(s.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new pt(n,0),s=this.br.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e){this.Mr=e,this.docs=function(){return new We(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),a=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Ut.newInvalidDocument(n))}getEntries(e,n){let r=lr();return n.forEach(s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():Ut.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let a=lr();const o=n.path,c=new oe(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||wN(vN(f),r)<=0||(s.has(f.key)||pc(n,f))&&(a=a.insert(f.key,f.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,n,r,s){me()}Or(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Lj(this)}getSize(e){return z.resolve(this.size)}}class Lj extends Cj{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e){this.persistence=e,this.Nr=new Ei(n=>Hh(n),Qh),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Jh,this.targetCount=0,this.kr=mi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),z.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new mi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Kn(n),z.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const a=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(a).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,a=[];return s&&n.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,n){this.qr={},this.overlays={},this.Qr=new $h(0),this.Kr=!1,this.Kr=!0,this.$r=new Oj,this.referenceDelegate=e(this),this.Ur=new Uj(this),this.indexManager=new kj,this.remoteDocumentCache=function(s){return new Fj(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Tj(n),this.Gr=new Dj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Vj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Mj(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){se("MemoryPersistence","Starting transaction:",e);const s=new Bj(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,n){return z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class Bj extends bN{constructor(e){super(),this.currentSequenceNumber=e}}class Zh{constructor(e){this.persistence=e,this.Jr=new Jh,this.Yr=null}static Zr(e){return new Zh(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),z.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,r=>{const s=oe.fromPath(r);return this.ei(e,s).next(a=>{a||n.removeEntry(s,pe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return z.or([()=>z.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=we(),s=we();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new em(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return H1()?8:NN(z1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const a={result:null};return this.Yi(e,n).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,n,s,r).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new zj;return this.Xi(e,n,o).next(c=>{if(a.result=c,this.zi)return this.es(e,n,o,c.size)})}).next(()=>a.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Yi()<=je.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Ps(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(Yi()<=je.DEBUG&&se("QueryEngine","Query:",Ps(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Yi()<=je.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Ps(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$n(n))):z.resolve())}Yi(e,n){if(Zp(n))return z.resolve(null);let r=$n(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ul(n,null,"F"),r=$n(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const o=we(...a);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,c);return this.ns(n,h,o,u.readTime)?this.Yi(e,Ul(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return Zp(n)||s.isEqual(pe.min())?z.resolve(null):this.Ji.getDocuments(e,r).next(a=>{const o=this.ts(n,a);return this.ns(n,o,r,s)?z.resolve(null):(Yi()<=je.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ps(n)),this.rs(e,o,n,yN(s,-1)).next(c=>c))})}ts(e,n){let r=new Tt(bv(e));return n.forEach((s,a)=>{pc(e,a)&&(r=r.add(a))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,n,r){return Yi()<=je.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Ps(n)),this.Ji.getDocumentsMatchingQuery(e,n,Mr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(a=>(n.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new We(Te),this._s=new Ei(a=>Hh(a),Qh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rj(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Qj(t,e,n,r){return new Hj(t,e,n,r)}async function zv(t,e){const n=ge(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(a=>(s=a,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(a=>{const o=[],c=[];let u=we();for(const h of s){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of a){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:c}))})})}function Wj(t,e){const n=ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),a=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const g=h.batch,p=g.keys();let N=z.resolve();return p.forEach(k=>{N=N.next(()=>f.getEntry(u,k)).next(T=>{const D=h.docVersions.get(k);Ae(D!==null),T.version.compareTo(D)<0&&(g.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),f.addEntry(T)))})}),N.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,a).next(()=>a.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=we();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function qv(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Kj(t,e){const n=ge(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((f,g)=>{const p=s.get(g);if(!p)return;c.push(n.Ur.removeMatchingKeys(a,f.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(a,f.addedDocuments,g)));let N=p.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?N=N.withResumeToken(kt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):f.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(f.resumeToken,r)),s=s.insert(g,N),function(T,D,S){return T.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,N,f)&&c.push(n.Ur.updateTargetData(a,N))});let u=lr(),h=we();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(a,f))}),c.push(Gj(a,o,e.documentUpdates).next(f=>{u=f.Ps,h=f.Is})),!r.isEqual(pe.min())){const f=n.Ur.getLastRemoteSnapshotVersion(a).next(g=>n.Ur.setTargetsMetadata(a,a.currentSequenceNumber,r));c.push(f)}return z.waitFor(c).next(()=>o.apply(a)).next(()=>n.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(n.os=s,a))}function Gj(t,e,n){let r=we(),s=we();return n.forEach(a=>r=r.add(a)),e.getEntries(t,r).next(a=>{let o=lr();return n.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(pe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):se("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function Yj(t,e){const n=ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Xj(t,e){const n=ge(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(a=>a?(s=a,z.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Nr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Od(t,e,n){const r=ge(t),s=r.os.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ro(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function ug(t,e,n){const r=ge(t);let s=pe.min(),a=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,f){const g=ge(u),p=g._s.get(f);return p!==void 0?z.resolve(g.os.get(p)):g.Ur.getTargetData(h,f)}(r,o,$n(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:pe.min(),n?a:we())).next(c=>(Jj(r,$N(e),c),{documents:c,Ts:a})))}function Jj(t,e,n){let r=t.us.get(e)||pe.min();n.forEach((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),t.us.set(e,r)}class dg{constructor(){this.activeTargetIds=WN()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zj{constructor(){this.so=new dg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new dg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ho=null;function bu(){return Ho===null?Ho=function(){return 268435456+Math.round(2147483648*Math.random())}():Ho++,"0x"+Ho.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ot="WebChannelConnection";class rE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(n,r,s,a,o){const c=bu(),u=this.xo(n,r.toUriEncodedString());se("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,a,o),this.No(n,u,h,s).then(f=>(se("RestConnection",`Received RPC '${n}' ${c}: `,f),f),f=>{throw ci("RestConnection",`RPC '${n}' ${c} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,a,o,c){return this.Mo(n,r,s,a,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ni}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>n[o]=a),s&&s.headers.forEach((a,o)=>n[o]=a)}xo(n,r){const s=tE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const a=bu();return new Promise((o,c)=>{const u=new sv;u.setWithCredentials(!0),u.listenOnce(iv.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case il.NO_ERROR:const f=u.getResponseJson();se(Ot,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case il.TIMEOUT:se(Ot,`RPC '${e}' ${a} timed out`),c(new te($.DEADLINE_EXCEEDED,"Request time out"));break;case il.HTTP_ERROR:const g=u.getStatus();if(se(Ot,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const N=p==null?void 0:p.error;if(N&&N.status&&N.message){const k=function(D){const S=D.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(S)>=0?S:$.UNKNOWN}(N.status);c(new te(k,N.message))}else c(new te($.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new te($.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{se(Ot,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(s);se(Ot,`RPC '${e}' ${a} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=bu(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lv(),c=ov(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=a.join("");se(Ot,`Creating RPC '${e}' stream ${s}: ${f}`,u);const g=o.createWebChannel(f,u);let p=!1,N=!1;const k=new nE({Io:D=>{N?se(Ot,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(p||(se(Ot,`Opening RPC '${e}' stream ${s} transport.`),g.open(),p=!0),se(Ot,`RPC '${e}' stream ${s} sending:`,D),g.send(D))},To:()=>g.close()}),T=(D,S,b)=>{D.listen(S,I=>{try{b(I)}catch(C){setTimeout(()=>{throw C},0)}})};return T(g,ta.EventType.OPEN,()=>{N||(se(Ot,`RPC '${e}' stream ${s} transport opened.`),k.yo())}),T(g,ta.EventType.CLOSE,()=>{N||(N=!0,se(Ot,`RPC '${e}' stream ${s} transport closed`),k.So())}),T(g,ta.EventType.ERROR,D=>{N||(N=!0,ci(Ot,`RPC '${e}' stream ${s} transport errored:`,D),k.So(new te($.UNAVAILABLE,"The operation could not be completed")))}),T(g,ta.EventType.MESSAGE,D=>{var S;if(!N){const b=D.data[0];Ae(!!b);const I=b,C=I.error||((S=I[0])===null||S===void 0?void 0:S.error);if(C){se(Ot,`RPC '${e}' stream ${s} received error:`,C);const L=C.status;let R=function(_){const j=it[_];if(j!==void 0)return Rv(j)}(L),w=C.message;R===void 0&&(R=$.INTERNAL,w="Unknown error status: "+L+" with message "+C.message),N=!0,k.So(new te(R,w)),g.close()}else se(Ot,`RPC '${e}' stream ${s} received:`,b),k.bo(b)}}),T(c,av.STAT_EVENT,D=>{D.stat===Sd.PROXY?se(Ot,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===Sd.NOPROXY&&se(Ot,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}}function Nu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){return new mj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,n,r,s,a,o,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Hv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(or(n.toString()),or("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sE extends Qv{constructor(e,n,r,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=a}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=gj(this.serializer,e),r=function(a){if(!("targetChange"in a))return pe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?Bn(o.readTime):pe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Vd(this.serializer),n.addTarget=function(a,o){let c;const u=o.target;if(c=Ad(u)?{documents:vj(a,u)}:{query:wj(a,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Ov(a,o.resumeToken);const h=Pd(a,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(pe.min())>0){c.readTime=Bl(a,o.snapshotVersion.toTimestamp());const h=Pd(a,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const r=bj(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Vd(this.serializer),n.removeTarget=e,this.a_(n)}}class iE extends Qv{constructor(e,n,r,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ae(!!e.streamToken),this.lastStreamToken=e.streamToken,Ae(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=yj(e.writeResults,e.commitTime),r=Bn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Vd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>xj(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te($.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,Rd(n,r),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te($.UNKNOWN,a.toString())})}Lo(e,n,r,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,Rd(n,r),s,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te($.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class oE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(or(n),this.D_=!1):se("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e,n,r,s,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{r.enqueueAndForget(async()=>{bs(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ge(u);h.L_.add(4),await ao(h),h.q_.set("Unknown"),h.L_.delete(4),await wc(h)}(this))})}),this.q_=new oE(r,s)}}async function wc(t){if(bs(t))for(const e of t.B_)await e(!0)}async function ao(t){for(const e of t.B_)await e(!1)}function Wv(t,e){const n=ge(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),sm(n)?rm(n):Si(n).r_()&&nm(n,e))}function tm(t,e){const n=ge(t),r=Si(n);n.N_.delete(e),r.r_()&&Kv(n,e),n.N_.size===0&&(r.r_()?r.o_():bs(n)&&n.q_.set("Unknown"))}function nm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Si(t).A_(e)}function Kv(t,e){t.Q_.xe(e),Si(t).R_(e)}function rm(t){t.Q_=new cj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Si(t).start(),t.q_.v_()}function sm(t){return bs(t)&&!Si(t).n_()&&t.N_.size>0}function bs(t){return ge(t).L_.size===0}function Gv(t){t.Q_=void 0}async function cE(t){t.q_.set("Online")}async function uE(t){t.N_.forEach((e,n)=>{nm(t,e)})}async function dE(t,e){Gv(t),sm(t)?(t.q_.M_(e),rm(t)):t.q_.set("Unknown")}async function hE(t,e,n){if(t.q_.set("Online"),e instanceof Vv&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const c of a.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zl(t,r)}else if(e instanceof ll?t.Q_.Ke(e):e instanceof Dv?t.Q_.He(e):t.Q_.We(e),!n.isEqual(pe.min()))try{const r=await qv(t.localStore);n.compareTo(r)>=0&&await function(a,o){const c=a.Q_.rt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=a.N_.get(h);f&&a.N_.set(h,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const f=a.N_.get(u);if(!f)return;a.N_.set(u,f.withResumeToken(kt.EMPTY_BYTE_STRING,f.snapshotVersion)),Kv(a,u);const g=new Nr(f.target,u,h,f.sequenceNumber);nm(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await zl(t,r)}}async function zl(t,e,n){if(!ro(e))throw e;t.L_.add(1),await ao(t),t.q_.set("Offline"),n||(n=()=>qv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await wc(t)})}function Yv(t,e){return e().catch(n=>zl(t,n,e))}async function _c(t){const e=ge(t),n=Lr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;mE(e);)try{const s=await Yj(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,fE(e,s)}catch(s){await zl(e,s)}Xv(e)&&Jv(e)}function mE(t){return bs(t)&&t.O_.length<10}function fE(t,e){t.O_.push(e);const n=Lr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Xv(t){return bs(t)&&!Lr(t).n_()&&t.O_.length>0}function Jv(t){Lr(t).start()}async function pE(t){Lr(t).p_()}async function gE(t){const e=Lr(t);for(const n of t.O_)e.m_(n.mutations)}async function xE(t,e,n){const r=t.O_.shift(),s=Gh.from(r,e,n);await Yv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await _c(t)}async function yE(t,e){e&&Lr(t).V_&&await async function(r,s){if(function(o){return aj(o)&&o!==$.ABORTED}(s.code)){const a=r.O_.shift();Lr(r).s_(),await Yv(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s)),await _c(r)}}(t,e),Xv(t)&&Jv(t)}async function mg(t,e){const n=ge(t);n.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=bs(n);n.L_.add(3),await ao(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await wc(n)}async function vE(t,e){const n=ge(t);e?(n.L_.delete(2),await wc(n)):e||(n.L_.add(2),await ao(n),n.q_.set("Unknown"))}function Si(t){return t.K_||(t.K_=function(n,r,s){const a=ge(n);return a.w_(),new sE(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:cE.bind(null,t),Ro:uE.bind(null,t),mo:dE.bind(null,t),d_:hE.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),sm(t)?rm(t):t.q_.set("Unknown")):(await t.K_.stop(),Gv(t))})),t.K_}function Lr(t){return t.U_||(t.U_=function(n,r,s){const a=ge(n);return a.w_(),new iE(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:pE.bind(null,t),mo:yE.bind(null,t),f_:gE.bind(null,t),g_:xE.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await _c(t)):(await t.U_.stop(),t.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,n,r,s,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,a){const o=Date.now()+r,c=new im(e,n,o,s,a);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function am(t,e){if(or("AsyncQueue",`${e}: ${t}`),ro(t))return new te($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=na(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new ti(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ti)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ti;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(){this.W_=new We(oe.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class fi{constructor(e,n,r,s,a,o,c,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,a){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new fi(e,n,ti.emptySet(n),o,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _E{constructor(){this.queries=pg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ge(n),a=s.queries;s.queries=pg(),a.forEach((o,c)=>{for(const u of c.j_)u.onError(r)})})(this,new te($.ABORTED,"Firestore shutting down"))}}function pg(){return new Ei(t=>_v(t),fc)}async function om(t,e){const n=ge(t);let r=3;const s=e.query;let a=n.queries.get(s);a?!a.H_()&&e.J_()&&(r=2):(a=new wE,r=e.J_()?0:1);try{switch(r){case 0:a.z_=await n.onListen(s,!0);break;case 1:a.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=am(o,`Initialization of query '${Ps(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,a),a.j_.push(e),e.Z_(n.onlineState),a.z_&&e.X_(a.z_)&&cm(n)}async function lm(t,e){const n=ge(t),r=e.query;let s=3;const a=n.queries.get(r);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function bE(t,e){const n=ge(t);let r=!1;for(const s of e){const a=s.query,o=n.queries.get(a);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&cm(n)}function NE(t,e,n){const r=ge(t),s=r.queries.get(e);if(s)for(const a of s.j_)a.onError(n);r.queries.delete(e)}function cm(t){t.Y_.forEach(e=>{e.next()})}var Md,gg;(gg=Md||(Md={})).ea="default",gg.Cache="cache";class um{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new fi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=fi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Md.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e){this.key=e}}class e0{constructor(e){this.key=e}}class jE{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=bv(e),this.Ra=new ti(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new fg,s=n?n.Ra:this.Ra;let a=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,g)=>{const p=s.get(f),N=pc(this.query,g)?g:null,k=!!p&&this.mutatedKeys.has(p.key),T=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let D=!1;p&&N?p.data.isEqual(N.data)?k!==T&&(r.track({type:3,doc:N}),D=!0):this.ga(p,N)||(r.track({type:2,doc:N}),D=!0,(u&&this.Aa(N,u)>0||h&&this.Aa(N,h)<0)&&(c=!0)):!p&&N?(r.track({type:0,doc:N}),D=!0):p&&!N&&(r.track({type:1,doc:p}),D=!0,(u||h)&&(c=!0)),D&&(N?(o=o.add(N),a=T?a.add(f):a.delete(f)):(o=o.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),a=a.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:c,mutatedKeys:a}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,g)=>function(N,k){const T=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return T(N)-T(k)}(f.type,g.type)||this.Aa(f.doc,g.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new fi(this.query,e.Ra,a,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new fg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new e0(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Zv(r))}),n}ba(e){this.Ta=e.Ts,this.da=we();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return fi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class EE{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class SE{constructor(e){this.key=e,this.va=!1}}class TE{constructor(e,n,r,s,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ei(c=>_v(c),fc),this.Ma=new Map,this.xa=new Set,this.Oa=new We(oe.comparator),this.Na=new Map,this.La=new Jh,this.Ba={},this.ka=new Map,this.qa=mi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function IE(t,e,n=!0){const r=a0(t);let s;const a=r.Fa.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await t0(r,e,n,!0),s}async function kE(t,e){const n=a0(t);await t0(n,e,!0,!1)}async function t0(t,e,n,r){const s=await Xj(t.localStore,$n(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let c;return r&&(c=await AE(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Wv(t.remoteStore,s),c}async function AE(t,e,n,r,s){t.Ka=(g,p,N)=>async function(T,D,S,b){let I=D.view.ma(S);I.ns&&(I=await ug(T.localStore,D.query,!1).then(({documents:w})=>D.view.ma(w,I)));const C=b&&b.targetChanges.get(D.targetId),L=b&&b.targetMismatches.get(D.targetId)!=null,R=D.view.applyChanges(I,T.isPrimaryClient,C,L);return yg(T,D.targetId,R.wa),R.snapshot}(t,g,p,N);const a=await ug(t.localStore,e,!0),o=new jE(e,a.Ts),c=o.ma(a.documents),u=io.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);yg(t,n,h.wa);const f=new EE(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function CE(t,e,n){const r=ge(t),s=r.Fa.get(e),a=r.Ma.get(s.targetId);if(a.length>1)return r.Ma.set(s.targetId,a.filter(o=>!fc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Od(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&tm(r.remoteStore,s.targetId),Fd(r,s.targetId)}).catch(no)):(Fd(r,s.targetId),await Od(r.localStore,s.targetId,!0))}async function PE(t,e){const n=ge(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),tm(n.remoteStore,r.targetId))}async function RE(t,e,n){const r=UE(t);try{const s=await function(o,c){const u=ge(o),h=lt.now(),f=c.reduce((N,k)=>N.add(k.key),we());let g,p;return u.persistence.runTransaction("Locally write mutations","readwrite",N=>{let k=lr(),T=we();return u.cs.getEntries(N,f).next(D=>{k=D,k.forEach((S,b)=>{b.isValidDocument()||(T=T.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(N,k)).next(D=>{g=D;const S=[];for(const b of c){const I=tj(b,g.get(b.key).overlayedDocument);I!=null&&S.push(new Hr(b.key,I,mv(I.value.mapValue),Pn.exists(!0)))}return u.mutationQueue.addMutationBatch(N,h,S,c)}).next(D=>{p=D;const S=D.applyToLocalDocumentSet(g,T);return u.documentOverlayCache.saveOverlays(N,D.batchId,S)})}).then(()=>({batchId:p.batchId,changes:jv(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new We(Te)),h=h.insert(c,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await oo(r,s.changes),await _c(r.remoteStore)}catch(s){const a=am(s,"Failed to persist write");n.reject(a)}}async function n0(t,e){const n=ge(t);try{const r=await Kj(n.localStore,e);e.targetChanges.forEach((s,a)=>{const o=n.Na.get(a);o&&(Ae(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ae(o.va):s.removedDocuments.size>0&&(Ae(o.va),o.va=!1))}),await oo(n,r,e)}catch(r){await no(r)}}function xg(t,e,n){const r=ge(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((a,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=ge(o);u.onlineState=c;let h=!1;u.queries.forEach((f,g)=>{for(const p of g.j_)p.Z_(c)&&(h=!0)}),h&&cm(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DE(t,e,n){const r=ge(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),a=s&&s.key;if(a){let o=new We(oe.comparator);o=o.insert(a,Ut.newNoDocument(a,pe.min()));const c=we().add(a),u=new yc(pe.min(),new Map,new We(Te),o,c);await n0(r,u),r.Oa=r.Oa.remove(a),r.Na.delete(e),dm(r)}else await Od(r.localStore,e,!1).then(()=>Fd(r,e,n)).catch(no)}async function VE(t,e){const n=ge(t),r=e.batch.batchId;try{const s=await Wj(n.localStore,e);s0(n,r,null),r0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oo(n,s)}catch(s){await no(s)}}async function OE(t,e,n){const r=ge(t);try{const s=await function(o,c){const u=ge(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(Ae(g!==null),f=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(r.localStore,e);s0(r,e,n),r0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await oo(r,s)}catch(s){await no(s)}}function r0(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function s0(t,e,n){const r=ge(t);let s=r.Ba[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(n?a.reject(n):a.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Fd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||i0(t,r)})}function i0(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(tm(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),dm(t))}function yg(t,e,n){for(const r of n)r instanceof Zv?(t.La.addReference(r.key,e),ME(t,r)):r instanceof e0?(se("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||i0(t,r.key)):me()}function ME(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(se("SyncEngine","New document in limbo: "+n),t.xa.add(r),dm(t))}function dm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new oe(Fe.fromString(e)),r=t.qa.next();t.Na.set(r,new SE(n)),t.Oa=t.Oa.insert(n,r),Wv(t.remoteStore,new Nr($n(mc(n.path)),r,"TargetPurposeLimboResolution",$h.oe))}}async function oo(t,e,n){const r=ge(t),s=[],a=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{o.push(r.Ka(u,e,n).then(h=>{var f;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=em.Wi(u.targetId,h);a.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const f=ge(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>z.forEach(h,p=>z.forEach(p.$i,N=>f.persistence.referenceDelegate.addReference(g,p.targetId,N)).next(()=>z.forEach(p.Ui,N=>f.persistence.referenceDelegate.removeReference(g,p.targetId,N)))))}catch(g){if(!ro(g))throw g;se("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const p=g.targetId;if(!g.fromCache){const N=f.os.get(p),k=N.snapshotVersion,T=N.withLastLimboFreeSnapshotVersion(k);f.os=f.os.insert(p,T)}}}(r.localStore,a))}async function FE(t,e){const n=ge(t);if(!n.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await zv(n.localStore,e);n.currentUser=e,function(a,o){a.ka.forEach(c=>{c.forEach(u=>{u.reject(new te($.CANCELLED,o))})}),a.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await oo(n,r.hs)}}function LE(t,e){const n=ge(t),r=n.Na.get(e);if(r&&r.va)return we().add(r.key);{let s=we();const a=n.Ma.get(e);if(!a)return s;for(const o of a){const c=n.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function a0(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=n0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DE.bind(null,e),e.Ca.d_=bE.bind(null,e.eventManager),e.Ca.$a=NE.bind(null,e.eventManager),e}function UE(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OE.bind(null,e),e}class ql{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Qj(this.persistence,new qj,e.initialUser,this.serializer)}Ga(e){return new $j(Zh.Zr,this.serializer)}Wa(e){return new Zj}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ql.provider={build:()=>new ql};class Ld{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>xg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=FE.bind(null,this.syncEngine),await vE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _E}()}createDatastore(e){const n=vc(e.databaseInfo.databaseId),r=function(a){return new rE(a)}(e.databaseInfo);return function(a,o,c,u){return new aE(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,a,o,c){return new lE(r,s,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>xg(this.syncEngine,n,0),function(){return hg.D()?new hg:new eE}())}createSyncEngine(e,n){return function(s,a,o,c,u,h,f){const g=new TE(s,a,o,c,u,h);return f&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const a=ge(s);se("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await ao(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Ld.provider={build:()=>new Ld};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):or("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n,r,s,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ft.UNAUTHENTICATED,this.clientId=uv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async o=>{se("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(se("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=am(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ju(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await zv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function vg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await BE(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>mg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>mg(e.remoteStore,s)),t._onlineComponents=e}async function BE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await ju(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ci("Error using user provided cache. Falling back to memory cache: "+n),await ju(t,new ql)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await ju(t,new ql);return t._offlineComponents}async function o0(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await vg(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await vg(t,new Ld))),t._onlineComponents}function zE(t){return o0(t).then(e=>e.syncEngine)}async function Hl(t){const e=await o0(t),n=e.eventManager;return n.onListen=IE.bind(null,e.syncEngine),n.onUnlisten=CE.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=kE.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=PE.bind(null,e.syncEngine),n}function qE(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const f=new hm({next:p=>{f.Za(),o.enqueueAndForget(()=>lm(a,g));const N=p.docs.has(c);!N&&p.fromCache?h.reject(new te($.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&p.fromCache&&u&&u.source==="server"?h.reject(new te($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(p)},error:p=>h.reject(p)}),g=new um(mc(c.path),f,{includeMetadataChanges:!0,_a:!0});return om(a,g)}(await Hl(t),t.asyncQueue,e,n,r)),r.promise}function HE(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const f=new hm({next:p=>{f.Za(),o.enqueueAndForget(()=>lm(a,g)),p.fromCache&&u.source==="server"?h.reject(new te($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(p)},error:p=>h.reject(p)}),g=new um(c,f,{includeMetadataChanges:!0,_a:!0});return om(a,g)}(await Hl(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t,e,n){if(!n)throw new te($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function QE(t,e,n,r){if(e===!0&&r===!0)throw new te($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function _g(t){if(!oe.isDocumentKey(t))throw new te($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function bg(t){if(oe.isDocumentKey(t))throw new te($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function wn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bc(t);throw new te($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new te($.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new te($.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new te($.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ng({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ng(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new cN;switch(r.type){case"firstParty":return new mN(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=wg.get(n);r&&(se("ComponentProvider","Removing Datastore"),wg.delete(n),r.terminate())}(this),Promise.resolve()}}function WE(t,e,n,r={}){var s;const a=(t=wn(t,Nc))._getSettings(),o=`${e}:${n}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Ft.MOCK_USER;else{c=B1(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new te($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ft(h)}t._authCredentials=new uN(new cv(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ur(this.firestore,e,this._query)}}class Wt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wt(this.firestore,e,this._key)}}class Dr extends ur{constructor(e,n,r){super(e,n,mc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wt(this.firestore,null,new oe(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function Ie(t,e,...n){if(t=zn(t),c0("collection","path",e),t instanceof Nc){const r=Fe.fromString(e,...n);return bg(r),new Dr(t,null,r)}{if(!(t instanceof Wt||t instanceof Dr))throw new te($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Fe.fromString(e,...n));return bg(r),new Dr(t.firestore,null,r)}}function Ht(t,e,...n){if(t=zn(t),arguments.length===1&&(e=uv.newId()),c0("doc","path",e),t instanceof Nc){const r=Fe.fromString(e,...n);return _g(r),new Wt(t,null,new oe(r))}{if(!(t instanceof Wt||t instanceof Dr))throw new te($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Fe.fromString(e,...n));return _g(r),new Wt(t.firestore,t instanceof Dr?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Hv(this,"async_queue_retry"),this.Vu=()=>{const r=Nu();r&&se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Nu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Nu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new er;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ro(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw or("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=im.createAndSchedule(this,e,n,r,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Eg(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class Ur extends Nc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new jg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new jg(e),this._firestoreClient=void 0,await e}}}function KE(t,e){const n=typeof t=="object"?t:Xb(),r=typeof t=="string"?t:"(default)",s=Wb(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=U1("firestore");a&&WE(s,...a)}return s}function jc(t){if(t._terminated)throw new te($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GE(t),t._firestoreClient}function GE(t){var e,n,r;const s=t._freezeSettings(),a=function(c,u,h,f){return new SN(c,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,l0(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new $E(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pi(kt.fromBase64String(e))}catch(n){throw new te($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new pi(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=/^__.*__$/;class XE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hr(e,this.data,this.fieldMask,n,this.fieldTransforms):new so(e,this.data,n,this.fieldTransforms)}}class u0{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Hr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function d0(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class pm{constructor(e,n,r,s,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new pm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ql(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(d0(this.Cu)&&YE.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class JE{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||vc(e)}Qu(e,n,r,s=!1){return new pm({Cu:e,methodName:n,qu:r,path:Et.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gm(t){const e=t._freezeSettings(),n=vc(t._databaseId);return new JE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ZE(t,e,n,r,s,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,n,s);ym("Data must be an object, but it was:",o,r);const c=h0(r,o);let u,h;if(a.merge)u=new un(o.fieldMask),h=o.fieldTransforms;else if(a.mergeFields){const f=[];for(const g of a.mergeFields){const p=Ud(e,g,n);if(!o.contains(p))throw new te($.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);f0(f,p)||f.push(p)}u=new un(f),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new XE(new Jt(c),u,h)}class Tc extends Sc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tc}}class xm extends Sc{_toFieldTransform(e){return new XN(e.path,new qa)}isEqual(e){return e instanceof xm}}function e2(t,e,n,r){const s=t.Qu(1,e,n);ym("Data must be an object, but it was:",s,r);const a=[],o=Jt.empty();_s(r,(u,h)=>{const f=vm(e,u,n);h=zn(h);const g=s.Nu(f);if(h instanceof Tc)a.push(f);else{const p=lo(h,g);p!=null&&(a.push(f),o.set(f,p))}});const c=new un(a);return new u0(o,c,s.fieldTransforms)}function t2(t,e,n,r,s,a){const o=t.Qu(1,e,n),c=[Ud(e,r,n)],u=[s];if(a.length%2!=0)throw new te($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<a.length;p+=2)c.push(Ud(e,a[p])),u.push(a[p+1]);const h=[],f=Jt.empty();for(let p=c.length-1;p>=0;--p)if(!f0(h,c[p])){const N=c[p];let k=u[p];k=zn(k);const T=o.Nu(N);if(k instanceof Tc)h.push(N);else{const D=lo(k,T);D!=null&&(h.push(N),f.set(N,D))}}const g=new un(h);return new u0(f,g,o.fieldTransforms)}function n2(t,e,n,r=!1){return lo(n,t.Qu(r?4:3,e))}function lo(t,e){if(m0(t=zn(t)))return ym("Unsupported field value:",e,t),h0(t,e);if(t instanceof Sc)return function(r,s){if(!d0(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const a=[];let o=0;for(const c of r){let u=lo(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(r,s){if((r=zn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return KN(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=lt.fromDate(r);return{timestampValue:Bl(s.serializer,a)}}if(r instanceof lt){const a=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Bl(s.serializer,a)}}if(r instanceof mm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pi)return{bytesValue:Ov(s.serializer,r._byteString)};if(r instanceof Wt){const a=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Xh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof fm)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return Wh(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${bc(r)}`)}(t,e)}function h0(t,e){const n={};return dv(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_s(t,(r,s)=>{const a=lo(s,e.Mu(r));a!=null&&(n[r]=a)}),{mapValue:{fields:n}}}function m0(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lt||t instanceof mm||t instanceof pi||t instanceof Wt||t instanceof Sc||t instanceof fm)}function ym(t,e,n){if(!m0(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=bc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Ud(t,e,n){if((e=zn(e))instanceof Ec)return e._internalPath;if(typeof e=="string")return vm(t,e);throw Ql("Field path arguments must be of type string or ",t,!1,void 0,n)}const r2=new RegExp("[~\\*/\\[\\]]");function vm(t,e,n){if(e.search(r2)>=0)throw Ql(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ec(...e.split("."))._internalPath}catch{throw Ql(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ql(t,e,n,r,s){const a=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new te($.INVALID_ARGUMENT,c+t+u)}function f0(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n,r,s,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new s2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ic("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class s2 extends p0{data(){return super.data()}}function Ic(t,e){return typeof e=="string"?vm(t,e):e instanceof Ec?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wm{}class _m extends wm{}function Re(t,e,...n){let r=[];e instanceof wm&&r.push(e),r=r.concat(n),function(a){const o=a.filter(u=>u instanceof bm).length,c=a.filter(u=>u instanceof kc).length;if(o>1||o>0&&c>0)throw new te($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class kc extends _m{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new kc(e,n,r)}_apply(e){const n=this._parse(e);return x0(e._query,n),new ur(e.firestore,e.converter,Cd(e._query,n))}_parse(e){const n=gm(e.firestore);return function(a,o,c,u,h,f,g){let p;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new te($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ig(g,f);const N=[];for(const k of g)N.push(Tg(u,a,k));p={arrayValue:{values:N}}}else p=Tg(u,a,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ig(g,f),p=n2(c,o,g,f==="in"||f==="not-in");return ot.create(h,f,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function be(t,e,n){const r=e,s=Ic("where",t);return kc._create(s,r,n)}class bm extends wm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new bm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Dn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,a){let o=s;const c=a.getFlattenedFilters();for(const u of c)x0(o,u),o=Cd(o,u)}(e._query,n),new ur(e.firestore,e.converter,Cd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nm extends _m{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Nm(e,n)}_apply(e){const n=function(s,a,o){if(s.startAt!==null)throw new te($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new te($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new za(a,o)}(e._query,this._field,this._direction);return new ur(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new ji(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function en(t,e="asc"){const n=e,r=Ic("orderBy",t);return Nm._create(r,n)}class jm extends _m{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new jm(e,n,r)}_apply(e){return new ur(e.firestore,e.converter,Ul(e._query,this._limit,this._limitType))}}function Sg(t){return jm._create("limit",t,"F")}function Tg(t,e,n){if(typeof(n=zn(n))=="string"){if(n==="")throw new te($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wv(e)&&n.indexOf("/")!==-1)throw new te($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Fe.fromString(n));if(!oe.isDocumentKey(r))throw new te($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wp(t,new oe(r))}if(n instanceof Wt)return Wp(t,n._key);throw new te($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bc(n)}.`)}function Ig(t,e){if(!Array.isArray(t)||t.length===0)throw new te($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x0(t,e){const n=function(s,a){for(const o of s)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class i2{convertValue(e,n="none"){switch(xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return _s(e,(s,a)=>{r[s]=this.convertValue(a,n)}),r}convertVectorValue(e){var n,r,s;const a=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>nt(o.doubleValue));return new fm(a)}convertGeoPoint(e){return new mm(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ua(e));default:return null}}convertTimestamp(e){const n=Fr(e);return new lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Fe.fromString(e);Ae(Bv(r));const s=new $a(r.get(1),r.get(3)),a=new oe(r.popFirst(5));return s.isEqual(n)||or(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class y0 extends p0{constructor(e,n,r,s,a,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new cl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ic("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class cl extends y0{data(e={}){return super.data(e)}}class v0{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new sa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new cl(this._firestore,this._userDataWriter,r.key,r,new sa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new cl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new sa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new cl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new sa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:o2(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function o2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(t){t=wn(t,Wt);const e=wn(t.firestore,Ur);return qE(jc(e),t._key).then(n=>b0(e,t,n))}class Em extends i2{constructor(e){super(),this.firestore=e}convertBytes(e){return new pi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Wt(this.firestore,null,n)}}function Me(t){t=wn(t,ur);const e=wn(t.firestore,Ur),n=jc(e),r=new Em(e);return g0(t._query),HE(n,t._query).then(s=>new v0(e,r,t,s))}function ss(t,e,n,...r){t=wn(t,Wt);const s=wn(t.firestore,Ur),a=gm(s);let o;return o=typeof(e=zn(e))=="string"||e instanceof Ec?t2(a,"updateDoc",t._key,e,n,r):e2(a,"updateDoc",t._key,e),Sm(s,[o.toMutation(t._key,Pn.exists(!0))])}function ia(t){return Sm(wn(t.firestore,Ur),[new Kh(t._key,Pn.none())])}function is(t,e){const n=wn(t.firestore,Ur),r=Ht(t),s=a2(t.converter,e);return Sm(n,[ZE(gm(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Pn.exists(!1))]).then(()=>r)}function _0(t,...e){var n,r,s;t=zn(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Eg(e[o])||(a=e[o],o++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Eg(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,h,f;if(t instanceof Wt)h=wn(t.firestore,Ur),f=mc(t._key.path),u={next:g=>{e[o]&&e[o](b0(h,t,g))},error:e[o+1],complete:e[o+2]};else{const g=wn(t,ur);h=wn(g.firestore,Ur),f=g._query;const p=new Em(h);u={next:N=>{e[o]&&e[o](new v0(h,p,g,N))},error:e[o+1],complete:e[o+2]},g0(t._query)}return function(p,N,k,T){const D=new hm(T),S=new um(N,D,k);return p.asyncQueue.enqueueAndForget(async()=>om(await Hl(p),S)),()=>{D.Za(),p.asyncQueue.enqueueAndForget(async()=>lm(await Hl(p),S))}}(jc(h),f,c,u)}function Sm(t,e){return function(r,s){const a=new er;return r.asyncQueue.enqueueAndForget(async()=>RE(await zE(r),s,a)),a.promise}(jc(t),e)}function b0(t,e,n){const r=n.docs.get(e._key),s=new Em(t);return new y0(t,s,e._key,r,new sa(n.hasPendingWrites,n.fromCache),e.converter)}function kg(){return new xm("serverTimestamp")}(function(e,n=!0){(function(s){Ni=s})(Yb),Ml(new Ma("firestore",(r,{instanceIdentifier:s,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new Ur(new dN(r.getProvider("auth-internal")),new pN(r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new te($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $a(h.options.projectId,f)}(o,s),o);return a=Object.assign({useFetchStreams:n},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),ei(Bp,"4.7.3",e),ei(Bp,"4.7.3","esm2017")})();const N0=V.createContext(void 0),Ns=()=>{const t=V.useContext(N0);if(t===void 0)throw new Error("useTelegram must be used within a TelegramProvider");return t},Eu=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(null),[a,o]=V.useState(!1);V.useEffect(()=>{var u,h;if(typeof window<"u"&&((u=window.Telegram)!=null&&u.WebApp)){const f=window.Telegram.WebApp;n(f),s((h=f.initDataUnsafe)==null?void 0:h.user),o(!0),f.ready(),f.expand()}else o(!0)},[]);const c={webApp:e,user:r,isReady:a};return i.jsx(N0.Provider,{value:c,children:t})},j0=V.createContext(void 0),js=()=>{const t=V.useContext(j0);if(t===void 0)throw new Error("useFirebase must be used within a FirebaseProvider");return t},Su=({children:t,db:e})=>{const n={db:e};return i.jsx(j0.Provider,{value:n,children:t})};class l2{constructor(){Rt(this,"db",null);Rt(this,"dbName","MultiShopCache");Rt(this,"version",2);Rt(this,"stores",["shops","products","categories","departments","orders","users","syncQueue"])}async init(){return new Promise((e,n)=>{const r=indexedDB.open(this.dbName,this.version);r.onerror=()=>{console.error("IndexedDB error:",r.error),n(r.error)},r.onsuccess=()=>{this.db=r.result,console.log("IndexedDB opened successfully"),e()},r.onupgradeneeded=s=>{const a=s.target.result;console.log("Upgrading IndexedDB schema..."),this.stores.forEach(o=>{if(!a.objectStoreNames.contains(o)){console.log(`Creating object store: ${o}`);const c=a.createObjectStore(o,{keyPath:"id"});if(o!=="syncQueue"){c.createIndex("timestamp","timestamp"),c.createIndex("synced","synced");try{c.createIndex("shopId","data.shopId",{unique:!1})}catch{console.log(`Could not create shopId index for ${o}`)}}else c.createIndex("timestamp","timestamp"),c.createIndex("collection","collection")}})},r.onblocked=()=>{console.warn("IndexedDB upgrade blocked")}})}async getStore(e,n="readonly"){if(this.db||await this.init(),!this.db)throw new Error("IndexedDB not initialized");try{const r=this.db.transaction([e],n);return r.onerror=()=>{console.error(`Transaction error for ${e}:`,r.error)},r.objectStore(e)}catch(r){throw console.error(`Error getting store ${e}:`,r),r}}async get(e,n){try{const r=await this.getStore(e);return new Promise((s,a)=>{const o=r.get(n);o.onsuccess=()=>s(o.result||null),o.onerror=()=>{console.error(`Error getting item ${n} from ${e}:`,o.error),a(o.error)}})}catch(r){return console.error(`Error getting item from ${e}:`,r),null}}async getAll(e,n){try{const r=await this.getStore(e);return new Promise((s,a)=>{const o=r.getAll();o.onsuccess=()=>{let c=o.result||[];n&&(c=c.filter(n)),s(c)},o.onerror=()=>{console.error(`Error getting all items from ${e}:`,o.error),a(o.error)}})}catch(r){return console.error(`Error getting all items from ${e}:`,r),[]}}async set(e,n,r,s=!1){try{const a=await this.getStore(e,"readwrite"),o={id:n,data:r,timestamp:Date.now(),version:1,synced:s};return new Promise((c,u)=>{const h=a.put(o);h.onsuccess=()=>c(),h.onerror=()=>{console.error(`Error setting item ${n} in ${e}:`,h.error),u(h.error)}})}catch(a){throw console.error(`Error setting item in ${e}:`,a),a}}async delete(e,n){try{const r=await this.getStore(e,"readwrite");return new Promise((s,a)=>{const o=r.delete(n);o.onsuccess=()=>s(),o.onerror=()=>{console.error(`Error deleting item ${n} from ${e}:`,o.error),a(o.error)}})}catch(r){throw console.error(`Error deleting item from ${e}:`,r),r}}async clear(e){try{const n=await this.getStore(e,"readwrite");return new Promise((r,s)=>{const a=n.clear();a.onsuccess=()=>{console.log(`Cleared ${e} store`),r()},a.onerror=()=>{console.error(`Error clearing ${e}:`,a.error),s(a.error)}})}catch(n){throw console.error(`Error clearing ${e}:`,n),n}}async addToSyncQueue(e,n,r){try{const s={id:`${e}_${n}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,collection:e,operation:n,data:r,timestamp:Date.now(),retries:0},a=await this.getStore("syncQueue","readwrite");return new Promise((o,c)=>{const u=a.put(s);u.onsuccess=()=>o(),u.onerror=()=>{console.error("Error adding to sync queue:",u.error),c(u.error)}})}catch(s){throw console.error("Error adding to sync queue:",s),s}}async getSyncQueue(){try{return(await this.getAll("syncQueue")).map(n=>n.data||n).filter(n=>n.collection)}catch(e){return console.error("Error getting sync queue:",e),[]}}async removeSyncQueueItem(e){return this.delete("syncQueue",e)}async updateSyncQueueRetries(e,n){try{const r=await this.get("syncQueue",e);if(r){const s={...r.data,retries:n},a=await this.getStore("syncQueue","readwrite");return new Promise((o,c)=>{const u=a.put({...r,data:s});u.onsuccess=()=>o(),u.onerror=()=>{console.error("Error updating sync queue retries:",u.error),c(u.error)}})}}catch(r){throw console.error("Error updating sync queue retries:",r),r}}async getLastSyncTime(e){try{const n=await this.getAll(e);return n.length===0?0:Math.max(...n.map(r=>r.timestamp))}catch(n){return console.error(`Error getting last sync time for ${e}:`,n),0}}async markAsSynced(e,n){try{const r=await this.get(e,n);if(r){r.synced=!0,r.timestamp=Date.now();const s=await this.getStore(e,"readwrite");return new Promise((a,o)=>{const c=s.put(r);c.onsuccess=()=>a(),c.onerror=()=>{console.error(`Error marking ${n} as synced in ${e}:`,c.error),o(c.error)}})}}catch(r){throw console.error(`Error marking as synced in ${e}:`,r),r}}async getUnsyncedItems(e){return this.getAll(e,n=>!n.synced)}}const Ye=new l2;class c2{constructor(){Rt(this,"db",null);Rt(this,"syncWorker",null);Rt(this,"syncInterval",3e4);Rt(this,"isOnlineStatus",navigator.onLine);Rt(this,"syncInProgress",!1);Rt(this,"listeners",new Map);Rt(this,"syncIntervalId",null);window.addEventListener("online",()=>{this.isOnlineStatus=!0,this.startSync()}),window.addEventListener("offline",()=>{this.isOnlineStatus=!1,this.stopSync()})}async init(e,n={}){this.db=e,this.syncInterval=n.syncInterval||3e4;try{await Ye.init(),console.log("IndexedDB initialized successfully"),await this.initialDataLoad(),this.isOnlineStatus&&this.startSync()}catch(r){throw console.error("Failed to initialize cache service:",r),r}}async initialDataLoad(){var n,r;if(!this.db)return;console.log("Starting initial data load...");const e=["shops","products","categories","departments","orders","users"];for(const s of e)try{const a=Ie(this.db,s),o=await Me(a);console.log(`Loading ${o.docs.length} items from ${s}`);for(const c of o.docs){const u=c.data();await Ye.set(s,c.id,{id:c.id,...u,updatedAt:((n=u.updatedAt)==null?void 0:n.toDate())||new Date,createdAt:((r=u.createdAt)==null?void 0:r.toDate())||new Date},!0)}console.log(`Successfully cached ${o.docs.length} items from ${s}`)}catch(a){console.error(`Error loading initial data from ${s}:`,a)}console.log("Initial data load completed")}startSync(){this.syncInProgress||!this.isOnlineStatus||!this.db||(this.syncIntervalId&&clearInterval(this.syncIntervalId),this.performSync(),this.syncIntervalId=setInterval(()=>{this.isOnlineStatus&&!this.syncInProgress&&this.performSync()},this.syncInterval))}stopSync(){this.syncIntervalId&&(clearInterval(this.syncIntervalId),this.syncIntervalId=null)}async performSync(){if(!(this.syncInProgress||!this.isOnlineStatus||!this.db)){this.syncInProgress=!0;try{console.log("Starting sync process..."),await this.syncFromFirebase(),await this.syncToFirebase(),console.log("Sync process completed")}catch(e){console.error("Sync error:",e)}finally{this.syncInProgress=!1}}}async syncFromFirebase(){var n,r;if(!this.db)return;const e=["shops","products","categories","departments","orders","users"];for(const s of e)try{const a=await Ye.getLastSyncTime(s),o=Ie(this.db,s);let c=Re(o,Sg(50));a>0&&(c=Re(o,be("updatedAt",">",lt.fromMillis(a)),Sg(50)));const u=await Me(c);for(const h of u.docs){const f=h.data();await Ye.set(s,h.id,{id:h.id,...f,updatedAt:((n=f.updatedAt)==null?void 0:n.toDate())||new Date,createdAt:((r=f.createdAt)==null?void 0:r.toDate())||new Date},!0)}u.docs.length>0&&console.log(`Synced ${u.docs.length} items from ${s}`)}catch(a){console.error(`Error syncing ${s} from Firebase:`,a)}}async syncToFirebase(){if(!this.db)return;const e=await Ye.getSyncQueue();for(const n of e)try{await this.processSyncItem(n),await Ye.removeSyncQueueItem(n.id)}catch(r){console.error("Error processing sync item:",r);const s=n.retries+1;s<3?await Ye.updateSyncQueueRetries(n.id,s):(await Ye.removeSyncQueueItem(n.id),console.error("Max retries reached for sync item:",n))}}async processSyncItem(e){if(!this.db)return;const{collection:n,operation:r,data:s}=e,a=Ie(this.db,n);switch(r){case"create":const o=await is(a,{...s,createdAt:new Date,updatedAt:new Date});await Ye.set(n,o.id,{id:o.id,...s},!0);break;case"update":const c=Ht(this.db,n,s.id);await ss(c,{...s,updatedAt:new Date}),await Ye.markAsSynced(n,s.id);break;case"delete":const u=Ht(this.db,n,s.id);await ia(u),await Ye.delete(n,s.id);break}}async getCachedData(e,n){try{if(n){const r=await Ye.get(e,n);return r&&r.data?r.data:null}else{const s=(await Ye.getAll(e)).filter(a=>{var o;return!((o=a.data)!=null&&o.deleted)&&!a.deleted}).map(a=>a.data).filter(a=>a);return console.log(`Retrieved ${s.length} items from ${e} cache`),s}}catch(r){return console.error(`Error getting cached data from ${e}:`,r),n?null:[]}}async setCachedData(e,n,r,s=!0){try{if(await Ye.set(e,n,r,!s),s&&this.isOnlineStatus){const a=await Ye.get(e,n),o=a!=null&&a.synced?"update":"create";await Ye.addToSyncQueue(e,o,r),this.syncInProgress||setTimeout(()=>this.performSync(),100)}}catch(a){throw console.error(`Error setting cached data in ${e}:`,a),a}}async deleteCachedData(e,n,r=!0){try{r&&this.isOnlineStatus&&await Ye.addToSyncQueue(e,"delete",{id:n}),await Ye.delete(e,n),r&&!this.syncInProgress&&setTimeout(()=>this.performSync(),100)}catch(s){throw console.error(`Error deleting cached data from ${e}:`,s),s}}async clearCache(e){try{if(e)await Ye.clear(e);else{const n=["shops","products","categories","departments","orders","users"];for(const r of n)await Ye.clear(r)}}catch(n){throw console.error("Error clearing cache:",n),n}}setupRealtimeListener(e,n,r){if(this.getCachedData(e).then(c=>{if(c){const u=Array.isArray(c)?c:[c];n(u)}}),!this.db)return()=>{};const s=Ie(this.db,e);let a=s;r&&r.length>0&&(a=Re(s,...r));const o=_0(a,c=>{const u=[];c.forEach(h=>{var p,N;const f=h.data(),g={id:h.id,...f,createdAt:((p=f.createdAt)==null?void 0:p.toDate())||new Date,updatedAt:((N=f.updatedAt)==null?void 0:N.toDate())||new Date};u.push(g),Ye.set(e,h.id,g,!0)}),n(u)},c=>{console.error(`Real-time listener error for ${e}:`,c),this.getCachedData(e).then(u=>{if(u){const h=Array.isArray(u)?u:[u];n(h)}})});return this.listeners.set(e,o),o}isOffline(){return!this.isOnlineStatus}async getSyncStatus(){try{return{pendingSync:(await Ye.getSyncQueue()).length,lastSyncTime:Date.now(),isOnline:this.isOnlineStatus}}catch(e){return console.error("Error getting sync status:",e),{pendingSync:0,lastSyncTime:0,isOnline:this.isOnlineStatus}}}async forcSync(){this.isOnlineStatus&&!this.syncInProgress&&await this.performSync()}}const ul=new c2;/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(t,e)=>{const n=V.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:c="",children:u,...h},f)=>V.createElement("svg",{ref:f,...u2,width:s,height:s,stroke:r,strokeWidth:o?Number(a)*24/Number(s):a,className:["lucide",`lucide-${d2(t)}`,c].join(" "),...h},[...e.map(([g,p])=>V.createElement(g,p)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=le("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=le("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=le("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=le("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=le("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=le("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=le("FileEdit",[["path",{d:"M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5",key:"1bg6eb"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z",key:"1rgxu8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=le("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=le("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=le("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=le("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=le("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=le("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=le("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=le("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=le("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=le("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=le("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=le("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=le("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=le("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=le("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=le("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=le("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=le("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=le("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=le("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=le("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),C0=({product:t,onClose:e,onAddToCart:n,cartItem:r,onUpdateCartQuantity:s})=>{const[a,o]=V.useState(0),[c,u]=V.useState((r==null?void 0:r.quantity)||1),[h,f]=V.useState(!1),[g,p]=V.useState("details"),N=t.images&&t.images.length>0?t.images:["/placeholder-product.jpg"],k=t.stock<=t.lowStockAlert,T=t.stock===0,D=R=>{R<1||R>t.stock||(u(R),r&&s&&s(t.id,R))},S=()=>{T||n(t,c)},b=()=>{o(R=>(R+1)%N.length)},I=()=>{o(R=>(R-1+N.length)%N.length)},C=R=>`$${R.toFixed(2)}`,L=()=>{if(t.costPrice&&t.costPrice>0){const R=(t.costPrice-t.price)/t.costPrice*100;return R>0?R.toFixed(0):null}return null};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center",children:i.jsxs("div",{className:"bg-telegram-bg rounded-t-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-telegram-bg border-b border-telegram-hint/20 p-4 flex items-center justify-between z-10",children:[i.jsx("button",{onClick:e,className:"p-2 rounded-full bg-telegram-secondary-bg",children:i.jsx(yt,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{className:"p-2 rounded-full bg-telegram-secondary-bg",children:i.jsx(y2,{className:"w-5 h-5 text-telegram-hint"})}),i.jsx("button",{className:"p-2 rounded-full bg-telegram-secondary-bg",children:i.jsx(Pm,{className:"w-5 h-5 text-telegram-hint"})})]})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"aspect-square bg-gray-100 relative overflow-hidden",children:[i.jsx("img",{src:N[a],alt:t.name,className:"w-full h-full object-cover",onError:R=>{const w=R.target;w.src="/placeholder-product.jpg"}}),N.length>1&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:I,className:"absolute left-2 top-1/2 transform -translate-y-1/2 p-2 rounded-full bg-black bg-opacity-50 text-white",children:i.jsx(cs,{className:"w-4 h-4"})}),i.jsx("button",{onClick:b,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-2 rounded-full bg-black bg-opacity-50 text-white",children:i.jsx(aa,{className:"w-4 h-4"})}),i.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:N.map((R,w)=>i.jsx("button",{onClick:()=>o(w),className:`w-2 h-2 rounded-full ${w===a?"bg-white":"bg-white bg-opacity-50"}`},w))})]}),i.jsxs("div",{className:"absolute top-4 left-4 flex flex-col space-y-2",children:[t.featured&&i.jsxs("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium flex items-center",children:[i.jsx(Ka,{className:"w-3 h-3 mr-1 fill-current"}),"Featured"]}),k&&!T&&i.jsx("span",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Low Stock"}),T&&i.jsx("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Out of Stock"}),L()&&i.jsxs("span",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:[L(),"% OFF"]})]})]}),N.length>1&&i.jsx("div",{className:"flex space-x-2 p-4 overflow-x-auto",children:N.map((R,w)=>i.jsx("button",{onClick:()=>o(w),className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 ${w===a?"border-telegram-button":"border-transparent"}`,children:i.jsx("img",{src:R,alt:`${t.name} ${w+1}`,className:"w-full h-full object-cover"})},w))})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsx("h1",{className:"text-xl font-bold text-telegram-text flex-1 pr-2",children:t.name}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-button",children:C(t.price)}),t.costPrice&&t.costPrice>t.price&&i.jsx("div",{className:"text-sm text-telegram-hint line-through",children:C(t.costPrice)})]})]}),i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-telegram-hint",children:[i.jsx("span",{className:"capitalize",children:t.category}),t.sku&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"•"}),i.jsxs("span",{children:["SKU: ",t.sku]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(qe,{className:"w-4 h-4 text-telegram-hint"}),i.jsx("span",{className:`text-sm font-medium ${T?"text-red-500":k?"text-orange-500":"text-green-500"}`,children:T?"Out of Stock":k?`Only ${t.stock} left`:`${t.stock} in stock`})]}),t.tags&&t.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((R,w)=>i.jsx("span",{className:"bg-telegram-button bg-opacity-10 text-telegram-button px-2 py-1 rounded-full text-xs",children:R},w))}),i.jsx("div",{className:"border-b border-telegram-hint/20",children:i.jsx("div",{className:"flex space-x-6",children:[{id:"details",label:"Details"},{id:"specs",label:"Specs"},{id:"reviews",label:"Reviews"}].map(R=>i.jsx("button",{onClick:()=>p(R.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${g===R.id?"border-telegram-button text-telegram-button":"border-transparent text-telegram-hint"}`,children:R.label},R.id))})}),i.jsxs("div",{className:"min-h-[100px]",children:[g==="details"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"font-medium text-telegram-text mb-2 flex items-center",children:[i.jsx(T0,{className:"w-4 h-4 mr-2"}),"Description"]}),i.jsxs("div",{className:"text-telegram-hint text-sm",children:[h?i.jsx("p",{children:t.description}):i.jsx("p",{children:t.description.length>150?`${t.description.substring(0,150)}...`:t.description}),t.description.length>150&&i.jsx("button",{onClick:()=>f(!h),className:"text-telegram-button text-sm mt-1 hover:underline",children:h?"Show Less":"Read More"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-telegram-secondary-bg rounded-lg",children:[i.jsx(Ga,{className:"w-5 h-5 text-telegram-button"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-telegram-text",children:"Free Delivery"}),i.jsx("p",{className:"text-xs text-telegram-hint",children:"On orders over $50"})]})]}),i.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-telegram-secondary-bg rounded-lg",children:[i.jsx(b2,{className:"w-5 h-5 text-telegram-button"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-telegram-text",children:"Quality Guarantee"}),i.jsx("p",{className:"text-xs text-telegram-hint",children:"30-day return policy"})]})]}),i.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-telegram-secondary-bg rounded-lg",children:[i.jsx(Nn,{className:"w-5 h-5 text-telegram-button"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-telegram-text",children:"Fast Processing"}),i.jsx("p",{className:"text-xs text-telegram-hint",children:"Ships within 24 hours"})]})]})]})]}),g==="specs"&&i.jsxs("div",{className:"space-y-3",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-3",children:"Specifications"}),i.jsxs("div",{className:"space-y-2",children:[t.weight&&t.weight>0&&i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Weight"}),i.jsxs("span",{className:"text-telegram-text",children:[t.weight," kg"]})]}),t.dimensions&&i.jsxs(i.Fragment,{children:[t.dimensions.length>0&&i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Length"}),i.jsxs("span",{className:"text-telegram-text",children:[t.dimensions.length," cm"]})]}),t.dimensions.width>0&&i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Width"}),i.jsxs("span",{className:"text-telegram-text",children:[t.dimensions.width," cm"]})]}),t.dimensions.height>0&&i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Height"}),i.jsxs("span",{className:"text-telegram-text",children:[t.dimensions.height," cm"]})]})]}),i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Category"}),i.jsx("span",{className:"text-telegram-text capitalize",children:t.category})]}),t.subcategory&&i.jsxs("div",{className:"flex justify-between py-2 border-b border-telegram-hint/10",children:[i.jsx("span",{className:"text-telegram-hint",children:"Subcategory"}),i.jsx("span",{className:"text-telegram-text capitalize",children:t.subcategory})]})]})]}),g==="reviews"&&i.jsx("div",{className:"space-y-3",children:i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Ka,{className:"w-12 h-12 mx-auto text-telegram-hint mb-3"}),i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"No Reviews Yet"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:"Be the first to review this product!"})]})})]})]}),i.jsx("div",{className:"sticky bottom-0 bg-telegram-bg border-t border-telegram-hint/20 p-4",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[!T&&i.jsxs("div",{className:"flex items-center space-x-2 bg-telegram-secondary-bg rounded-lg p-1",children:[i.jsx("button",{onClick:()=>D(c-1),disabled:c<=1,className:"p-2 rounded-lg hover:bg-telegram-hint hover:bg-opacity-20 disabled:opacity-50",children:i.jsx(Wa,{className:"w-4 h-4 text-telegram-text"})}),i.jsx("span",{className:"px-3 py-1 text-telegram-text font-medium min-w-[2rem] text-center",children:c}),i.jsx("button",{onClick:()=>D(c+1),disabled:c>=t.stock,className:"p-2 rounded-lg hover:bg-telegram-hint hover:bg-opacity-20 disabled:opacity-50",children:i.jsx(yn,{className:"w-4 h-4 text-telegram-text"})})]}),i.jsxs("button",{onClick:S,disabled:T,className:`flex-1 py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 ${T?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-telegram-button text-telegram-button-text hover:opacity-80"}`,children:[i.jsx(Vn,{className:"w-5 h-5"}),i.jsx("span",{children:T?"Out of Stock":r?"Update Cart":`Add to Cart • ${C(t.price*c)}`})]})]})})]})})};class E2{constructor(){Rt(this,"dbName","ShopListCache");Rt(this,"version",1);Rt(this,"db",null)}async init(){return new Promise((e,n)=>{const r=indexedDB.open(this.dbName,this.version);r.onerror=()=>n(r.error),r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=s=>{const a=s.target.result;a.objectStoreNames.contains("shops")||a.createObjectStore("shops",{keyPath:"id"}),a.objectStoreNames.contains("products")||a.createObjectStore("products",{keyPath:"id"}),a.objectStoreNames.contains("categories")||a.createObjectStore("categories",{keyPath:"id"})}})}async getShops(){return this.db||await this.init(),new Promise((e,n)=>{const a=this.db.transaction(["shops"],"readonly").objectStore("shops").getAll();a.onsuccess=()=>e(a.result||[]),a.onerror=()=>n(a.error)})}async setShops(e){return this.db||await this.init(),new Promise((n,r)=>{const s=this.db.transaction(["shops"],"readwrite"),a=s.objectStore("shops");a.clear(),e.forEach(o=>a.add(o)),s.oncomplete=()=>n(),s.onerror=()=>r(s.error)})}async getProducts(e){return this.db||await this.init(),new Promise((n,r)=>{const o=this.db.transaction(["products"],"readonly").objectStore("products").getAll();o.onsuccess=()=>{const u=(o.result||[]).filter(h=>h.shopId===e);n(u)},o.onerror=()=>r(o.error)})}async setProducts(e,n){return this.db||await this.init(),new Promise((r,s)=>{const a=this.db.transaction(["products"],"readwrite"),o=a.objectStore("products"),c=o.getAll();c.onsuccess=()=>{const h=(c.result||[]).filter(f=>f.shopId!==e);o.clear(),h.forEach(f=>o.add(f)),n.forEach(f=>o.add(f)),a.oncomplete=()=>r(),a.onerror=()=>s(a.error)}})}async getCategories(e){return this.db||await this.init(),new Promise((n,r)=>{const o=this.db.transaction(["categories"],"readonly").objectStore("categories").getAll();o.onsuccess=()=>{const u=(o.result||[]).filter(h=>h.shopId===e).map(h=>h.name);n(u)},o.onerror=()=>r(o.error)})}async setCategories(e,n){return this.db||await this.init(),new Promise((r,s)=>{const a=this.db.transaction(["categories"],"readwrite"),o=a.objectStore("categories"),c=o.getAll();c.onsuccess=()=>{const h=(c.result||[]).filter(f=>f.shopId!==e);o.clear(),h.forEach(f=>o.add(f)),n.forEach((f,g)=>{o.add({id:`${e}_${f}`,shopId:e,name:f,order:g})}),a.oncomplete=()=>r(),a.onerror=()=>s(a.error)}})}}const Mt=new E2,S2=()=>{const{db:t}=js(),{user:e}=Ns(),[n,r]=V.useState([]),[s,a]=V.useState([]),[o,c]=V.useState([]),[u,h]=V.useState(!0),[f,g]=V.useState(null),[p,N]=V.useState(null),[k,T]=V.useState("shops"),[D,S]=V.useState(null),[b,I]=V.useState(""),[C,L]=V.useState([]),[R,w]=V.useState(!1),[x,_]=V.useState(!1),[j,E]=V.useState(navigator.onLine),[A,v]=V.useState(null);V.useEffect(()=>{Mt.init().catch(console.error);const M=()=>E(!0),J=()=>E(!1);return window.addEventListener("online",M),window.addEventListener("offline",J),e!=null&&e.id?ae():(h(!1),g("Please open this app from Telegram to see your shops.")),()=>{window.removeEventListener("online",M),window.removeEventListener("offline",J)}},[e]);const ae=async()=>{try{if(h(!0),g(null),!(e!=null&&e.id)){g("No user information available");return}const M=Ie(t,"users");let J=await Me(Re(M,be("telegramId","==",parseInt(e.id))));if(J.empty&&(J=await Me(Re(M,be("telegram_id","==",parseInt(e.id))))),J.empty){console.log("User not found in database, showing all active shops"),await Z(),h(!1);return}const de=J.docs[0].data();N(de),await Z()}catch(M){console.error("Error fetching user data:",M),g("Failed to load your shop data. Please try again.")}finally{h(!1)}},Z=async()=>{try{if(!j){console.log("Offline: Loading shops from cache");const ue=await Mt.getShops();if(ue.length>0){r(ue);return}}const M=Ie(t,"shops"),J=Re(M,be("isActive","==",!0),en("updatedAt","desc")),he=await Me(J);if(he.empty){const ue=await Mt.getShops();if(ue.length>0){r(ue);return}g("No active shops found.");return}const de=[];he.forEach(ue=>{var fe,ct;const xe=ue.data(),Ce={id:ue.id,ownerId:xe.ownerId,name:xe.name,slug:xe.slug,description:xe.description,logo:xe.logo,isActive:xe.isActive,businessInfo:xe.businessInfo,settings:xe.settings,stats:xe.stats,createdAt:((fe=xe.createdAt)==null?void 0:fe.toDate())||new Date,updatedAt:((ct=xe.updatedAt)==null?void 0:ct.toDate())||new Date};de.push(Ce)}),r(de);try{await Mt.setShops(de),console.log("Shops cached successfully")}catch(ue){console.warn("Failed to cache shops:",ue)}}catch(M){console.error("Error fetching all active shops:",M);try{const J=await Mt.getShops();J.length>0?(r(J),g("Showing cached shops (offline)")):g("Failed to load shops. Please try again.")}catch{g("Failed to load shops. Please try again.")}}},O=M=>{var ue,xe;const he=`https://t.me/shop_test12345_bot?start=${M.id}`,de=`Check out ${M.name}! 🛍️

${M.description}

${he}`;(xe=(ue=window.Telegram)==null?void 0:ue.WebApp)!=null&&xe.openTelegramLink?window.Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(he)}&text=${encodeURIComponent(de)}`):navigator.share?navigator.share({title:M.name,text:de,url:he}).catch(console.error):navigator.clipboard.writeText(de).then(()=>{var Ce,fe;(fe=(Ce=window.Telegram)==null?void 0:Ce.WebApp)!=null&&fe.showAlert?window.Telegram.WebApp.showAlert("Shop link copied to clipboard!"):alert("Shop link copied to clipboard!")}).catch(()=>{var fe,ct;const Ce=document.createElement("textarea");Ce.value=de,document.body.appendChild(Ce),Ce.select(),document.execCommand("copy"),document.body.removeChild(Ce),(ct=(fe=window.Telegram)==null?void 0:fe.WebApp)!=null&&ct.showAlert?window.Telegram.WebApp.showAlert("Shop link copied to clipboard!"):alert("Shop link copied to clipboard!")})},G=async M=>{try{if(h(!0),!j){console.log("Offline: Loading categories from cache");const xe=await Mt.getCategories(M);if(xe.length>0){c(xe),h(!1);return}}const J=Ie(t,"categories"),he=Re(J,be("shopId","==",M),en("order","asc")),de=await Me(he),ue=[];de.forEach(xe=>{const Ce=xe.data();Ce.name&&ue.push(Ce.name)}),c(ue);try{await Mt.setCategories(M,ue),console.log("Categories cached successfully")}catch(xe){console.warn("Failed to cache categories:",xe)}if(ue.length===0){const xe=await Mt.getCategories(M);xe.length>0?c(xe):g("No categories found for this shop.")}}catch(J){console.error("Error fetching categories:",J);try{const he=await Mt.getCategories(M);he.length>0?(c(he),g("Showing cached categories (offline)")):g("Failed to load categories. Please try again.")}catch{g("Failed to load categories. Please try again.")}}finally{h(!1)}},U=async(M,J)=>{try{if(h(!0),!j){console.log("Offline: Loading products from cache");const fe=(await Mt.getProducts(M)).filter(ct=>ct.category===J&&ct.isActive);if(fe.length>0){a(fe),h(!1);return}}const he=Ie(t,"products"),de=Re(he,be("shopId","==",M),be("category","==",J),be("isActive","==",!0),en("name","asc")),ue=await Me(de),xe=[];ue.forEach(Ce=>{var Qr,Ze;const fe=Ce.data(),ct={id:Ce.id,shopId:fe.shopId,name:fe.name||"Unnamed Product",description:fe.description||"No description available",price:fe.price||0,stock:fe.stock||0,category:fe.category||"other",subcategory:fe.subcategory,images:fe.images||[],sku:fe.sku,isActive:fe.isActive!==!1,lowStockAlert:fe.lowStockAlert||0,tags:fe.tags,featured:fe.featured,costPrice:fe.costPrice,weight:fe.weight,dimensions:fe.dimensions,createdAt:((Qr=fe.createdAt)==null?void 0:Qr.toDate())||new Date,updatedAt:((Ze=fe.updatedAt)==null?void 0:Ze.toDate())||new Date};xe.push(ct)}),a(xe);try{await Mt.setProducts(M,xe),console.log("Products cached successfully")}catch(Ce){console.warn("Failed to cache products:",Ce)}if(xe.length===0){const fe=(await Mt.getProducts(M)).filter(ct=>ct.category===J&&ct.isActive);fe.length>0?a(fe):g(`No products found in the ${J} category.`)}}catch(he){console.error("Error fetching products:",he);try{const ue=(await Mt.getProducts(M)).filter(xe=>xe.category===J&&xe.isActive);ue.length>0?(a(ue),g("Showing cached products (offline)")):g("Failed to load products. Please try again.")}catch{g("Failed to load products. Please try again.")}}finally{h(!1)}},q=async M=>{try{if(h(!0),!j){console.log("Offline: Loading featured products from cache");const Ce=(await Mt.getProducts(M)).filter(fe=>fe.featured&&fe.isActive);if(Ce.length>0){a(Ce),h(!1);return}}const J=Ie(t,"products"),he=Re(J,be("shopId","==",M),be("isActive","==",!0),be("featured","==",!0),en("updatedAt","desc")),de=await Me(he),ue=[];de.forEach(xe=>{const Ce=xe.data(),fe=X(xe.id,Ce);ue.push(fe)}),a(ue);try{await Mt.setProducts(M,ue),console.log("Featured products cached successfully")}catch(xe){console.warn("Failed to cache featured products:",xe)}}catch(J){console.error("Error fetching featured products:",J);try{const de=(await Mt.getProducts(M)).filter(ue=>ue.featured&&ue.isActive);de.length>0?(a(de),g("Showing cached featured products (offline)")):g("Failed to load featured products. Please try again.")}catch{g("Failed to load featured products. Please try again.")}}finally{h(!1)}},X=(M,J)=>{var he,de;return{id:M,shopId:J.shopId,name:J.name||"Unnamed Product",description:J.description||"No description available",price:J.price||0,stock:J.stock||0,category:J.category||"other",subcategory:J.subcategory,images:J.images||[],sku:J.sku,isActive:J.isActive!==!1,lowStockAlert:J.lowStockAlert||0,tags:J.tags,featured:J.featured,costPrice:J.costPrice,weight:J.weight,dimensions:J.dimensions,createdAt:((he=J.createdAt)==null?void 0:he.toDate())||new Date,updatedAt:((de=J.updatedAt)==null?void 0:de.toDate())||new Date}},ee=M=>{S(M),T("categories"),g(null),G(M.id)},Q=M=>{S(M),T("products"),I("Featured"),g(null),q(M.id)},B=M=>{D&&(I(M),T("products"),g(null),U(D.id,M))},Ne=()=>{T("shops"),S(null),c([]),g(null)},Je=()=>{T("categories"),I(""),a([]),g(null)},Ue=M=>{var he;if(C.find(de=>de.productId===M.id))L(C.map(de=>de.productId===M.id?{...de,quantity:de.quantity+1,total:(de.quantity+1)*de.price}:de));else{const de={productId:M.id,productName:M.name,quantity:1,price:M.price,total:M.price,productImage:(he=M.images)==null?void 0:he[0],productSku:M.sku};L([...C,de])}},ce=(M,J)=>{J<=0?L(C.filter(he=>he.productId!==M)):L(C.map(he=>he.productId===M?{...he,quantity:J,total:J*he.price}:he))},vt=()=>C.reduce((M,J)=>M+J.total,0),sn=()=>C.reduce((M,J)=>M+J.quantity,0),At=async()=>{if(!D||!e||C.length===0){console.warn("Cannot place order. Missing data:",{selectedShop:D,user:e,cart:C}),g("Cannot place order: missing information or empty cart.");return}try{w(!0),g(null);const M=vt(),J=M*.1,he=M+J,de={shopId:D.id,customerId:e.id,customerName:`${e.firstName} ${e.lastName||""}`.trim(),items:C,subtotal:M,tax:J,total:he,status:"pending",paymentStatus:"pending",deliveryMethod:"pickup",source:"web",telegramId:e.id.toString(),telegramUsername:e.username},ue=Ie(t,"orders");await is(ue,{...de,createdAt:kg(),updatedAt:kg()}),L([]),_(!0),console.log("Order placed successfully:",de),setTimeout(()=>_(!1),3e3)}catch(M){console.error("Error placing order:",M),g("Failed to place order. Please try again.")}finally{w(!1)}},ne=()=>{T("cart"),g(null)},ye=()=>{T("products"),g(null)},Ke=M=>{v(M)},wt=()=>{v(null)},Bt=(M,J)=>{var de;if(C.find(ue=>ue.productId===M.id))L(C.map(ue=>ue.productId===M.id?{...ue,quantity:J,total:J*ue.price}:ue));else{const ue={productId:M.id,productName:M.name,quantity:J,price:M.price,total:M.price*J,productImage:(de=M.images)==null?void 0:de[0],productSku:M.sku};L([...C,ue])}v(null)};return u?i.jsx("div",{className:"p-4",children:i.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(M=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-lg"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-2/3"})]})]})},M))})}):f?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:f.includes("No shops")?"No Shops Found":"Error Loading Data"}),i.jsx("p",{className:"text-telegram-hint mb-4",children:f}),!j&&i.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg mb-4",children:i.jsx("p",{className:"text-sm",children:"You're currently offline. Some data may be cached."})}),!f.includes("No shops")&&i.jsx("button",{onClick:ae,className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg",children:"Try Again"})]})}):k==="shops"?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:"Available Shops"}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:[n.length," shop",n.length!==1?"s":""," available",!j&&" (cached)"]})]})}),!j&&i.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg mb-4",children:i.jsx("p",{className:"text-sm",children:"You're offline. Showing cached data."})}),i.jsx("div",{className:"space-y-3",children:n.map(M=>{var J;return i.jsx("div",{onClick:()=>ee(M),className:"bg-telegram-secondary-bg rounded-lg p-4 cursor-pointer transition-all hover:shadow-md active:scale-95",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsxs("div",{className:"w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:[M.logo?i.jsx("img",{src:M.logo,alt:M.name,className:"w-full h-full object-cover rounded-lg"}):null,!M.logo&&i.jsx($r,{className:"w-8 h-8 text-telegram-hint"})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsx("h3",{className:"font-semibold text-telegram-text truncate pr-2",children:M.name}),i.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[i.jsx(Ka,{className:"w-4 h-4 text-yellow-500 fill-current"}),i.jsx("span",{className:"text-sm font-medium text-telegram-text",children:(4+Math.random()).toFixed(1)})]})]}),i.jsx("p",{className:"text-sm text-telegram-hint mt-1 line-clamp-2",children:M.description}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:"text-xs bg-telegram-button text-telegram-button-text px-2 py-1 rounded-full",children:[((J=M.stats)==null?void 0:J.totalProducts)||0," Products"]}),M.stats&&M.stats.totalProducts>0&&i.jsx("button",{onClick:he=>{he.stopPropagation(),Q(M)},className:"text-xs bg-yellow-500 text-white px-2 py-1 rounded-full",children:"Featured"})]}),i.jsx("span",{className:"text-xs text-telegram-hint",children:M.isActive?"Open":"Closed"})]})]})]})},M.id)})})]}):k==="categories"?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("button",{onClick:Ne,className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(cs,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:D==null?void 0:D.name}),i.jsx("p",{className:"text-sm text-telegram-hint",children:"Select a category"})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.map(M=>i.jsx("button",{onClick:()=>B(M),className:"bg-telegram-secondary-bg rounded-lg p-4 text-left hover:shadow-md transition-all active:scale-95",children:i.jsxs("div",{className:"text-center",children:[i.jsx(qe,{className:"w-8 h-8 mx-auto text-telegram-button mb-2"}),i.jsx("h3",{className:"font-medium text-telegram-text capitalize",children:M}),i.jsxs("p",{className:"text-xs text-telegram-hint mt-1",children:["Browse ",M.toLowerCase()]})]})},M))}),o.length===0&&!u&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No Categories"}),i.jsx("p",{className:"text-telegram-hint",children:"This shop hasn't set up categories yet."})]})]}):k==="cart"?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("button",{onClick:ye,className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(cs,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:"Shopping Cart"}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:[C.length," item",C.length!==1?"s":""," • $",vt().toFixed(2)]})]})]}),!j&&i.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg mb-4",children:i.jsx("p",{className:"text-sm",children:"You're offline. Showing cached categories."})}),x&&i.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg flex items-center space-x-2 mb-4",children:[i.jsx(Jn,{className:"w-5 h-5"}),i.jsx("span",{children:"Order placed successfully!"})]}),C.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Vn,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"Your cart is empty"}),i.jsx("p",{className:"text-telegram-hint",children:"Add some products to get started!"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-3",children:C.map(M=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-telegram-text",children:M.productName}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:["$",M.price.toFixed(2)," each"]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>ce(M.productId,M.quantity-1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(Wa,{className:"w-4 h-4"})}),i.jsx("span",{className:"text-telegram-text font-medium w-8 text-center",children:M.quantity}),i.jsx("button",{onClick:()=>ce(M.productId,M.quantity+1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(yn,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"font-bold text-telegram-text",children:["$",M.total.toFixed(2)]})})]})]})},M.productId))}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-telegram-text",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["$",vt().toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between text-telegram-text",children:[i.jsx("span",{children:"Tax (10%):"}),i.jsxs("span",{children:["$",(vt()*.1).toFixed(2)]})]}),i.jsx("hr",{className:"border-telegram-hint/20"}),i.jsxs("div",{className:"flex justify-between font-bold text-lg text-telegram-text",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",(vt()*1.1).toFixed(2)]})]})]}),i.jsx("button",{onClick:At,disabled:R,className:"w-full bg-telegram-button text-telegram-button-text py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Placing Order...":"Place Order"})]})]}):k==="products"?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:Je,className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(cs,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text capitalize",children:b}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:[D==null?void 0:D.name," • ",s.length," product",s.length!==1?"s":"",!j&&" (cached)"]})]})]}),C.length>0&&i.jsxs("button",{onClick:ne,className:"relative p-2 rounded-lg bg-telegram-button text-telegram-button-text",children:[i.jsx(Vn,{className:"w-5 h-5"}),i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:sn()})]})]}),!j&&i.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg mb-4",children:i.jsx("p",{className:"text-sm",children:"You're offline. Showing cached products."})}),i.jsx("div",{className:"space-y-3",children:s.map(M=>{var he,de;const J=C.find(ue=>ue.productId===M.id);return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsxs("div",{className:"w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0 cursor-pointer",onClick:()=>Ke(M),children:[(he=M.images)!=null&&he[0]?i.jsx("img",{src:M.images[0],alt:M.name,className:"w-full h-full object-cover rounded-lg"}):null,!((de=M.images)!=null&&de[0])&&i.jsx(qe,{className:"w-8 h-8 text-telegram-hint"})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsx("h3",{className:"font-semibold text-telegram-text truncate pr-2 cursor-pointer hover:text-telegram-button",onClick:()=>Ke(M),children:M.name}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsxs("div",{className:"text-lg font-bold text-telegram-button",children:["$",M.price.toFixed(2)]}),M.stock===0&&i.jsx("span",{className:"text-xs bg-red-500 text-white px-2 py-1 rounded-full",children:"Out of Stock"}),i.jsxs("button",{onClick:ue=>{ue.stopPropagation(),O(shop)},className:"text-xs bg-green-500 text-white px-2 py-1 rounded-full flex items-center space-x-1",title:"Share Shop",children:[i.jsx(Pm,{className:"w-3 h-3"}),i.jsx("span",{children:"Share"})]})]})]}),i.jsx("p",{className:"text-sm text-telegram-hint mt-1 line-clamp-2 cursor-pointer",onClick:()=>Ke(M),children:M.description}),i.jsxs("div",{className:"flex items-center justify-between mt-3",children:[M.stock>0?J?i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>ce(M.id,J.quantity-1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(Wa,{className:"w-4 h-4"})}),i.jsx("span",{className:"text-telegram-text font-medium",children:J.quantity}),i.jsx("button",{onClick:()=>ce(M.id,J.quantity+1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(yn,{className:"w-4 h-4"})}),i.jsxs("span",{className:"text-sm text-telegram-hint ml-2",children:["$",(J.quantity*M.price).toFixed(2)]})]}):i.jsxs("button",{onClick:()=>Ue(M),className:"flex items-center space-x-2 bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg",children:[i.jsx(yn,{className:"w-4 h-4"}),i.jsx("span",{children:"Add to Cart"})]}):i.jsx("span",{className:"text-sm text-red-500",children:"Out of Stock"}),i.jsx("button",{onClick:()=>Ke(M),className:"text-sm text-telegram-button hover:underline",children:"View Details"})]})]})]})},M.id)})}),A&&i.jsx(C0,{product:A,onClose:wt,onAddToCart:Bt,cartItem:C.find(M=>M.productId===A.id),onUpdateCartQuantity:ce})]}):null},T2=({order:t,onClose:e})=>{const n=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"payment_pending":return"bg-orange-100 text-orange-800";case"confirmed":return"bg-blue-100 text-blue-800";case"processing":return"bg-purple-100 text-purple-800";case"shipped":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},r=s=>{switch(s){case"pending":return i.jsx(Nn,{className:"w-4 h-4"});case"payment_pending":return i.jsx(Ac,{className:"w-4 h-4"});case"confirmed":case"processing":return i.jsx(qe,{className:"w-4 h-4"});case"shipped":return i.jsx(Ga,{className:"w-4 h-4"});case"delivered":return i.jsx(Jn,{className:"w-4 h-4"});case"cancelled":return i.jsx(ys,{className:"w-4 h-4"});default:return i.jsx(Nn,{className:"w-4 h-4"})}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("div",{className:"p-4 border-b border-telegram-hint/20",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-lg font-bold text-telegram-text",children:["Order #",t.id.slice(-8)]}),i.jsx("button",{onClick:e,className:"text-telegram-hint hover:text-telegram-text p-2 rounded",children:i.jsx(yt,{className:"w-6 h-6"})})]})}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-medium text-telegram-text",children:"Order Status"}),i.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1 ${n(t.status)}`,children:[r(t.status),i.jsx("span",{className:"capitalize",children:t.status.replace("_"," ")})]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Order Date:"}),i.jsx("span",{className:"text-telegram-text",children:t.createdAt.toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Payment Status:"}),i.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.paymentStatus})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Delivery Method:"}),i.jsx("span",{className:"text-telegram-text capitalize",children:t.deliveryMethod})]}),t.trackingNumber&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Tracking:"}),i.jsx("span",{className:"text-telegram-text font-mono",children:t.trackingNumber})]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-3",children:"Items Ordered"}),i.jsx("div",{className:"space-y-3",children:t.items.map((s,a)=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-medium text-telegram-text",children:s.productName}),i.jsxs("p",{className:"text-xs text-telegram-hint",children:["$",s.price.toFixed(2)," × ",s.quantity]})]}),i.jsxs("div",{className:"text-sm font-medium text-telegram-text",children:["$",s.total.toFixed(2)]})]},a))}),i.jsxs("div",{className:"border-t border-telegram-hint/20 mt-3 pt-3 space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Subtotal:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",t.subtotal.toFixed(2)]})]}),t.tax>0&&i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Tax:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",t.tax.toFixed(2)]})]}),t.deliveryFee&&t.deliveryFee>0&&i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Delivery Fee:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",t.deliveryFee.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between font-medium text-telegram-text border-t border-telegram-hint/20 pt-1",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",t.total.toFixed(2)]})]})]})]}),t.customerNotes&&i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Notes"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:t.customerNotes})]}),t.deliveryAddress&&i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Delivery Address"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:t.deliveryAddress})]})]}),i.jsx("div",{className:"p-4 border-t border-telegram-hint/20",children:i.jsx("button",{onClick:e,className:"w-full bg-telegram-button text-telegram-button-text py-3 rounded-lg font-medium",children:"Close"})})]})})},I2=({user:t,userData:e})=>{const{webApp:n}=Ns(),{db:r}=js(),[s,a]=V.useState([]),[o,c]=V.useState(!1),[u,h]=V.useState(null),[f,g]=V.useState([]),[p,N]=V.useState(!1),[k,T]=V.useState(null),[D,S]=V.useState({notifications:{orderUpdates:!0,promotions:!1,newsletter:!1}}),[b,I]=V.useState({totalOrders:0,totalSpent:0,pendingOrders:0,completedOrders:0});V.useEffect(()=>{t!=null&&t.id&&e&&C()},[t,e]);const C=async()=>{if(t!=null&&t.id)try{c(!0),T(null);const x=Ie(r,"orders");let _;try{const Z=Re(x,be("telegramId","==",t.id),en("createdAt","desc"));_=await Me(Z)}catch{console.log("First query failed, trying alternative approaches")}if(!_||_.empty)try{const Z=Re(x,be("telegramId","==",parseInt(t.id)),en("createdAt","desc"));_=await Me(Z)}catch{console.log("Second query failed")}if(!_||_.empty)try{const Z=Re(x,be("customerId","==",t.id),en("createdAt","desc"));_=await Me(Z)}catch{console.log("Third query failed")}if(!_||_.empty)try{const Z=Re(x,en("createdAt","desc")),O=await Me(Z),G=[];O.forEach(Q=>{var Ne,Je,Ue,ce,vt,sn;const B=Q.data();if(B.telegramId===t.id||B.telegramId===parseInt(t.id)||B.customerId===t.id||B.customerName===`${t.firstName} ${t.lastName}`.trim()){const At={id:Q.id,shopId:B.shopId||"",customerId:B.customerId||"",customerName:B.customerName||"Unknown Customer",customerPhone:B.customerPhone,customerEmail:B.customerEmail,items:B.items||[],subtotal:B.subtotal||0,tax:B.tax||0,total:B.total||0,status:B.status||"pending",paymentStatus:B.paymentStatus||"pending",deliveryMethod:B.deliveryMethod||"pickup",deliveryAddress:B.deliveryAddress,deliveryFee:B.deliveryFee,estimatedDeliveryTime:(Ne=B.estimatedDeliveryTime)==null?void 0:Ne.toDate(),paymentPreference:B.paymentPreference,paymentPhotoUrl:B.paymentPhotoUrl,requiresPaymentConfirmation:B.requiresPaymentConfirmation,customerNotes:B.customerNotes,source:B.source||"web",tableNumber:B.tableNumber,telegramId:B.telegramId,telegramUsername:B.telegramUsername,trackingNumber:B.trackingNumber,createdAt:((Je=B.createdAt)==null?void 0:Je.toDate())||new Date,updatedAt:((Ue=B.updatedAt)==null?void 0:Ue.toDate())||new Date,confirmedAt:(ce=B.confirmedAt)==null?void 0:ce.toDate(),shippedAt:(vt=B.shippedAt)==null?void 0:vt.toDate(),deliveredAt:(sn=B.deliveredAt)==null?void 0:sn.toDate()};G.push(At)}}),a(G);const U=G.length,q=G.reduce((Q,B)=>Q+B.total,0),X=G.filter(Q=>["pending","payment_pending","confirmed","processing"].includes(Q.status)).length,ee=G.filter(Q=>Q.status==="delivered").length;I({totalOrders:U,totalSpent:q,pendingOrders:X,completedOrders:ee}),c(!1);return}catch(Z){console.error("All order queries failed:",Z)}const j=[];_&&!_.empty&&_.forEach(Z=>{var U,q,X,ee,Q,B;const O=Z.data(),G={id:Z.id,shopId:O.shopId||"",customerId:O.customerId||"",customerName:O.customerName||"Unknown Customer",customerPhone:O.customerPhone,customerEmail:O.customerEmail,items:O.items||[],subtotal:O.subtotal||0,tax:O.tax||0,total:O.total||0,status:O.status||"pending",paymentStatus:O.paymentStatus||"pending",deliveryMethod:O.deliveryMethod||"pickup",deliveryAddress:O.deliveryAddress,deliveryFee:O.deliveryFee,estimatedDeliveryTime:(U=O.estimatedDeliveryTime)==null?void 0:U.toDate(),paymentPreference:O.paymentPreference,paymentPhotoUrl:O.paymentPhotoUrl,requiresPaymentConfirmation:O.requiresPaymentConfirmation,customerNotes:O.customerNotes,source:O.source||"web",tableNumber:O.tableNumber,telegramId:O.telegramId,telegramUsername:O.telegramUsername,trackingNumber:O.trackingNumber,createdAt:((q=O.createdAt)==null?void 0:q.toDate())||new Date,updatedAt:((X=O.updatedAt)==null?void 0:X.toDate())||new Date,confirmedAt:(ee=O.confirmedAt)==null?void 0:ee.toDate(),shippedAt:(Q=O.shippedAt)==null?void 0:Q.toDate(),deliveredAt:(B=O.deliveredAt)==null?void 0:B.toDate()};j.push(G)}),a(j);const E=j.length,A=j.reduce((Z,O)=>Z+O.total,0),v=j.filter(Z=>["pending","payment_pending","confirmed","processing"].includes(Z.status)).length,ae=j.filter(Z=>Z.status==="delivered").length;I({totalOrders:E,totalSpent:A,pendingOrders:v,completedOrders:ae})}catch(x){console.error("Error fetching user orders:",x),T("Failed to load your orders. Please try again.")}finally{c(!1)}},L=x=>{switch(x){case"pending":return"bg-yellow-100 text-yellow-800";case"payment_pending":return"bg-orange-100 text-orange-800";case"confirmed":return"bg-blue-100 text-blue-800";case"processing":return"bg-purple-100 text-purple-800";case"shipped":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=x=>{switch(x){case"pending":return i.jsx(Nn,{className:"w-4 h-4"});case"payment_pending":return i.jsx(Ac,{className:"w-4 h-4"});case"confirmed":case"processing":return i.jsx(qe,{className:"w-4 h-4"});case"shipped":return i.jsx(Ga,{className:"w-4 h-4"});case"delivered":return i.jsx(Jn,{className:"w-4 h-4"});case"cancelled":return i.jsx(ys,{className:"w-4 h-4"});default:return i.jsx(Nn,{className:"w-4 h-4"})}},w=x=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(x);return!t||!e?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(yi,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No user data"}),i.jsx("p",{className:"text-telegram-hint",children:"Please open this app from Telegram to see your profile."})]})}):p?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("button",{onClick:()=>N(!1),className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(aa,{className:"w-5 h-5 text-telegram-text rotate-180"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:"Your Orders"}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:[s.length," total orders"]})]})]}),k&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-sm",children:k}),o?i.jsx("div",{className:"space-y-3",children:[1,2,3].map(x=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 animate-pulse",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"space-y-2 flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]}),i.jsx("div",{className:"h-6 bg-gray-300 rounded w-20"})]})},x))}):s.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Vn,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No Orders Yet"}),i.jsx("p",{className:"text-telegram-hint",children:"Start shopping to see your orders here!"})]}):i.jsx("div",{className:"space-y-3",children:s.map(x=>i.jsx("div",{onClick:()=>h(x),className:"bg-telegram-secondary-bg rounded-lg p-4 cursor-pointer hover:opacity-80 transition-opacity",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("h4",{className:"font-medium text-telegram-text",children:["Order #",x.id.slice(-8)]}),i.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${L(x.status)}`,children:[R(x.status),i.jsx("span",{className:"capitalize",children:x.status.replace("_"," ")})]}),x.source==="telegram"&&i.jsx(tr,{className:"w-4 h-4 text-telegram-button"})]}),i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-telegram-hint",children:[i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(Kl,{className:"w-3 h-3"}),i.jsx("span",{children:w(x.createdAt)})]}),i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(qe,{className:"w-3 h-3"}),i.jsxs("span",{children:[x.items.length," item",x.items.length!==1?"s":""]})]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-lg font-bold text-telegram-text",children:["$",x.total.toFixed(2)]}),i.jsx(aa,{className:"w-4 h-4 text-telegram-hint ml-auto mt-1"})]})]})},x.id))}),u&&i.jsx(T2,{order:u,onClose:()=>h(null)})]}):u?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("button",{onClick:()=>h(null),className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(aa,{className:"w-5 h-5 text-telegram-text rotate-180"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:"Order Details"}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:["#",u.id.slice(-8)]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-medium text-telegram-text",children:"Order Status"}),i.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1 ${L(u.status)}`,children:[R(u.status),i.jsx("span",{className:"capitalize",children:u.status.replace("_"," ")})]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Order Date:"}),i.jsx("span",{className:"text-telegram-text",children:w(u.createdAt)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Payment Status:"}),i.jsx("span",{className:`px-2 py-1 rounded text-xs ${u.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:u.paymentStatus})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Delivery Method:"}),i.jsx("span",{className:"text-telegram-text capitalize",children:u.deliveryMethod})]}),u.trackingNumber&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Tracking:"}),i.jsx("span",{className:"text-telegram-text font-mono",children:u.trackingNumber})]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-3",children:"Items Ordered"}),i.jsx("div",{className:"space-y-3",children:u.items.map((x,_)=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-medium text-telegram-text",children:x.productName}),i.jsxs("p",{className:"text-xs text-telegram-hint",children:["$",x.price.toFixed(2)," × ",x.quantity]})]}),i.jsxs("div",{className:"text-sm font-medium text-telegram-text",children:["$",x.total.toFixed(2)]})]},_))}),i.jsxs("div",{className:"border-t border-telegram-hint/20 mt-3 pt-3 space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Subtotal:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",u.subtotal.toFixed(2)]})]}),u.tax>0&&i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Tax:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",u.tax.toFixed(2)]})]}),u.deliveryFee&&u.deliveryFee>0&&i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-telegram-hint",children:"Delivery Fee:"}),i.jsxs("span",{className:"text-telegram-text",children:["$",u.deliveryFee.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between font-medium text-telegram-text border-t border-telegram-hint/20 pt-1",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",u.total.toFixed(2)]})]})]})]}),u.customerNotes&&i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Notes"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:u.customerNotes})]}),u.deliveryAddress&&i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Delivery Address"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:u.deliveryAddress})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-6",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-16 h-16 bg-telegram-button rounded-full flex items-center justify-center",children:i.jsx(yi,{className:"w-8 h-8 text-telegram-button-text"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("h2",{className:"text-xl font-bold text-telegram-text",children:[t.firstName," ",t.lastName]}),t.username&&i.jsxs("p",{className:"text-telegram-hint",children:["@",t.username]}),i.jsx("p",{className:"text-sm text-telegram-hint",children:e.email}),i.jsxs("div",{className:"flex items-center space-x-1 mt-2",children:[i.jsx(gi,{className:"w-4 h-4 text-telegram-hint"}),i.jsx("span",{className:"text-sm text-telegram-hint",children:t.languageCode.toUpperCase()})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:b.totalOrders}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Orders"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-telegram-text",children:["$",b.totalSpent.toFixed(0)]}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Spent"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:b.pendingOrders}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Pending"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:b.completedOrders}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Completed"})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Your Orders"}),i.jsx("button",{onClick:C,disabled:o,className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded-lg disabled:opacity-50",children:i.jsx($d,{className:`w-4 h-4 ${o?"animate-spin":""}`})})]}),k&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-sm",children:k}),o?i.jsx("div",{className:"space-y-3",children:[1,2,3].map(x=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 animate-pulse",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"space-y-2 flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]}),i.jsx("div",{className:"h-6 bg-gray-300 rounded w-20"})]})},x))}):s.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Vn,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No Orders Yet"}),i.jsx("p",{className:"text-telegram-hint",children:"Start shopping to see your orders here!"})]}):i.jsx("div",{className:"space-y-3",children:s.map(x=>i.jsx("div",{onClick:()=>h(x),className:"bg-telegram-secondary-bg rounded-lg p-4 cursor-pointer hover:opacity-80 transition-opacity",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("h4",{className:"font-medium text-telegram-text",children:["Order #",x.id.slice(-8)]}),i.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${L(x.status)}`,children:[R(x.status),i.jsx("span",{className:"capitalize",children:x.status.replace("_"," ")})]})]}),i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-telegram-hint",children:[i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(Kl,{className:"w-3 h-3"}),i.jsx("span",{children:w(x.createdAt)})]}),i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(qe,{className:"w-3 h-3"}),i.jsxs("span",{children:[x.items.length," item",x.items.length!==1?"s":""]})]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-lg font-bold text-telegram-text",children:["$",x.total.toFixed(2)]}),i.jsx(aa,{className:"w-4 h-4 text-telegram-hint ml-auto mt-1"})]})]})},x.id))})]}),i.jsx("div",{className:"text-center",children:i.jsx("button",{onClick:()=>N(!0),className:"bg-telegram-button text-telegram-button-text px-6 py-3 rounded-lg font-medium hover:opacity-80 transition-opacity",children:"View All Orders"})}),i.jsxs("div",{className:"text-center text-telegram-hint text-sm",children:[i.jsx("p",{children:"Multi-Shop Mini App"}),i.jsx("p",{children:"Version 1.0.0"})]})]})},k2="modulepreload",A2=function(t){return"/"+t},Cg={},C2=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=A2(u),u in Cg)return;Cg[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":k2,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((p,N)=>{g.addEventListener("load",p),g.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},Pg={async sendPromotionMessage(t,e){try{const{botToken:n,chatId:r}=t,s=`https://api.telegram.org/bot${n}`;let a=r;if(r.startsWith("@")||!/^-?\d+$/.test(r)){const c=await new(await C2(async()=>{const{TelegramApiService:u}=await Promise.resolve().then(()=>q2);return{TelegramApiService:u}},void 0)).TelegramApiService(n).getUserIdByUsername(r);if(c)a=c.toString();else return console.error("Could not convert username to chat ID:",r),!1}if(e.images&&e.images.length>0)if(e.images.length>1){const o=e.images.map((u,h)=>({type:"photo",media:u,caption:h===0?e.text:void 0,parse_mode:e.parseMode||"HTML"}));return(await fetch(`${s}/sendMediaGroup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:a,media:o})})).ok}else return(await fetch(`${s}/sendPhoto`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:a,photo:e.images[0],caption:e.text,parse_mode:e.parseMode||"HTML",reply_markup:e.replyMarkup})})).ok;else return(await fetch(`${s}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:a,text:e.text,parse_mode:e.parseMode||"HTML",reply_markup:e.replyMarkup})})).ok}catch(n){return console.error("Error sending Telegram message:",n),!1}},async scheduleMessage(t,e,n){const r=JSON.parse(localStorage.getItem("scheduledPromotions")||"[]"),s={id:Date.now().toString(),config:t,message:e,scheduledDate:n.toISOString(),status:"scheduled"};r.push(s),localStorage.setItem("scheduledPromotions",JSON.stringify(r));const a=n.getTime()-Date.now();return a>0&&a<24*60*60*1e3&&setTimeout(async()=>{if(await this.sendPromotionMessage(t,e)){const c=JSON.parse(localStorage.getItem("scheduledPromotions")||"[]"),u=c.findIndex(h=>h.id===s.id);u!==-1&&(c[u].status="sent",localStorage.setItem("scheduledPromotions",JSON.stringify(c)))}},a),!0}},P2=({selectedShopId:t})=>{const{db:e}=js(),{user:n}=Ns(),[r,s]=V.useState([]),[a,o]=V.useState([]),[c,u]=V.useState(!0),[h,f]=V.useState(null),[g,p]=V.useState("all"),[N,k]=V.useState("all"),[T,D]=V.useState(new Set),[S,b]=V.useState(null),[I,C]=V.useState([]);V.useEffect(()=>(t&&(R(),L()),()=>{}),[t]);const L=()=>{if(!(!t||!e))try{u(!0),b(null);const O=Ie(e,"orders"),G=Re(O,be("shopId","==",t),en("createdAt","desc"));return _0(G,q=>{const X=[],ee=[];q.forEach(Q=>{var Ue,ce,vt,sn,At,ne;const B=Q.data(),Ne={id:Q.id,shopId:B.shopId||"",customerId:B.customerId||"",customerName:B.customerName||"Unknown Customer",customerPhone:B.customerPhone,customerEmail:B.customerEmail,items:B.items||[],subtotal:B.subtotal||0,tax:B.tax||0,total:B.total||0,status:B.status||"pending",paymentStatus:B.paymentStatus||"pending",deliveryMethod:B.deliveryMethod||"pickup",deliveryAddress:B.deliveryAddress,deliveryFee:B.deliveryFee,estimatedDeliveryTime:(Ue=B.estimatedDeliveryTime)==null?void 0:Ue.toDate(),paymentPreference:B.paymentPreference,paymentPhotoUrl:B.paymentPhotoUrl,requiresPaymentConfirmation:B.requiresPaymentConfirmation,customerNotes:B.customerNotes,source:B.source||"web",tableNumber:B.tableNumber,telegramId:B.telegramId,telegramUsername:B.telegramUsername,trackingNumber:B.trackingNumber,createdAt:((ce=B.createdAt)==null?void 0:ce.toDate())||new Date,updatedAt:((vt=B.updatedAt)==null?void 0:vt.toDate())||new Date,confirmedAt:(sn=B.confirmedAt)==null?void 0:sn.toDate(),shippedAt:(At=B.shippedAt)==null?void 0:At.toDate(),deliveredAt:(ne=B.deliveredAt)==null?void 0:ne.toDate()};X.push(Ne),Ne.status==="pending"&&Date.now()-Ne.createdAt.getTime()<3e4&&ee.push(Ne)}),s(X),ee.length>0&&C(Q=>[...Q,...ee]),u(!1),b(null)},q=>{console.error("Error in orders listener:",q),b("Failed to load orders. Please try again."),u(!1)})}catch(O){console.error("Error setting up orders listener:",O),b("Failed to setup orders listener. Please try again."),u(!1)}},R=async()=>{if(t)try{const O=Ie(e,"departments"),G=Re(O,be("shopId","==",t),be("isActive","==",!0)),U=await Me(G),q=[];U.forEach(X=>{var B,Ne;const ee=X.data(),Q={id:X.id,userId:ee.userId||"",shopId:ee.shopId||"",name:ee.name||"",telegramChatId:ee.telegramChatId||"",adminChatId:ee.adminChatId||"",role:ee.role||"shop",order:ee.order||0,icon:ee.icon||"👥",isActive:ee.isActive!==!1,notificationTypes:ee.notificationTypes||[],createdAt:((B=ee.createdAt)==null?void 0:B.toDate())||new Date,updatedAt:((Ne=ee.updatedAt)==null?void 0:Ne.toDate())||new Date};q.push(Q)}),o(q)}catch(O){console.error("Error loading departments:",O)}},w=async(O,G)=>{if(!T.has(O)){D(U=>new Set(U).add(O));try{const U=Ht(e,"orders",O),q={status:G,updatedAt:new Date};G==="confirmed"?q.confirmedAt=new Date:G==="processing"?q.processingAt=new Date:G==="shipped"?q.shippedAt=new Date:G==="delivered"?q.deliveredAt=new Date:G==="cancelled"&&(q.cancelledAt=new Date),await ss(U,q),s(ee=>ee.map(Q=>Q.id===O?{...Q,status:G,updatedAt:new Date}:Q)),(G==="confirmed"||G==="cancelled")&&C(ee=>ee.filter(Q=>Q.id!==O));const X=r.find(ee=>ee.id===O);X&&await x(X,G)}catch(U){console.error("Error updating order status:",U),b("Failed to update order status. Please try again.")}finally{D(U=>{const q=new Set(U);return q.delete(O),q})}}},x=async(O,G)=>{console.log(`Telegram notification: Order ${O.id} status changed to ${G}`)},_=O=>{C(G=>G.filter(U=>U.id!==O))},j={pending:{label:"Pending",color:"bg-yellow-100 text-yellow-800",icon:Nn},confirmed:{label:"Confirmed",color:"bg-blue-100 text-blue-800",icon:Jn},processing:{label:"Processing",color:"bg-purple-100 text-purple-800",icon:qe},shipped:{label:"Shipped",color:"bg-indigo-100 text-indigo-800",icon:Ga},delivered:{label:"Delivered",color:"bg-green-100 text-green-800",icon:Jn},cancelled:{label:"Cancelled",color:"bg-red-100 text-red-800",icon:ys}},E=O=>{var G;return((G=j[O])==null?void 0:G.color)||"bg-gray-100 text-gray-800"},A=O=>{var G;return((G=j[O])==null?void 0:G.icon)||E0},v=r.filter(O=>{if(g!=="all"&&O.status!==g)return!1;if(N!=="all"){const G=new Date(O.createdAt),U=new Date;switch(N){case"today":return G.toDateString()===U.toDateString();case"week":const q=new Date(U.getTime()-7*24*60*60*1e3);return G>=q;case"month":const X=new Date(U.getTime()-30*24*60*60*1e3);return G>=X}}return!0}),ae=()=>{const O=[["Order ID","Customer","Items","Total","Status","Date"].join(","),...v.map(X=>[X.id.slice(-6),X.customerName||X.customerId,X.items.map(ee=>`${ee.productName} x${ee.quantity}`).join("; "),X.total.toFixed(2),X.status,X.createdAt.toLocaleDateString()].join(","))].join(`
`),G=new Blob([O],{type:"text/csv"}),U=window.URL.createObjectURL(G),q=document.createElement("a");q.href=U,q.download=`orders-${new Date().toISOString().split("T")[0]}.csv`,q.click(),window.URL.revokeObjectURL(U)},Z=O=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(O);return c?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-8 bg-telegram-secondary-bg rounded w-1/2"}),i.jsx("div",{className:"space-y-3",children:[1,2,3].map(O=>i.jsx("div",{className:"h-20 bg-telegram-secondary-bg rounded-lg"},O))})]})}):t?i.jsxs("div",{className:"space-y-4",children:[I.length>0&&i.jsx("div",{className:"space-y-2",children:I.map(O=>i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-pulse",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(m2,{className:"w-5 h-5 text-yellow-600"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-yellow-800",children:"New Order Received!"}),i.jsxs("p",{className:"text-sm text-yellow-700",children:["Order #",O.id.slice(-6)," from ",O.customerName," - $",O.total.toFixed(2)]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>w(O.id,"confirmed"),disabled:T.has(O.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 disabled:opacity-50",children:"Confirm"}),i.jsx("button",{onClick:()=>w(O.id,"cancelled"),disabled:T.has(O.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{onClick:()=>_(O.id),className:"text-yellow-600 hover:text-yellow-800 p-1",children:i.jsx(yt,{className:"w-4 h-4"})})]})]})},O.id))}),S&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-sm",children:S}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-bold text-telegram-text",children:"Order Management"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:"Manage your shop orders"})]}),i.jsxs("button",{onClick:ae,className:"bg-telegram-button text-telegram-button-text px-3 py-2 rounded-lg text-sm flex items-center space-x-1",children:[i.jsx(f2,{className:"w-4 h-4"}),i.jsx("span",{children:"Export"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-telegram-text",children:r.length}),i.jsx("div",{className:"text-xs text-telegram-hint",children:"Total Orders"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-yellow-600",children:r.filter(O=>O.status==="pending").length}),i.jsx("div",{className:"text-xs text-telegram-hint",children:"Pending"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-600",children:r.filter(O=>["confirmed","processing"].includes(O.status)).length}),i.jsx("div",{className:"text-xs text-telegram-hint",children:"Processing"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-indigo-600",children:r.filter(O=>O.status==="shipped").length}),i.jsx("div",{className:"text-xs text-telegram-hint",children:"Shipped"})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-green-600",children:r.filter(O=>O.status==="delivered").length}),i.jsx("div",{className:"text-xs text-telegram-hint",children:"Delivered"})]})]}),i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx(x2,{className:"w-4 h-4 text-telegram-hint"}),i.jsxs("select",{value:g,onChange:O=>p(O.target.value),className:"px-2 py-1 border rounded bg-telegram-bg text-telegram-text text-sm",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"confirmed",children:"Confirmed"}),i.jsx("option",{value:"processing",children:"Processing"}),i.jsx("option",{value:"shipped",children:"Shipped"}),i.jsx("option",{value:"delivered",children:"Delivered"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsxs("select",{value:N,onChange:O=>k(O.target.value),className:"px-2 py-1 border rounded bg-telegram-bg text-telegram-text text-sm",children:[i.jsx("option",{value:"all",children:"All Time"}),i.jsx("option",{value:"today",children:"Today"}),i.jsx("option",{value:"week",children:"This Week"}),i.jsx("option",{value:"month",children:"This Month"})]}),i.jsxs("div",{className:"text-xs text-telegram-hint ml-auto",children:[v.length," of ",r.length," orders"]})]})}),i.jsx("div",{className:"space-y-3",children:v.map(O=>{const G=A(O.status),U=T.has(O.id);return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsxs("h4",{className:"font-medium text-telegram-text",children:["#",O.id.slice(-6)]}),i.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${E(O.status)}`,children:[i.jsx(G,{className:"w-3 h-3"}),i.jsx("span",{children:O.status})]}),O.source==="telegram"&&i.jsx(I0,{className:"w-4 h-4 text-telegram-button"})]}),i.jsxs("div",{className:"text-sm text-telegram-hint space-y-1",children:[i.jsxs("div",{children:["Customer: ",O.customerName||O.customerId]}),i.jsxs("div",{children:["Total: $",O.total.toFixed(2)]}),i.jsxs("div",{children:["Date: ",Z(O.createdAt)]}),i.jsxs("div",{children:["Items: ",O.items.length," item",O.items.length!==1?"s":""]})]})]}),i.jsxs("div",{className:"flex space-x-2 ml-4",children:[i.jsx("button",{onClick:()=>f(O),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded",title:"View Details",children:i.jsx(Tm,{className:"w-4 h-4"})}),O.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>w(O.id,"confirmed"),disabled:U,className:"p-2 text-green-600 hover:bg-green-600 hover:text-white rounded disabled:opacity-50",title:"Confirm Order",children:U?i.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):i.jsx(Jn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>w(O.id,"cancelled"),disabled:U,className:"p-2 text-red-600 hover:bg-red-600 hover:text-white rounded disabled:opacity-50",title:"Cancel Order",children:i.jsx(ys,{className:"w-4 h-4"})})]}),O.status==="confirmed"&&i.jsx("button",{onClick:()=>w(O.id,"processing"),disabled:U,className:"p-2 text-purple-600 hover:bg-purple-600 hover:text-white rounded disabled:opacity-50",title:"Start Processing",children:i.jsx(qe,{className:"w-4 h-4"})}),O.status==="processing"&&i.jsx("button",{onClick:()=>w(O.id,"shipped"),disabled:U,className:"p-2 text-indigo-600 hover:bg-indigo-600 hover:text-white rounded disabled:opacity-50",title:"Mark as Shipped",children:i.jsx(Ga,{className:"w-4 h-4"})}),O.status==="shipped"&&i.jsx("button",{onClick:()=>w(O.id,"delivered"),disabled:U,className:"p-2 text-green-600 hover:bg-green-600 hover:text-white rounded disabled:opacity-50",title:"Mark as Delivered",children:i.jsx(Jn,{className:"w-4 h-4"})})]})]})},O.id)})}),v.length===0&&!c&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:r.length===0?"No orders yet":"No orders match your filters"}),i.jsx("p",{className:"text-telegram-hint",children:r.length===0?"Orders will appear here once customers start placing them.":"Try adjusting your filter criteria."})]}),h&&i.jsx(R2,{order:h,onClose:()=>f(null),onUpdateStatus:w})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No Shop Selected"}),i.jsx("p",{className:"text-telegram-hint",children:"Please select a shop to view and manage orders."})]})},R2=({order:t,onClose:e,onUpdateStatus:n})=>{const r=["pending","confirmed","processing","shipped","delivered","cancelled"];return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("div",{className:"p-4 border-b border-telegram-hint/20",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-lg font-bold text-telegram-text",children:["Order #",t.id.slice(-6)]}),i.jsx("button",{onClick:e,className:"text-telegram-hint hover:text-telegram-text p-2 rounded",children:i.jsx(ys,{className:"w-6 h-6"})})]})}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Order Information"}),i.jsxs("div",{className:"space-y-1 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Customer:"}),i.jsx("span",{className:"text-telegram-text",children:t.customerName||t.customerId})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Date:"}),i.jsx("span",{className:"text-telegram-text",children:t.createdAt.toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Total:"}),i.jsxs("span",{className:"text-telegram-text font-bold",children:["$",t.total.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Delivery:"}),i.jsx("span",{className:"text-telegram-text capitalize",children:t.deliveryMethod})]}),t.source==="telegram"&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-telegram-hint",children:"Source:"}),i.jsxs("span",{className:"text-telegram-button flex items-center",children:[i.jsx(I0,{className:"w-3 h-3 mr-1"}),"Telegram"]})]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Status Management"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("select",{value:t.status,onChange:s=>n(t.id,s.target.value),className:"w-full px-3 py-2 border rounded-lg bg-telegram-bg text-telegram-text",children:r.map(s=>i.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),i.jsxs("div",{className:"text-xs text-telegram-hint",children:["Current status: ",i.jsx("span",{className:"font-medium",children:t.status})]})]})]})]}),t.deliveryAddress&&i.jsxs("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Delivery Address"}),i.jsx("p",{className:"text-sm text-telegram-text",children:t.deliveryAddress})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Order Items"}),i.jsxs("div",{className:"space-y-2",children:[t.items.map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-telegram-hint/10 last:border-b-0",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-sm font-medium text-telegram-text",children:s.productName}),i.jsxs("div",{className:"text-xs text-telegram-hint",children:["$",s.price.toFixed(2)," × ",s.quantity]})]}),i.jsxs("div",{className:"text-sm font-medium text-telegram-text",children:["$",s.total.toFixed(2)]})]},a)),i.jsxs("div",{className:"flex justify-between items-center pt-2 font-bold text-telegram-text",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",t.total.toFixed(2)]})]})]})]}),t.customerNotes&&i.jsxs("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-telegram-text mb-2",children:"Customer Notes"}),i.jsx("p",{className:"text-sm text-telegram-text",children:t.customerNotes})]})]}),i.jsx("div",{className:"p-4 border-t border-telegram-hint/20",children:i.jsx("button",{onClick:e,className:"w-full bg-telegram-button text-telegram-button-text py-3 rounded-lg font-medium",children:"Close"})})]})})},D2="f6f560dbdcf0c91aea57b3cd55097799",V2="https://api.imgbb.com/1/upload",P0=async t=>{var e;try{if(!t.type.startsWith("image/"))return{success:!1,error:"Please select a valid image file"};if(t.size>32*1024*1024)return{success:!1,error:"Image size must be less than 32MB"};const n=new FormData;n.append("key",D2),n.append("image",t);const s=await(await fetch(V2,{method:"POST",body:n})).json();return s.success?{success:!0,url:s.data.url}:{success:!1,error:((e=s.error)==null?void 0:e.message)||"Failed to upload image"}}catch(n){return console.error("Image upload error:",n),{success:!1,error:"Network error occurred while uploading image"}}},O2=async t=>{const e=Array.from(t).map(n=>P0(n));return Promise.all(e)},Rm=({value:t,onChange:e,placeholder:n="Upload image",className:r=""})=>{const[s,a]=V.useState(!1),[o,c]=V.useState(null),u=V.useRef(null),h=async p=>{var k;const N=(k=p.target.files)==null?void 0:k[0];if(N){a(!0),c(null);try{const T=await P0(N);T.success&&T.url?e(T.url):c(T.error||"Failed to upload image")}catch{c("Failed to upload image")}finally{a(!1),u.current&&(u.current.value="")}}},f=()=>{e(""),c(null)},g=()=>{var p;(p=u.current)==null||p.click()};return i.jsxs("div",{className:`space-y-2 ${r}`,children:[i.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:h,className:"hidden"}),t?i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:t,alt:"Uploaded",className:"w-full h-32 object-cover rounded-lg border"}),i.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:i.jsx(yt,{className:"w-4 h-4"})})]}):i.jsx("button",{type:"button",onClick:g,disabled:s,className:"w-full h-32 border-2 border-dashed border-telegram-hint rounded-lg flex flex-col items-center justify-center space-y-2 hover:border-telegram-button transition-colors disabled:opacity-50",children:s?i.jsxs(i.Fragment,{children:[i.jsx(xi,{className:"w-8 h-8 text-telegram-button animate-spin"}),i.jsx("span",{className:"text-sm text-telegram-hint",children:"Uploading..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(A0,{className:"w-8 h-8 text-telegram-hint"}),i.jsx("span",{className:"text-sm text-telegram-hint",children:n}),i.jsx("span",{className:"text-xs text-telegram-hint",children:"Click to upload image"})]})}),o&&i.jsxs("div",{className:"text-red-500 text-sm flex items-center space-x-1",children:[i.jsx(yt,{className:"w-4 h-4"}),i.jsx("span",{children:o})]}),i.jsx("div",{className:"text-xs text-telegram-hint",children:i.jsxs("details",{children:[i.jsx("summary",{className:"cursor-pointer hover:text-telegram-text",children:"Or enter URL manually"}),i.jsx("input",{type:"url",value:t,onChange:p=>e(p.target.value),className:"w-full mt-2 p-2 border rounded bg-telegram-secondary-bg text-telegram-text text-sm",placeholder:"https://example.com/image.jpg"})]})})]})},M2=({userId:t,onSave:e,onCancel:n})=>{const[r,s]=V.useState({name:"",slug:"",description:"",logo:"",businessInfo:{name:"",description:"",address:"",phone:"",email:"",website:""},settings:{currency:"USD",taxRate:0,businessHours:{open:"09:00",close:"18:00",days:["monday","tuesday","wednesday","thursday","friday"]},orderSettings:{autoConfirm:!1,requirePayment:!1,allowCancellation:!0}}}),[a,o]=V.useState("basic"),c=p=>{p.preventDefault();const N=r.slug||r.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");if(!r.name.trim()){alert("Shop name is required");return}if(!r.description.trim()){alert("Shop description is required");return}const k={name:r.name.trim(),slug:N,description:r.description.trim(),logo:r.logo||"",ownerId:t,isActive:!0,businessInfo:{name:r.businessInfo.name||"",description:r.businessInfo.description||"",address:r.businessInfo.address||"",phone:r.businessInfo.phone||"",email:r.businessInfo.email||"",website:r.businessInfo.website||""},settings:{currency:r.settings.currency||"USD",taxRate:r.settings.taxRate||0,businessHours:{open:r.settings.businessHours.open||"09:00",close:r.settings.businessHours.close||"18:00",days:r.settings.businessHours.days||["monday","tuesday","wednesday","thursday","friday"]},orderSettings:{autoConfirm:r.settings.orderSettings.autoConfirm||!1,requirePayment:r.settings.orderSettings.requirePayment||!1,allowCancellation:r.settings.orderSettings.allowCancellation!==!1}},stats:{totalProducts:0,totalOrders:0,totalRevenue:0,totalCustomers:0}};console.log("Creating shop with data:",k),e(k)},u=(p,N)=>{s({...r,businessInfo:{...r.businessInfo,[p]:N}})},h=(p,N)=>{s({...r,settings:{...r.settings,[p]:N}})},f=(p,N)=>{s({...r,settings:{...r.settings,businessHours:{...r.settings.businessHours,[p]:N}}})},g=(p,N)=>{s({...r,settings:{...r.settings,orderSettings:{...r.settings.orderSettings,[p]:N}}})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Create New Shop"}),i.jsx("button",{onClick:n,className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"flex space-x-1 bg-telegram-secondary-bg rounded-lg p-1 mb-6",children:[{id:"basic",label:"Basic Info",icon:$r},{id:"business",label:"Business",icon:gi},{id:"settings",label:"Settings",icon:Nn}].map(p=>i.jsxs("button",{onClick:()=>o(p.id),className:`flex items-center space-x-2 px-4 py-2 rounded-md flex-1 justify-center ${a===p.id?"bg-telegram-button text-telegram-button-text":"text-telegram-hint hover:text-telegram-text"}`,children:[i.jsx(p.icon,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:p.label})]},p.id))}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[a==="basic"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx($r,{className:"w-4 h-4 inline mr-1"}),"Shop Name *"]}),i.jsx("input",{type:"text",value:r.name,onChange:p=>s({...r,name:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",required:!0,placeholder:"Enter shop name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Shop URL Slug"}),i.jsx("input",{type:"text",value:r.slug,onChange:p=>s({...r,slug:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"my-shop (auto-generated if empty)"}),i.jsx("p",{className:"text-xs text-telegram-hint mt-1",children:"Used in URLs. Leave empty to auto-generate from shop name."})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Cc,{className:"w-4 h-4 inline mr-1"}),"Description *"]}),i.jsx("textarea",{value:r.description,onChange:p=>s({...r,description:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",rows:3,required:!0,placeholder:"Describe your shop..."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Pc,{className:"w-4 h-4 inline mr-1"}),"Shop Logo"]}),i.jsx(Rm,{value:r.logo,onChange:p=>s({...r,logo:p}),placeholder:"Upload shop logo"})]})]}),a==="business"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Business Name"}),i.jsx("input",{type:"text",value:r.businessInfo.name,onChange:p=>u("name",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Official business name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Business Description"}),i.jsx("textarea",{value:r.businessInfo.description,onChange:p=>u("description",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",rows:3,placeholder:"Detailed business description..."})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(km,{className:"w-4 h-4 inline mr-1"}),"Address"]}),i.jsx("input",{type:"text",value:r.businessInfo.address,onChange:p=>u("address",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Business address"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Am,{className:"w-4 h-4 inline mr-1"}),"Phone"]}),i.jsx("input",{type:"tel",value:r.businessInfo.phone,onChange:p=>u("phone",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Business phone"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Im,{className:"w-4 h-4 inline mr-1"}),"Email"]}),i.jsx("input",{type:"email",value:r.businessInfo.email,onChange:p=>u("email",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Business email"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(gi,{className:"w-4 h-4 inline mr-1"}),"Website"]}),i.jsx("input",{type:"url",value:r.businessInfo.website,onChange:p=>u("website",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"https://example.com"})]})]})]}),a==="settings"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"General Settings"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Currency"}),i.jsxs("select",{value:r.settings.currency,onChange:p=>h("currency",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",children:[i.jsx("option",{value:"USD",children:"USD ($)"}),i.jsx("option",{value:"EUR",children:"EUR (€)"}),i.jsx("option",{value:"ETB",children:"ETB (Br)"}),i.jsx("option",{value:"GBP",children:"GBP (£)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Tax Rate (%)"}),i.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:r.settings.taxRate,onChange:p=>h("taxRate",parseFloat(p.target.value)||0),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Business Hours"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Opening Time"}),i.jsx("input",{type:"time",value:r.settings.businessHours.open,onChange:p=>f("open",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Closing Time"}),i.jsx("input",{type:"time",value:r.settings.businessHours.close,onChange:p=>f("close",p.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Operating Days"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{value:"monday",label:"Mon"},{value:"tuesday",label:"Tue"},{value:"wednesday",label:"Wed"},{value:"thursday",label:"Thu"},{value:"friday",label:"Fri"},{value:"saturday",label:"Sat"},{value:"sunday",label:"Sun"}].map(p=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:r.settings.businessHours.days.includes(p.value),onChange:N=>{const k=N.target.checked?[...r.settings.businessHours.days,p.value]:r.settings.businessHours.days.filter(T=>T!==p.value);f("days",k)},className:"rounded"}),i.jsx("span",{className:"text-sm text-telegram-text",children:p.label})]},p.value))})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Order Settings"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:r.settings.orderSettings.autoConfirm,onChange:p=>g("autoConfirm",p.target.checked),className:"rounded"}),i.jsx("span",{className:"text-sm text-telegram-text",children:"Auto-confirm orders"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:r.settings.orderSettings.requirePayment,onChange:p=>g("requirePayment",p.target.checked),className:"rounded"}),i.jsx("span",{className:"text-sm text-telegram-text",children:"Require payment before processing"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:r.settings.orderSettings.allowCancellation,onChange:p=>g("allowCancellation",p.target.checked),className:"rounded"}),i.jsx("span",{className:"text-sm text-telegram-text",children:"Allow order cancellation"})]})]})]})]}),i.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[i.jsxs("button",{type:"submit",className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg flex items-center justify-center space-x-2 font-medium",children:[i.jsx(Es,{className:"w-4 h-4"}),i.jsx("span",{children:"Create Shop"})]}),i.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 border border-telegram-hint text-telegram-hint rounded-lg font-medium",children:"Cancel"})]})]})]})})},F2=({product:t,onEdit:e,onDelete:n,onPromote:r})=>{const s=t.stock<=t.lowStockAlert;return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[t.images&&t.images[0]?i.jsx("img",{src:t.images[0],alt:t.name,className:"w-16 h-16 rounded-lg object-cover"}):i.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center",children:i.jsx(qe,{className:"w-8 h-8 text-telegram-hint"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:t.name}),t.featured&&i.jsx(Ka,{className:"w-4 h-4 text-yellow-500 fill-current"}),s&&i.jsx(h2,{className:"w-4 h-4 text-red-500"})]}),i.jsx("p",{className:"text-sm text-telegram-hint mt-1 line-clamp-2",children:t.description}),t.sku&&i.jsxs("p",{className:"text-xs text-telegram-hint mt-1",children:["SKU: ",t.sku]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("span",{className:"text-lg font-bold text-telegram-button",children:["$",t.price.toFixed(2)]}),t.costPrice&&i.jsxs("span",{className:"text-sm text-telegram-hint",children:["Cost: $",t.costPrice.toFixed(2)]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${t.stock>t.lowStockAlert?"bg-green-100 text-green-800":t.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:["Stock: ",t.stock]}),i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.isActive?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:t.isActive?"Active":"Inactive"})]})]}),t.tags&&t.tags.length>0&&i.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[t.tags.slice(0,3).map((a,o)=>i.jsx("span",{className:"text-xs bg-telegram-button bg-opacity-10 text-telegram-button px-2 py-1 rounded",children:a},o)),t.tags.length>3&&i.jsxs("span",{className:"text-xs text-telegram-hint",children:["+",t.tags.length-3," more"]})]})]}),i.jsxs("div",{className:"flex space-x-2 ml-4",children:[r&&i.jsx("button",{onClick:()=>r(t),className:"p-2 text-green-600 hover:bg-green-600 hover:text-white rounded",title:"Promote Product",children:i.jsx(v2,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>e(t),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded",children:i.jsx(S0,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>n(t.id),className:"p-2 text-red-500 hover:bg-red-500 hover:text-white rounded",children:i.jsx(co,{className:"w-4 h-4"})})]})]})})},L2=({value:t,onChange:e,maxImages:n=5,className:r=""})=>{const[s,a]=V.useState(!1),[o,c]=V.useState(null),u=V.useRef(null),h=async N=>{const k=N.target.files;if(!(!k||k.length===0)){if(t.length+k.length>n){c(`Maximum ${n} images allowed`);return}a(!0),c(null);try{const T=await O2(k),D=T.filter(b=>b.success&&b.url).map(b=>b.url),S=T.filter(b=>!b.success);D.length>0&&e([...t,...D]),S.length>0&&c(`${S.length} image(s) failed to upload`)}catch{c("Failed to upload images")}finally{a(!1),u.current&&(u.current.value="")}}},f=N=>{const k=t.filter((T,D)=>D!==N);e(k),c(null)},g=()=>{var N;(N=u.current)==null||N.click()},p=N=>{N.trim()&&t.length<n&&e([...t,N.trim()])};return i.jsxs("div",{className:`space-y-3 ${r}`,children:[i.jsx("input",{ref:u,type:"file",accept:"image/*",multiple:!0,onChange:h,className:"hidden"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[t.map((N,k)=>i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:N,alt:`Product image ${k+1}`,className:"w-full h-24 object-cover rounded-lg border"}),i.jsx("button",{type:"button",onClick:()=>f(k),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(yt,{className:"w-3 h-3"})}),i.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1 rounded",children:k+1})]},k)),t.length<n&&i.jsx("button",{type:"button",onClick:g,disabled:s,className:"w-full h-24 border-2 border-dashed border-telegram-hint rounded-lg flex flex-col items-center justify-center space-y-1 hover:border-telegram-button transition-colors disabled:opacity-50",children:s?i.jsxs(i.Fragment,{children:[i.jsx(xi,{className:"w-5 h-5 text-telegram-button animate-spin"}),i.jsx("span",{className:"text-xs text-telegram-hint",children:"Uploading..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(yn,{className:"w-5 h-5 text-telegram-hint"}),i.jsx("span",{className:"text-xs text-telegram-hint",children:"Add Image"})]})})]}),o&&i.jsxs("div",{className:"text-red-500 text-sm flex items-center space-x-1",children:[i.jsx(yt,{className:"w-4 h-4"}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"text-xs text-telegram-hint",children:[t.length," / ",n," images • Click to upload or drag and drop"]}),i.jsx("div",{className:"text-xs text-telegram-hint",children:i.jsxs("details",{children:[i.jsx("summary",{className:"cursor-pointer hover:text-telegram-text",children:"Or add image URL manually"}),i.jsxs("div",{className:"mt-2 flex space-x-2",children:[i.jsx("input",{type:"url",className:"flex-1 p-2 border rounded bg-telegram-secondary-bg text-telegram-text text-sm",placeholder:"https://example.com/image.jpg",onKeyPress:N=>{if(N.key==="Enter"){N.preventDefault();const k=N.target;p(k.value),k.value=""}}}),i.jsx("button",{type:"button",onClick:N=>{const k=N.target.previousElementSibling;p(k.value),k.value=""},className:"px-3 py-2 bg-telegram-button text-telegram-button-text rounded text-sm",children:"Add"})]})]})})]})},U2=({product:t,shopId:e,categories:n,onSave:r,onCancel:s})=>{const[a,o]=V.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",price:(t==null?void 0:t.price)||0,stock:(t==null?void 0:t.stock)||0,category:(t==null?void 0:t.category)||"",subcategory:(t==null?void 0:t.subcategory)||"",images:(t==null?void 0:t.images)||[""],sku:(t==null?void 0:t.sku)||"",isActive:(t==null?void 0:t.isActive)??!0,lowStockAlert:(t==null?void 0:t.lowStockAlert)||5,tags:(t==null?void 0:t.tags)||[],featured:(t==null?void 0:t.featured)||!1,costPrice:(t==null?void 0:t.costPrice)||0,weight:(t==null?void 0:t.weight)||0,dimensions:(t==null?void 0:t.dimensions)||{length:0,width:0,height:0},shopId:e}),[c,u]=V.useState(""),h=p=>{p.preventDefault();const N=a.images.filter(T=>T.trim()!==""),k={...a,images:N.length>0?N:[""]};r(t?{...t,...k}:k)},f=()=>{c.trim()&&!a.tags.includes(c.trim())&&(o({...a,tags:[...a.tags,c.trim()]}),u(""))},g=p=>{o({...a,tags:a.tags.filter(N=>N!==p)})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:t?"Edit Product":"Add Product"}),i.jsx("button",{onClick:s,className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(qe,{className:"w-4 h-4 inline mr-1"}),"Product Name *"]}),i.jsx("input",{type:"text",value:a.name,onChange:p=>o({...a,name:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"SKU"}),i.jsx("input",{type:"text",value:a.sku,onChange:p=>o({...a,sku:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"Product SKU"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Cc,{className:"w-4 h-4 inline mr-1"}),"Description"]}),i.jsx("textarea",{value:a.description,onChange:p=>o({...a,description:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",rows:3,placeholder:"Product description..."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Pricing & Inventory"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Ac,{className:"w-4 h-4 inline mr-1"}),"Price *"]}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.price,onChange:p=>o({...a,price:parseFloat(p.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Cost Price"}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.costPrice,onChange:p=>o({...a,costPrice:parseFloat(p.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Stock *"}),i.jsx("input",{type:"number",min:"0",value:a.stock,onChange:p=>o({...a,stock:parseInt(p.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Low Stock Alert"}),i.jsx("input",{type:"number",min:"0",value:a.lowStockAlert,onChange:p=>o({...a,lowStockAlert:parseInt(p.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Categories"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Category"}),i.jsxs("select",{value:a.category,onChange:p=>o({...a,category:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",children:[i.jsx("option",{value:"",children:"Select Category"}),n.map(p=>i.jsx("option",{value:p.name,children:p.name},p.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Subcategory"}),i.jsx("input",{type:"text",value:a.subcategory,onChange:p=>o({...a,subcategory:p.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"Optional subcategory"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-telegram-text border-b pb-2",children:[i.jsx(Pc,{className:"w-4 h-4 inline mr-1"}),"Product Images"]}),i.jsx(L2,{value:a.images.filter(p=>p.trim()!==""),onChange:p=>o({...a,images:p}),maxImages:5})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-telegram-text border-b pb-2",children:[i.jsx(Gl,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.tags.map((p,N)=>i.jsxs("span",{className:"bg-telegram-button bg-opacity-10 text-telegram-button px-3 py-1 rounded-full text-sm flex items-center space-x-1",children:[i.jsx("span",{children:p}),i.jsx("button",{type:"button",onClick:()=>g(p),className:"text-telegram-button hover:text-red-500",children:i.jsx(yt,{className:"w-3 h-3"})})]},N))}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("input",{type:"text",value:c,onChange:p=>u(p.target.value),onKeyPress:p=>p.key==="Enter"&&(p.preventDefault(),f()),className:"flex-1 p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"Add a tag..."}),i.jsx("button",{type:"button",onClick:f,className:"px-4 py-3 bg-telegram-button text-telegram-button-text rounded-lg",children:"Add"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Physical Properties"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Weight (kg)"}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.weight,onChange:p=>o({...a,weight:parseFloat(p.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Length (cm)"}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.dimensions.length,onChange:p=>o({...a,dimensions:{...a.dimensions,length:parseFloat(p.target.value)||0}}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Width (cm)"}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.dimensions.width,onChange:p=>o({...a,dimensions:{...a.dimensions,width:parseFloat(p.target.value)||0}}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Height (cm)"}),i.jsx("input",{type:"number",min:"0",step:"0.01",value:a.dimensions.height,onChange:p=>o({...a,dimensions:{...a.dimensions,height:parseFloat(p.target.value)||0}}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Status"}),i.jsxs("div",{className:"flex items-center space-x-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"isActive",checked:a.isActive,onChange:p=>o({...a,isActive:p.target.checked}),className:"mr-2"}),i.jsx("label",{htmlFor:"isActive",className:"text-sm text-telegram-text",children:"Product is active"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"featured",checked:a.featured,onChange:p=>o({...a,featured:p.target.checked}),className:"mr-2"}),i.jsx("label",{htmlFor:"featured",className:"text-sm text-telegram-text",children:"Featured product"})]})]})]}),i.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[i.jsxs("button",{type:"submit",className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg flex items-center justify-center space-x-2",children:[i.jsx(Es,{className:"w-4 h-4"}),i.jsxs("span",{children:[t?"Update":"Add"," Product"]})]}),i.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-telegram-hint text-telegram-hint rounded-lg",children:"Cancel"})]})]})]})})},$2="f6f560dbdcf0c91aea57b3cd55097799",B2="https://api.imgbb.com/1/upload",z2={async uploadImage(t,e){var n;try{if(!t.type.startsWith("image/"))throw new Error("Please select a valid image file");if(t.size>32*1024*1024)throw new Error("Image size must be less than 32MB");const r=new FormData;r.append("key",$2),r.append("image",t),e&&r.append("name",e);const a=await(await fetch(B2,{method:"POST",body:r})).json();if(a.success)return a.data.url;throw new Error(((n=a.error)==null?void 0:n.message)||"Failed to upload image")}catch(r){throw console.error("Image upload error:",r),r}},async uploadMultipleImages(t,e){const n=Array.from(t).map((r,s)=>this.uploadImage(r,e?`${e}-${s+1}`:void 0));return Promise.all(n)}};class Dm{constructor(e){Rt(this,"botToken");this.botToken=e}get baseUrl(){return`https://api.telegram.org/bot${this.botToken}`}async getUserIdByUsername(e){try{const n=e.replace("@",""),s=await(await fetch(`${this.baseUrl}/getChat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:`@${n}`})})).json();return s.ok&&s.result?s.result.id:null}catch(n){return console.error("Error getting user ID by username:",n),null}}async getChatById(e){try{const r=await(await fetch(`${this.baseUrl}/getChat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:e})})).json();return r.ok&&r.result?r.result:null}catch(n){return console.error("Error getting chat by ID:",n),null}}async validateChatId(e){return await this.getChatById(e)!==null}async testChatAccess(e){try{return(await(await fetch(`${this.baseUrl}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:e,text:"🤖 Bot connection test - This message confirms the bot can send messages to this chat.",disable_notification:!0})})).json()).ok}catch(n){return console.error("Error testing chat access:",n),!1}}}const Vs={getInputType(t){const e=t.trim();return/^-?\d+$/.test(e)?"chatId":/^@?[a-zA-Z0-9_]{5,32}$/.test(e)?"username":"invalid"},cleanUsername(t){const e=t.trim().replace("@","");return/^[a-zA-Z0-9_]{5,32}$/.test(e)?e:null},parseChatId(t){const e=t.trim(),n=parseInt(e,10);return!isNaN(n)&&n.toString()===e?n:null},formatChatId(t){return t.toString()},getChatTypeDescription(t){return t>0?"Private Chat":t>-1e12?"Group Chat":"Supergroup/Channel"}},q2=Object.freeze(Object.defineProperty({__proto__:null,TelegramApiService:Dm,telegramUtils:Vs},Symbol.toStringTag,{value:"Module"})),Bd=({value:t,onChange:e,label:n="Telegram Chat",placeholder:r="Enter @username or chat ID",required:s=!1,botToken:a,showValidation:o=!0,className:c=""})=>{const[u,h]=V.useState(""),[f,g]=V.useState(!1),[p,N]=V.useState("idle"),[k,T]=V.useState(""),[D,S]=V.useState(null);V.useEffect(()=>{t&&!u&&h(t)},[t]);const b=async R=>{if(!R.trim()){N("idle"),T(""),S(null);return}if(!a){N("error"),T("Bot token not configured");return}g(!0),N("idle");try{const w=new Dm(a),x=Vs.getInputType(R);if(x==="invalid"){N("invalid"),T("Invalid format. Use @username or numeric chat ID"),S(null);return}let _=null;if(x==="username"){const j=Vs.cleanUsername(R);if(j&&(_=await w.getUserIdByUsername(j),!_)){N("invalid"),T("Username not found or not accessible"),S(null);return}}else x==="chatId"&&(_=Vs.parseChatId(R));if(_){const j=await w.getChatById(_);j?(N("valid"),T(`✓ ${j.title||j.username||"Chat"} (${Vs.getChatTypeDescription(_)})`),S(j),e(_.toString())):(N("invalid"),T("Chat not found or bot has no access"),S(null))}}catch(w){console.error("Validation error:",w),N("error"),T("Error validating chat. Please try again."),S(null)}finally{g(!1)}},I=R=>{const w=R.target.value;h(w);const x=setTimeout(()=>{o?b(w):e(w)},500);return()=>clearTimeout(x)},C=()=>f?i.jsx(xi,{className:"w-4 h-4 animate-spin text-blue-500"}):p==="valid"?i.jsx(Ag,{className:"w-4 h-4 text-green-500"}):p==="invalid"?i.jsx(yt,{className:"w-4 h-4 text-red-500"}):p==="error"?i.jsx(E0,{className:"w-4 h-4 text-red-500"}):i.jsx(tr,{className:"w-4 h-4 text-telegram-hint"}),L=()=>p==="valid"?"border-green-500 focus:border-green-500":p==="invalid"||p==="error"?"border-red-500 focus:border-red-500":"border-telegram-hint/30 focus:border-telegram-button";return i.jsxs("div",{className:`space-y-2 ${c}`,children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text",children:[i.jsx(tr,{className:"w-4 h-4 inline mr-1"}),n,s&&i.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:u,onChange:I,className:`w-full pl-3 pr-10 py-2 border rounded-lg bg-telegram-secondary-bg text-telegram-text focus:outline-none transition-colors ${L()}`,placeholder:r,required:s}),i.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:C()})]}),k&&i.jsx("div",{className:`text-sm flex items-start space-x-1 ${p==="valid"?"text-green-600":p==="invalid"||p==="error"?"text-red-600":"text-telegram-hint"}`,children:i.jsx("span",{children:k})}),D&&p==="valid"&&i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[i.jsx(Ag,{className:"w-4 h-4 text-green-500"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-green-800",children:D.title||D.username||"Chat Verified"}),i.jsxs("div",{className:"text-green-600",children:["ID: ",D.id," • Type: ",Vs.getChatTypeDescription(D.id)]}),D.username&&i.jsxs("div",{className:"text-green-600",children:["Username: @",D.username]})]})]})}),i.jsxs("div",{className:"text-xs text-telegram-hint flex items-start space-x-1",children:[i.jsx(T0,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{children:"You can enter:"}),i.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Username:"})," @username or username"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Chat ID:"})," Numeric ID (positive for users, negative for groups)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Group/Channel:"})," Add the bot as admin first"]})]})]})]})]})},H2=({product:t,departments:e,botToken:n,onClose:r,onPromote:s})=>{const{webApp:a}=Ns(),[o,c]=V.useState(""),[u,h]=V.useState(`🔥 Special Offer: ${t.name}`),[f,g]=V.useState(0),[p,N]=V.useState(""),[k,T]=V.useState(["#special","#offer"]),[D,S]=V.useState(""),[b,I]=V.useState([]),[C,L]=V.useState(!1),[R,w]=V.useState(!1),[x,_]=V.useState(""),[j,E]=V.useState(""),[A,v]=V.useState(!1),[ae,Z]=V.useState(!1),[O,G]=V.useState([]),[U,q]=V.useState(null),[X,ee]=V.useState(""),[Q,B]=V.useState("");Wd.useEffect(()=>{B(n||"7141155447:AAGU2K74kX3ICzSIPB566tly3LUDo423JrU")},[n]);const Ne=async ne=>{const ye=ne.target.files;if(!(!ye||ye.length===0)){L(!0),q(null);try{const Ke=Array.from(ye).map(Bt=>z2.uploadImage(Bt,`promotion-${t.name}-${Date.now()}`)),wt=await Promise.all(Ke);I(Bt=>[...Bt,...wt]),a!=null&&a.showAlert&&a.showAlert("Images uploaded successfully!")}catch(Ke){console.error("Error uploading images:",Ke),q("Failed to upload images. Please try again."),a!=null&&a.showAlert&&a.showAlert("Failed to upload images. Please try again.")}finally{L(!1)}}},Je=ne=>{I(ye=>ye.filter((Ke,wt)=>wt!==ne))},Ue=()=>{if(D.trim()&&!k.includes(D.trim())){const ne=D.trim().startsWith("#")?D.trim():`#${D.trim()}`;T(ye=>[...ye,ne]),S("")}},ce=ne=>{T(ye=>ye.filter((Ke,wt)=>wt!==ne))},vt=ne=>{G(ye=>ye.includes(ne)?ye.filter(Ke=>Ke!==ne):[...ye,ne])},sn=async()=>{v(!0),q(null);try{const ne={product:t,customMessage:o.trim(),promotionImages:b,promotionTitle:u.trim(),discountPercentage:f>0?f:void 0,validUntil:p?new Date(p):void 0,tags:k,isScheduled:R,scheduledDate:R&&x&&j?new Date(`${x}T${j}`):void 0,selectedDepartments:O};await s(ne),a!=null&&a.showAlert&&a.showAlert(R?"Promotion scheduled successfully!":"Promotion sent successfully!"),r()}catch(ne){console.error("Error promoting product:",ne),q("Failed to promote product. Please try again."),a!=null&&a.showAlert&&a.showAlert("Failed to promote product. Please try again.")}finally{v(!1)}},At=()=>{const ne=f>0?`
💥 <b>${f}% OFF!</b>`:"",ye=f>0?`
~~$${t.price.toFixed(2)}~~ `:"",Ke=f>0?`<b>$${(t.price*(1-f/100)).toFixed(2)}</b>`:`<b>$${t.price.toFixed(2)}</b>`,wt=p?`
⏰ <b>Valid until:</b> ${new Date(p).toLocaleDateString()}`:"",Bt=k.length>0?`

${k.join(" ")}`:"";return`
🔥 <b>${u}</b>${ne}

🛍️ <b>${t.name}</b>

${o||t.description}

💰 <b>Price:</b> ${ye}${Ke}
📦 <b>Available:</b> ${t.stock} in stock
${t.sku?`🏷️ <b>SKU:</b> ${t.sku}`:""}${wt}

🛒 <b>Order Now!</b> Don't miss this amazing deal!${Bt}

<i>🚀 Limited time offer - Order today!</i>
    `.trim()};return ae?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("div",{className:"p-4 border-b border-telegram-hint/20",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-lg font-bold text-telegram-text",children:"Promotion Preview"}),i.jsx("button",{onClick:()=>Z(!1),className:"text-telegram-hint hover:text-telegram-text",children:i.jsx(yt,{className:"w-6 h-6"})})]})}),i.jsxs("div",{className:"p-4",children:[(b.length>0||t.images.length>0)&&i.jsx("div",{className:"mb-4",children:i.jsx("img",{src:b[0]||t.images[0],alt:t.name,className:"w-full h-48 object-cover rounded-lg border border-telegram-hint/20"})}),i.jsx("div",{className:"bg-telegram-secondary-bg p-4 rounded-lg border border-telegram-hint/20",children:i.jsx("div",{className:"text-sm whitespace-pre-line text-telegram-text",dangerouslySetInnerHTML:{__html:At().replace(/<b>/g,"<strong>").replace(/<\/b>/g,"</strong>").replace(/<i>/g,"<em>").replace(/<\/i>/g,"</em>").replace(/~~(.+?)~~/g,"<del>$1</del>")}})}),O.length>0&&i.jsxs("div",{className:"mt-4 p-3 bg-telegram-button bg-opacity-10 border border-telegram-button/20 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-telegram-text font-medium mb-2",children:[i.jsx(tr,{className:"w-4 h-4 inline mr-1"}),"Will be sent to:"]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:O.map(ne=>{const ye=e.find(Ke=>Ke.id===ne);return ye?i.jsxs("span",{className:"text-xs bg-telegram-button text-telegram-button-text px-2 py-1 rounded-full",children:[ye.icon," ",ye.name]},ne):null})})]}),R&&x&&j&&i.jsx("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx(Nn,{className:"w-4 h-4 inline mr-1"}),"Scheduled for: ",new Date(`${x}T${j}`).toLocaleString()]})})]}),i.jsx("div",{className:"p-4 border-t border-telegram-hint/20 bg-telegram-secondary-bg",children:i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>Z(!1),className:"flex-1 bg-telegram-hint text-white py-3 rounded-lg font-medium hover:opacity-80 transition-opacity",children:"Edit"}),i.jsx("button",{onClick:sn,disabled:A,className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg font-medium hover:opacity-80 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:A?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-telegram-button-text border-t-transparent rounded-full animate-spin"}),R?"Scheduling...":"Promoting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(_2,{className:"w-4 h-4"}),R?"Schedule Promotion":"Promote Now"]})})]})})]})}):i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"p-4 border-b border-telegram-hint/20",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-lg font-bold text-telegram-text",children:"Promote Product"}),i.jsx("button",{onClick:r,className:"text-telegram-hint hover:text-telegram-text",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsxs("p",{className:"text-telegram-hint text-sm mt-1",children:["Create an engaging promotion for ",t.name]})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[U&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-3 py-2 rounded-lg text-sm",children:U}),i.jsx("div",{className:"bg-telegram-secondary-bg p-3 rounded-lg",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[t.images&&t.images.length>0?i.jsx("img",{src:t.images[0],alt:t.name,className:"w-12 h-12 object-cover rounded-lg"}):i.jsx("div",{className:"w-12 h-12 bg-telegram-hint/20 rounded-lg flex items-center justify-center",children:i.jsx(Pc,{className:"w-6 h-6 text-telegram-hint"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-telegram-text",children:t.name}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:["$",t.price.toFixed(2)," • ",t.stock," in stock"]}),i.jsx("p",{className:"text-xs text-telegram-hint",children:t.category})]})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Promotion Title *"}),i.jsx("input",{type:"text",value:u,onChange:ne=>h(ne.target.value),className:"w-full px-3 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"🔥 Special Offer: Amazing Product"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Discount Percentage (Optional)"}),i.jsx("input",{type:"number",min:"0",max:"100",value:f,onChange:ne=>g(parseInt(ne.target.value)||0),className:"w-full px-3 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Valid Until (Optional)"}),i.jsx("input",{type:"date",value:p,onChange:ne=>N(ne.target.value),className:"w-full px-3 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Custom Message (Optional)"}),i.jsx("textarea",{value:o,onChange:ne=>c(ne.target.value),rows:3,className:"w-full px-3 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Add a custom message to make your promotion more engaging..."}),i.jsx("p",{className:"text-xs text-telegram-hint mt-1",children:"Leave empty to use the product description"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Promotion Images (Optional)"}),i.jsxs("div",{className:"border-2 border-dashed border-telegram-hint/30 rounded-lg p-4 text-center hover:border-telegram-button/50 transition-colors",children:[i.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:Ne,className:"hidden",id:"promotion-image-upload",disabled:C}),i.jsxs("label",{htmlFor:"promotion-image-upload",className:"cursor-pointer flex flex-col items-center space-y-2",children:[C?i.jsx("div",{className:"w-6 h-6 border-2 border-telegram-button border-t-transparent rounded-full animate-spin"}):i.jsx(A0,{className:"h-6 w-6 text-telegram-hint"}),i.jsx("span",{className:"text-sm text-telegram-text",children:C?"Uploading images...":"Click to upload promotion images"}),i.jsx("span",{className:"text-xs text-telegram-hint",children:"PNG, JPG, GIF up to 32MB each"})]})]}),b.length>0&&i.jsx("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-3",children:b.map((ne,ye)=>i.jsxs("div",{className:"relative group",children:[i.jsx("img",{src:ne,alt:`Promotion ${ye+1}`,className:"w-full h-20 object-cover rounded-lg border border-telegram-hint/20"}),i.jsx("button",{type:"button",onClick:()=>Je(ye),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(co,{className:"h-3 w-3"})})]},ye))}),i.jsx("p",{className:"text-xs text-telegram-hint mt-2",children:"If no promotion images are uploaded, the product's main image will be used"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Hashtags"}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:k.map((ne,ye)=>i.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-telegram-button bg-opacity-10 text-telegram-button rounded-full text-sm",children:[ne,i.jsx("button",{onClick:()=>ce(ye),className:"ml-1 text-telegram-button hover:text-red-500",children:i.jsx(yt,{className:"w-3 h-3"})})]},ye))}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("input",{type:"text",value:D,onChange:ne=>S(ne.target.value),onKeyPress:ne=>ne.key==="Enter"&&Ue(),className:"flex-1 px-3 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-secondary-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"Add hashtag (e.g., special, offer)"}),i.jsx("button",{onClick:Ue,className:"px-3 py-2 bg-telegram-button text-telegram-button-text rounded-lg hover:opacity-80 transition-opacity",children:"Add"})]})]}),e.length>0&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:[i.jsx(tr,{className:"w-4 h-4 inline mr-1"}),"Send to Departments (Optional)"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:e.filter(ne=>ne.isActive).map(ne=>i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",id:`dept-${ne.id}`,checked:O.includes(ne.id),onChange:()=>vt(ne.id),className:"rounded border-telegram-hint/30"}),i.jsxs("label",{htmlFor:`dept-${ne.id}`,className:"text-sm text-telegram-text flex items-center space-x-1",children:[i.jsx("span",{children:ne.icon}),i.jsx("span",{children:ne.name})]})]},ne.id))}),i.jsx("p",{className:"text-xs text-telegram-hint mt-1",children:"Select departments to send the promotion to their Telegram chats"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:[i.jsx(tr,{className:"w-4 h-4 inline mr-1"}),"Additional Recipient (Optional)"]}),i.jsx(Bd,{value:X,onChange:ee,placeholder:"Enter @username or chat ID for additional recipient",botToken:Q,showValidation:!0}),i.jsx("p",{className:"text-xs text-telegram-hint mt-1",children:"Send promotion to an additional chat besides selected departments"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[i.jsx("input",{type:"checkbox",id:"schedule-promotion",checked:R,onChange:ne=>w(ne.target.checked),className:"rounded border-telegram-hint/30"}),i.jsx("label",{htmlFor:"schedule-promotion",className:"text-sm font-medium text-telegram-text",children:"Schedule promotion for later"})]}),R&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 p-3 bg-telegram-button bg-opacity-10 rounded-lg border border-telegram-button/20",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Kl,{className:"w-4 h-4 inline mr-1"}),"Date"]}),i.jsx("input",{type:"date",value:x,onChange:ne=>_(ne.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-telegram-button/30 rounded-lg bg-telegram-bg text-telegram-text focus:border-telegram-button focus:outline-none",required:R})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Nn,{className:"w-4 h-4 inline mr-1"}),"Time"]}),i.jsx("input",{type:"time",value:j,onChange:ne=>E(ne.target.value),className:"w-full px-3 py-2 border border-telegram-button/30 rounded-lg bg-telegram-bg text-telegram-text focus:border-telegram-button focus:outline-none",required:R})]})]})]})]}),i.jsx("div",{className:"p-4 border-t border-telegram-hint/20 bg-telegram-secondary-bg",children:i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:r,className:"flex-1 bg-telegram-hint text-white py-3 rounded-lg font-medium hover:opacity-80 transition-opacity",children:"Cancel"}),i.jsxs("button",{onClick:()=>Z(!0),className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg font-medium hover:opacity-80 transition-opacity flex items-center justify-center gap-2",children:[i.jsx(Tm,{className:"w-4 h-4"}),"Preview"]})]})})]})})},Q2=({category:t,onEdit:e,onDelete:n})=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[i.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-xl",style:{backgroundColor:t.color+"20",color:t.color},children:t.icon}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:t.name}),t.description&&i.jsx("p",{className:"text-sm text-telegram-hint mt-1",children:t.description}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[i.jsxs("span",{className:"text-sm text-telegram-hint",children:[t.productCount||0," products"]}),i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})]})]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>e(t),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded",children:i.jsx(k0,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>n(t.id),className:"p-2 text-red-500 hover:bg-red-500 hover:text-white rounded",children:i.jsx(co,{className:"w-4 h-4"})})]})]})}),W2=({category:t,userId:e,shopId:n,onSave:r,onCancel:s})=>{const[a,o]=V.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",image:(t==null?void 0:t.image)||"",color:(t==null?void 0:t.color)||"#3B82F6",icon:(t==null?void 0:t.icon)||"📦",order:(t==null?void 0:t.order)||0,isActive:(t==null?void 0:t.isActive)??!0,userId:e,shopId:n}),c=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1","#14B8A6","#F43F5E"],u=["📦","🍕","🍔","☕","🥗","🍰","👕","📱","💻","🎮","📚","🏠","🚗","⚽","🎵","🎨"],h=f=>{f.preventDefault(),r(t?{...t,...a}:a)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:t?"Edit Category":"Add Category"}),i.jsx("button",{onClick:s,className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Gl,{className:"w-4 h-4 inline mr-1"}),"Category Name *"]}),i.jsx("input",{type:"text",value:a.name,onChange:f=>o({...a,name:f.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0,placeholder:"Enter category name"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Cc,{className:"w-4 h-4 inline mr-1"}),"Description"]}),i.jsx("textarea",{value:a.description,onChange:f=>o({...a,description:f.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",rows:3,placeholder:"Optional category description"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Category Image (Optional)"}),i.jsx(Rm,{value:a.image,onChange:f=>o({...a,image:f}),placeholder:"Upload category image"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Display Order"}),i.jsx("input",{type:"number",min:"0",value:a.order,onChange:f=>o({...a,order:parseInt(f.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"0"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Visual Settings"}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:[i.jsx(w2,{className:"w-4 h-4 inline mr-1"}),"Category Color"]}),i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsx("input",{type:"color",value:a.color,onChange:f=>o({...a,color:f.target.value}),className:"w-12 h-12 rounded border"}),i.jsx("input",{type:"text",value:a.color,onChange:f=>o({...a,color:f.target.value}),className:"flex-1 p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"#3B82F6"})]}),i.jsx("div",{className:"grid grid-cols-6 gap-2",children:c.map(f=>i.jsx("button",{type:"button",onClick:()=>o({...a,color:f}),className:`w-10 h-10 rounded border-2 ${a.color===f?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:f}},f))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Category Icon"}),i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl border",style:{backgroundColor:a.color+"20",color:a.color},children:a.icon}),i.jsx("input",{type:"text",value:a.icon,onChange:f=>o({...a,icon:f.target.value}),className:"flex-1 p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"📦"})]}),i.jsx("div",{className:"grid grid-cols-8 gap-2",children:u.map(f=>i.jsx("button",{type:"button",onClick:()=>o({...a,icon:f}),className:`w-10 h-10 rounded border text-xl flex items-center justify-center ${a.icon===f?"border-telegram-button bg-telegram-button bg-opacity-10":"border-gray-300 hover:border-telegram-button"}`,children:f},f))})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Status"}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"isActive",checked:a.isActive,onChange:f=>o({...a,isActive:f.target.checked}),className:"mr-2"}),i.jsx("label",{htmlFor:"isActive",className:"text-sm text-telegram-text",children:"Category is active"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Preview"}),i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[a.image?i.jsx("img",{src:a.image,alt:a.name||"Category",className:"w-12 h-12 rounded-lg object-cover"}):i.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-xl",style:{backgroundColor:a.color+"20",color:a.color},children:a.icon}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:a.name||"Category Name"}),a.description&&i.jsx("p",{className:"text-sm text-telegram-hint mt-1",children:a.description})]})]})})]}),i.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[i.jsxs("button",{type:"submit",className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg flex items-center justify-center space-x-2",children:[i.jsx(Es,{className:"w-4 h-4"}),i.jsxs("span",{children:[t?"Update":"Add"," Category"]})]}),i.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-telegram-hint text-telegram-hint rounded-lg",children:"Cancel"})]})]})]})})},K2=({department:t,onEdit:e,onDelete:n})=>{const r=s=>{switch(s){case"kitchen":return"bg-orange-100 text-orange-800";case"cashier":return"bg-green-100 text-green-800";case"admin":return"bg-purple-100 text-purple-800";case"delivery":return"bg-blue-100 text-blue-800";case"sales":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}};return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[i.jsx("div",{className:"text-2xl",children:t.icon}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:t.name}),i.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[i.jsx("span",{className:`text-xs px-2 py-1 rounded-full capitalize ${r(t.role)}`,children:t.role}),i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})]}),i.jsxs("div",{className:"flex items-center space-x-1 mt-2 text-xs text-telegram-hint",children:[i.jsx(tr,{className:"w-3 h-3"}),i.jsxs("span",{children:["Chat ID: ",t.telegramChatId]})]})]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>e(t),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded",children:i.jsx(k0,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>n(t.id),className:"p-2 text-red-500 hover:bg-red-500 hover:text-white rounded",children:i.jsx(co,{className:"w-4 h-4"})})]})]})})},G2=({department:t,userId:e,shopId:n,botToken:r,onSave:s,onCancel:a})=>{const[o,c]=V.useState({name:(t==null?void 0:t.name)||"",telegramChatId:(t==null?void 0:t.telegramChatId)||"",adminChatId:(t==null?void 0:t.adminChatId)||"",role:(t==null?void 0:t.role)||"shop",order:(t==null?void 0:t.order)||0,icon:(t==null?void 0:t.icon)||"👥",isActive:(t==null?void 0:t.isActive)??!0,notificationTypes:(t==null?void 0:t.notificationTypes)||[],userId:e,shopId:n}),[u,h]=V.useState(""),f=[{value:"kitchen",label:"Kitchen",description:"Receives order notifications for food preparation"},{value:"cashier",label:"Cashier",description:"Handles payments and order confirmations"},{value:"admin",label:"Admin",description:"Receives all notifications and manages operations"},{value:"shop",label:"Shop",description:"General shop notifications"},{value:"delivery",label:"Delivery",description:"Handles delivery and shipping notifications"},{value:"sales",label:"Sales",description:"Manages customer inquiries and sales"}],g=["new_order","order_confirmed","payment_received","low_stock","customer_inquiry","order_cancelled"],p=["👥","🍳","💰","👨‍💼","🚚","📞","📋","⚙️","🔔","📊","💼","🏪","📦","🛒","💳","📱"],N=T=>{T.preventDefault(),s(t?{...t,...o}:o)},k=T=>{const D=o.notificationTypes.includes(T)?o.notificationTypes.filter(S=>S!==T):[...o.notificationTypes,T];c({...o,notificationTypes:D})};return Wd.useEffect(()=>{h(r||"7141155447:AAGU2K74kX3ICzSIPB566tly3LUDo423JrU")},[r]),i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:t?"Edit Department":"Add Department"}),i.jsx("button",{onClick:a,className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:N,className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Ya,{className:"w-4 h-4 inline mr-1"}),"Department Name *"]}),i.jsx("input",{type:"text",value:o.name,onChange:T=>c({...o,name:T.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0,placeholder:"Enter department name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Display Order"}),i.jsx("input",{type:"number",min:"0",value:o.order,onChange:T=>c({...o,order:parseInt(T.target.value)||0}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"0"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Department Role *"}),i.jsx("select",{value:o.role,onChange:T=>c({...o,role:T.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0,children:f.map(T=>i.jsxs("option",{value:T.value,children:[T.label," - ",T.description]},T.value))})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-telegram-text border-b pb-2",children:[i.jsx(tr,{className:"w-4 h-4 inline mr-1"}),"Telegram Configuration"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Bd,{value:o.telegramChatId,onChange:T=>c({...o,telegramChatId:T}),label:"Primary Telegram Chat *",placeholder:"Enter @username or chat ID",required:!0,botToken:u,showValidation:!0}),i.jsx("p",{className:"text-xs text-telegram-hint -mt-2",children:"The main Telegram chat/group where notifications will be sent"}),i.jsx(Bd,{value:o.adminChatId,onChange:T=>c({...o,adminChatId:T}),label:"Admin Chat (Optional)",placeholder:"Enter @username or chat ID",botToken:u,showValidation:!0}),i.jsx("p",{className:"text-xs text-telegram-hint -mt-2",children:"Optional admin chat for escalated notifications and management"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Visual Settings"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Department Icon"}),i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-lg bg-telegram-button bg-opacity-10 flex items-center justify-center text-2xl",children:o.icon}),i.jsx("input",{type:"text",value:o.icon,onChange:T=>c({...o,icon:T.target.value}),className:"flex-1 p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",placeholder:"👥"})]}),i.jsx("div",{className:"grid grid-cols-8 gap-2",children:p.map(T=>i.jsx("button",{type:"button",onClick:()=>c({...o,icon:T}),className:`w-10 h-10 rounded border text-xl flex items-center justify-center ${o.icon===T?"border-telegram-button bg-telegram-button bg-opacity-10":"border-gray-300 hover:border-telegram-button"}`,children:T},T))})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-telegram-text border-b pb-2",children:[i.jsx(Cm,{className:"w-4 h-4 inline mr-1"}),"Notification Settings"]}),i.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:g.map(T=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:T,checked:o.notificationTypes.includes(T),onChange:()=>k(T),className:"mr-2"}),i.jsx("label",{htmlFor:T,className:"text-sm text-telegram-text capitalize",children:T.replace("_"," ")})]},T))})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Status"}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"isActive",checked:o.isActive,onChange:T=>c({...o,isActive:T.target.checked}),className:"mr-2"}),i.jsx("label",{htmlFor:"isActive",className:"text-sm text-telegram-text",children:"Department is active"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text border-b pb-2",children:"Preview"}),i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"text-2xl",children:o.icon}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:o.name||"Department Name"}),i.jsx("p",{className:"text-sm text-telegram-hint capitalize",children:o.role})]})]})})]}),i.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[i.jsxs("button",{type:"submit",className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg flex items-center justify-center space-x-2",children:[i.jsx(Es,{className:"w-4 h-4"}),i.jsxs("span",{children:[t?"Update":"Add"," Department"]})]}),i.jsx("button",{type:"button",onClick:a,className:"px-6 py-3 border border-telegram-hint text-telegram-hint rounded-lg",children:"Cancel"})]})]})]})})},Y2=({shop:t,onSave:e,onCancel:n})=>{var f,g,p,N,k,T,D,S,b,I,C,L,R,w,x,_,j;const[r,s]=V.useState(t),[a,o]=V.useState("basic"),c=E=>{E.preventDefault(),e(r)},u=(E,A)=>{s({...r,businessInfo:{...r.businessInfo,[E]:A}})},h=(E,A)=>{s({...r,settings:{...r.settings,[E]:A}})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Edit Shop"}),i.jsx("button",{onClick:n,className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"flex space-x-1 bg-telegram-secondary-bg rounded-lg p-1 mb-6",children:[{id:"basic",label:"Basic Info",icon:$r},{id:"business",label:"Business Info",icon:gi},{id:"settings",label:"Settings",icon:Nn}].map(E=>i.jsxs("button",{onClick:()=>o(E.id),className:`flex items-center space-x-2 px-4 py-2 rounded-md flex-1 justify-center ${a===E.id?"bg-telegram-button text-telegram-button-text":"text-telegram-hint hover:text-telegram-text"}`,children:[i.jsx(E.icon,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:E.label})]},E.id))}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[a==="basic"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx($r,{className:"w-4 h-4 inline mr-1"}),"Shop Name"]}),i.jsx("input",{type:"text",value:r.name,onChange:E=>s({...r,name:E.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Slug"}),i.jsx("input",{type:"text",value:r.slug,onChange:E=>s({...r,slug:E.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",required:!0})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Cc,{className:"w-4 h-4 inline mr-1"}),"Description"]}),i.jsx("textarea",{value:r.description,onChange:E=>s({...r,description:E.target.value}),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",rows:3})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Pc,{className:"w-4 h-4 inline mr-1"}),"Shop Logo"]}),i.jsx(Rm,{value:r.logo||"",onChange:E=>s({...r,logo:E}),placeholder:"Upload shop logo"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"isActive",checked:r.isActive,onChange:E=>s({...r,isActive:E.target.checked}),className:"mr-2"}),i.jsx("label",{htmlFor:"isActive",className:"text-sm text-telegram-text",children:"Shop is active"})]})]}),a==="business"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(km,{className:"w-4 h-4 inline mr-1"}),"Address"]}),i.jsx("input",{type:"text",value:((f=r.businessInfo)==null?void 0:f.address)||"",onChange:E=>u("address",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Am,{className:"w-4 h-4 inline mr-1"}),"Phone"]}),i.jsx("input",{type:"tel",value:((g=r.businessInfo)==null?void 0:g.phone)||"",onChange:E=>u("phone",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(Im,{className:"w-4 h-4 inline mr-1"}),"Email"]}),i.jsx("input",{type:"email",value:((p=r.businessInfo)==null?void 0:p.email)||"",onChange:E=>u("email",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:[i.jsx(gi,{className:"w-4 h-4 inline mr-1"}),"Website"]}),i.jsx("input",{type:"url",value:((N=r.businessInfo)==null?void 0:N.website)||"",onChange:E=>u("website",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Special Message"}),i.jsx("textarea",{value:((k=r.businessInfo)==null?void 0:k.specialMessage)||"",onChange:E=>u("specialMessage",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",rows:3,placeholder:"Special message for customers..."})]})]}),a==="settings"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Currency"}),i.jsxs("select",{value:((T=r.settings)==null?void 0:T.currency)||"USD",onChange:E=>h("currency",E.target.value),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text",children:[i.jsx("option",{value:"USD",children:"USD ($)"}),i.jsx("option",{value:"EUR",children:"EUR (€)"}),i.jsx("option",{value:"ETB",children:"ETB (Br)"}),i.jsx("option",{value:"GBP",children:"GBP (£)"}),i.jsx("option",{value:"NGN",children:"NGN (₦)"}),i.jsx("option",{value:"KES",children:"KES (KSh)"}),i.jsx("option",{value:"ZAR",children:"ZAR (R)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Tax Rate (%)"}),i.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:((D=r.settings)==null?void 0:D.taxRate)||0,onChange:E=>h("taxRate",parseFloat(E.target.value)),className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Opening Time"}),i.jsx("input",{type:"time",value:((b=(S=r.settings)==null?void 0:S.businessHours)==null?void 0:b.open)||"09:00",onChange:E=>{var A;return h("businessHours",{...(A=r.settings)==null?void 0:A.businessHours,open:E.target.value})},className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-1",children:"Closing Time"}),i.jsx("input",{type:"time",value:((C=(I=r.settings)==null?void 0:I.businessHours)==null?void 0:C.close)||"18:00",onChange:E=>{var A;return h("businessHours",{...(A=r.settings)==null?void 0:A.businessHours,close:E.target.value})},className:"w-full p-3 border rounded-lg bg-telegram-secondary-bg text-telegram-text"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Operating Days"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{value:"monday",label:"Mon"},{value:"tuesday",label:"Tue"},{value:"wednesday",label:"Wed"},{value:"thursday",label:"Thu"},{value:"friday",label:"Fri"},{value:"saturday",label:"Sat"},{value:"sunday",label:"Sun"}].map(E=>{var A,v;return i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:(((v=(A=r.settings)==null?void 0:A.businessHours)==null?void 0:v.days)||[]).includes(E.value),onChange:ae=>{var G,U,q;const Z=((U=(G=r.settings)==null?void 0:G.businessHours)==null?void 0:U.days)||[],O=ae.target.checked?[...Z,E.value]:Z.filter(X=>X!==E.value);h("businessHours",{...(q=r.settings)==null?void 0:q.businessHours,days:O})},className:"rounded"}),i.jsx("span",{className:"text-sm text-telegram-text",children:E.label})]},E.value)})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-telegram-text",children:"Order Settings"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"autoConfirm",checked:((R=(L=r.settings)==null?void 0:L.orderSettings)==null?void 0:R.autoConfirm)||!1,onChange:E=>{var A;return h("orderSettings",{...(A=r.settings)==null?void 0:A.orderSettings,autoConfirm:E.target.checked})},className:"mr-2"}),i.jsx("label",{htmlFor:"autoConfirm",className:"text-sm text-telegram-text",children:"Auto-confirm orders"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"requirePayment",checked:((x=(w=r.settings)==null?void 0:w.orderSettings)==null?void 0:x.requirePayment)||!1,onChange:E=>{var A;return h("orderSettings",{...(A=r.settings)==null?void 0:A.orderSettings,requirePayment:E.target.checked})},className:"mr-2"}),i.jsx("label",{htmlFor:"requirePayment",className:"text-sm text-telegram-text",children:"Require payment before processing"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"allowCancellation",checked:((j=(_=r.settings)==null?void 0:_.orderSettings)==null?void 0:j.allowCancellation)??!0,onChange:E=>{var A;return h("orderSettings",{...(A=r.settings)==null?void 0:A.orderSettings,allowCancellation:E.target.checked})},className:"mr-2"}),i.jsx("label",{htmlFor:"allowCancellation",className:"text-sm text-telegram-text",children:"Allow order cancellation"})]})]})]})]}),i.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[i.jsxs("button",{type:"submit",className:"flex-1 bg-telegram-button text-telegram-button-text py-3 rounded-lg flex items-center justify-center space-x-2",children:[i.jsx(Es,{className:"w-4 h-4"}),i.jsx("span",{children:"Save Changes"})]}),i.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 border border-telegram-hint text-telegram-hint rounded-lg",children:"Cancel"})]})]})]})})},X2=({shop:t,stats:e})=>{const n=r=>{var o;const s=((o=t.settings)==null?void 0:o.currency)||"USD";return`${s==="USD"?"$":s==="EUR"?"€":s==="ETB"?"Br":"$"}${r.toFixed(2)}`};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Shop Analytics"}),i.jsxs("div",{className:"flex items-center space-x-2 text-sm text-telegram-hint",children:[i.jsx(Kl,{className:"w-4 h-4"}),i.jsx("span",{children:"Last 30 days"})]})]}),i.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:(e==null?void 0:e.totalProducts)||0}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Products"})]}),i.jsx(qe,{className:"w-8 h-8 text-blue-500"})]}),i.jsxs("div",{className:"flex items-center mt-2 text-xs",children:[i.jsx(Qo,{className:"w-3 h-3 text-green-500 mr-1"}),i.jsx("span",{className:"text-green-500",children:"+5.2%"}),i.jsx("span",{className:"text-telegram-hint ml-1",children:"vs last month"})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:(e==null?void 0:e.totalOrders)||0}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Orders"})]}),i.jsx(Vn,{className:"w-8 h-8 text-green-500"})]}),i.jsxs("div",{className:"flex items-center mt-2 text-xs",children:[i.jsx(Qo,{className:"w-3 h-3 text-green-500 mr-1"}),i.jsx("span",{className:"text-green-500",children:"+12.8%"}),i.jsx("span",{className:"text-telegram-hint ml-1",children:"vs last month"})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:n((e==null?void 0:e.totalRevenue)||0)}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Revenue"})]}),i.jsx(Ac,{className:"w-8 h-8 text-yellow-500"})]}),i.jsxs("div",{className:"flex items-center mt-2 text-xs",children:[i.jsx(Qo,{className:"w-3 h-3 text-green-500 mr-1"}),i.jsx("span",{className:"text-green-500",children:"+8.4%"}),i.jsx("span",{className:"text-telegram-hint ml-1",children:"vs last month"})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-telegram-text",children:(e==null?void 0:e.totalCustomers)||0}),i.jsx("div",{className:"text-sm text-telegram-hint",children:"Total Customers"})]}),i.jsx(Ya,{className:"w-8 h-8 text-purple-500"})]}),i.jsxs("div",{className:"flex items-center mt-2 text-xs",children:[i.jsx(Qo,{className:"w-3 h-3 text-green-500 mr-1"}),i.jsx("span",{className:"text-green-500",children:"+15.6%"}),i.jsx("span",{className:"text-telegram-hint ml-1",children:"vs last month"})]})]})]}),i.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsxs("h4",{className:"font-medium text-telegram-text mb-3 flex items-center",children:[i.jsx(Wl,{className:"w-4 h-4 mr-2"}),"Performance Metrics"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-telegram-hint",children:"Average Order Value"}),i.jsx("span",{className:"font-medium text-telegram-text",children:n(((e==null?void 0:e.totalRevenue)||0)/Math.max((e==null?void 0:e.totalOrders)||1,1))})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-telegram-hint",children:"Orders per Customer"}),i.jsx("span",{className:"font-medium text-telegram-text",children:(((e==null?void 0:e.totalOrders)||0)/Math.max((e==null?void 0:e.totalCustomers)||1,1)).toFixed(1)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-telegram-hint",children:"Revenue per Customer"}),i.jsx("span",{className:"font-medium text-telegram-text",children:n(((e==null?void 0:e.totalRevenue)||0)/Math.max((e==null?void 0:e.totalCustomers)||1,1))})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-telegram-hint",children:"Active Products"}),i.jsxs("span",{className:"font-medium text-telegram-text",children:[Math.round(((e==null?void 0:e.totalProducts)||0)*.85)," / ",(e==null?void 0:e.totalProducts)||0]})]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text mb-3",children:"Recent Activity"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsx("span",{className:"text-telegram-hint",children:"New order received"}),i.jsx("span",{className:"text-xs text-telegram-hint ml-auto",children:"2 min ago"})]}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{className:"text-telegram-hint",children:"Product updated"}),i.jsx("span",{className:"text-xs text-telegram-hint ml-auto",children:"15 min ago"})]}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),i.jsx("span",{className:"text-telegram-hint",children:"Low stock alert"}),i.jsx("span",{className:"text-xs text-telegram-hint ml-auto",children:"1 hour ago"})]}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),i.jsx("span",{className:"text-telegram-hint",children:"New customer registered"}),i.jsx("span",{className:"text-xs text-telegram-hint ml-auto",children:"3 hours ago"})]})]})]})]}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-telegram-text mb-3",children:"Quick Actions"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[i.jsxs("button",{className:"p-3 text-center rounded-lg border border-telegram-hint hover:bg-telegram-button hover:text-telegram-button-text transition-colors",children:[i.jsx(qe,{className:"w-6 h-6 mx-auto mb-1"}),i.jsx("span",{className:"text-xs",children:"Add Product"})]}),i.jsxs("button",{className:"p-3 text-center rounded-lg border border-telegram-hint hover:bg-telegram-button hover:text-telegram-button-text transition-colors",children:[i.jsx(Vn,{className:"w-6 h-6 mx-auto mb-1"}),i.jsx("span",{className:"text-xs",children:"View Orders"})]}),i.jsxs("button",{className:"p-3 text-center rounded-lg border border-telegram-hint hover:bg-telegram-button hover:text-telegram-button-text transition-colors",children:[i.jsx(Ya,{className:"w-6 h-6 mx-auto mb-1"}),i.jsx("span",{className:"text-xs",children:"Customers"})]}),i.jsxs("button",{className:"p-3 text-center rounded-lg border border-telegram-hint hover:bg-telegram-button hover:text-telegram-button-text transition-colors",children:[i.jsx(Wl,{className:"w-6 h-6 mx-auto mb-1"}),i.jsx("span",{className:"text-xs",children:"Reports"})]})]})]})]})},J2=({userId:t,onTokenUpdate:e})=>{const{db:n}=js(),{user:r}=Ns(),[s,a]=V.useState(""),[o,c]=V.useState(!1),[u,h]=V.useState(!1),[f,g]=V.useState(!1),[p,N]=V.useState(null),[k,T]=V.useState(null);V.useEffect(()=>{D()},[t]);const D=async()=>{try{const I=await w0(Ht(n,"users",t));if(I.exists()){const C=I.data();a(C.telegramBotToken||"")}}catch(I){console.error("Error loading bot token:",I)}},S=async()=>{if(!s.trim()){T("Bot token is required");return}if(!s.match(/^\d+:[A-Za-z0-9_-]{35}$/)){T("Invalid bot token format. Should be like: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz");return}h(!0),T(null);try{const I=Ht(n,"users",t);await ss(I,{telegramBotToken:s.trim(),updatedAt:new Date}),e&&e(s.trim()),N(null)}catch(I){console.error("Error saving bot token:",I),T("Failed to save bot token. Please try again.")}finally{h(!1)}},b=async()=>{if(!s.trim()){T("Please enter a bot token first");return}g(!0),N(null),T(null);try{const I=new Dm(s.trim()),L=await(await fetch(`https://api.telegram.org/bot${s.trim()}/getMe`)).json();L.ok?N("success"):(N("error"),T(L.description||"Bot token test failed"))}catch(I){console.error("Error testing bot token:",I),N("error"),T("Failed to test bot token. Please check your internet connection.")}finally{g(!1)}};return i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(tr,{className:"w-5 h-5 text-telegram-button"}),i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Telegram Bot Settings"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-telegram-text mb-2",children:"Bot Token *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:o?"text":"password",value:s,onChange:I=>a(I.target.value),className:"w-full pl-3 pr-20 py-2 border border-telegram-hint/30 rounded-lg bg-telegram-bg text-telegram-text focus:border-telegram-button focus:outline-none",placeholder:"123456789:ABCdefGHIjklMNOpqrsTUVwxyz"}),i.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center space-x-1 pr-2",children:[i.jsx("button",{type:"button",onClick:()=>c(!o),className:"p-1 text-telegram-hint hover:text-telegram-text",title:o?"Hide token":"Show token",children:o?i.jsx(g2,{className:"w-4 h-4"}):i.jsx(Tm,{className:"w-4 h-4"})}),i.jsx("button",{type:"button",onClick:b,disabled:f||!s.trim(),className:"p-1 text-telegram-button hover:text-telegram-button/80 disabled:opacity-50",title:"Test bot token",children:f?i.jsx(xi,{className:"w-4 h-4 animate-spin"}):i.jsx(N2,{className:"w-4 h-4"})})]})]})]}),p&&i.jsxs("div",{className:`flex items-center space-x-2 text-sm ${p==="success"?"text-green-600":"text-red-600"}`,children:[p==="success"?i.jsx(Jn,{className:"w-4 h-4"}):i.jsx(ys,{className:"w-4 h-4"}),i.jsx("span",{children:p==="success"?"Bot token is valid and working!":"Bot token test failed"})]}),k&&i.jsxs("div",{className:"text-red-600 text-sm flex items-center space-x-1",children:[i.jsx(ys,{className:"w-4 h-4"}),i.jsx("span",{children:k})]}),i.jsx("div",{className:"flex space-x-3",children:i.jsxs("button",{onClick:S,disabled:u||!s.trim(),className:"flex items-center space-x-2 bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg hover:opacity-80 disabled:opacity-50",children:[u?i.jsx(xi,{className:"w-4 h-4 animate-spin"}):i.jsx(Es,{className:"w-4 h-4"}),i.jsx("span",{children:u?"Saving...":"Save Token"})]})}),i.jsxs("div",{className:"bg-telegram-button/10 border border-telegram-button/20 rounded-lg p-3",children:[i.jsx("h4",{className:"font-medium text-telegram-text mb-2",children:"How to get your Bot Token:"}),i.jsxs("ol",{className:"text-sm text-telegram-hint space-y-1 list-decimal list-inside",children:[i.jsx("li",{children:"Open Telegram and search for @BotFather"}),i.jsx("li",{children:"Send /newbot command to create a new bot"}),i.jsx("li",{children:"Follow the instructions to set up your bot"}),i.jsx("li",{children:"Copy the bot token provided by BotFather"}),i.jsx("li",{children:'Paste it here and click "Save Token"'})]}),i.jsx("p",{className:"text-xs text-telegram-hint mt-2",children:"The bot token is used to send promotional messages and notifications to your Telegram channels/groups."})]})]})]})};var Z2={};const eS=()=>{const{db:t}=js(),{user:e}=Ns(),[n,r]=V.useState(!0),[s,a]=V.useState(null),[o,c]=V.useState([]),[u,h]=V.useState(null),[f,g]=V.useState([]),[p,N]=V.useState([]),[k,T]=V.useState([]),[D,S]=V.useState("profile"),[b,I]=V.useState(null),[C,L]=V.useState(null),[R,w]=V.useState(null),[x,_]=V.useState(null),[j,E]=V.useState(!1),[A,v]=V.useState(!1),[ae,Z]=V.useState(!1),[O,G]=V.useState(!1),[U,q]=V.useState(!1),[X,ee]=V.useState(null),[Q,B]=V.useState(!1),[Ne,Je]=V.useState(null),[Ue,ce]=V.useState(null),[vt,sn]=V.useState(null),[At,ne]=V.useState("");V.useEffect(()=>{e!=null&&e.id?ye():r(!1)},[e]);const ye=async()=>{try{if(r(!0),ce(null),!(e!=null&&e.id)){ce("No user information available");return}const W=Ie(t,"users"),Y=Re(W,be("telegramId","==",parseInt(e.id))),mt=await Me(Y);if(mt.empty){ce("User not found in database"),r(!1);return}const an=mt.docs[0],st=an.data();a(st),ne(st.telegramBotToken||"");const et=Ie(t,"shops"),ie=Re(et,be("ownerId","==",an.id),be("isActive","==",!0)),ut=await Me(ie),ft=[];ut.forEach(tt=>{var Hn,Yt;const $e=tt.data(),dr={id:tt.id,ownerId:$e.ownerId,name:$e.name,slug:$e.slug,description:$e.description,logo:$e.logo,isActive:$e.isActive!==!1,businessInfo:$e.businessInfo||{},settings:$e.settings||{currency:"USD",taxRate:0,businessHours:{open:"09:00",close:"18:00",days:[]},orderSettings:{autoConfirm:!1,requirePayment:!1,allowCancellation:!0}},stats:$e.stats||{totalProducts:0,totalOrders:0,totalRevenue:0,totalCustomers:0},createdAt:((Hn=$e.createdAt)==null?void 0:Hn.toDate())||new Date,updatedAt:((Yt=$e.updatedAt)==null?void 0:Yt.toDate())||new Date};ft.push(dr)}),c(ft)}catch(W){console.error("Error loading user data:",W),ce("Failed to load user data. Please try again.")}finally{r(!1)}},Ke=async W=>{await Promise.all([wt(W),Bt(W),M(W),J(W)])},wt=async W=>{try{const Y=Ie(t,"products"),mt=Re(Y,be("shopId","==",W),en("createdAt","desc")),an=await Me(mt),st=[];an.forEach(et=>{var ft,tt;const ie=et.data(),ut={id:et.id,shopId:ie.shopId,name:ie.name,description:ie.description,price:ie.price,stock:ie.stock||0,category:ie.category,subcategory:ie.subcategory,images:ie.images||[],sku:ie.sku,isActive:ie.isActive!==!1,lowStockAlert:ie.lowStockAlert||5,tags:ie.tags||[],featured:ie.featured||!1,costPrice:ie.costPrice,weight:ie.weight,dimensions:ie.dimensions,createdAt:((ft=ie.createdAt)==null?void 0:ft.toDate())||new Date,updatedAt:((tt=ie.updatedAt)==null?void 0:tt.toDate())||new Date};st.push(ut)}),g(st)}catch(Y){console.error("Error fetching products:",Y),ce("Failed to load products. Please try again.")}},Bt=async W=>{try{r(!0);const Y=Ie(t,"categories"),mt=Re(Y,be("shopId","==",W),en("order","asc")),an=await Me(mt),st=[];an.forEach(et=>{var ft,tt;const ie=et.data(),ut={id:et.id,userId:ie.userId,shopId:ie.shopId,name:ie.name,description:ie.description,color:ie.color,icon:ie.icon,order:ie.order||0,isActive:ie.isActive!==!1,productCount:ie.productCount||0,createdAt:((ft=ie.createdAt)==null?void 0:ft.toDate())||new Date,updatedAt:((tt=ie.updatedAt)==null?void 0:tt.toDate())||new Date};st.push(ut)}),N(st)}catch(Y){console.error("Error fetching categories:",Y),ce("Failed to load categories. Please try again.")}finally{r(!1)}},M=async W=>{try{const Y=Ie(t,"departments"),mt=Re(Y,be("shopId","==",W),en("order","asc")),st=(await Me(mt)).docs.map(et=>{var ut,ft,tt,$e;const ie=et.data();return{id:et.id,userId:ie.userId||"",shopId:ie.shopId||"",name:ie.name||"",telegramChatId:ie.telegramChatId||"",adminChatId:ie.adminChatId||"",role:ie.role||"",order:typeof ie.order=="number"?ie.order:0,icon:ie.icon||"",isActive:ie.isActive!==!1,notificationTypes:ie.notificationTypes||[],createdAt:((ft=(ut=ie.createdAt)==null?void 0:ut.toDate)==null?void 0:ft.call(ut))??(ie.createdAt?new Date(ie.createdAt):new Date),updatedAt:(($e=(tt=ie.updatedAt)==null?void 0:tt.toDate)==null?void 0:$e.call(tt))??(ie.updatedAt?new Date(ie.updatedAt):new Date)}});T(st)}catch(Y){console.error("Error fetching departments:",Y),ce("Failed to load departments. Please try again.")}},J=async W=>{try{const Y=Ie(t,"products"),mt=Re(Y,be("shopId","==",W),be("isActive","==",!0)),st=(await Me(mt)).size,et=Ie(t,"orders"),ie=Re(et,be("shopId","==",W)),ut=await Me(ie);let ft=0,tt=0;const $e=new Set;ut.forEach(Hn=>{const Yt=Hn.data();ft++,tt+=Yt.total||0,Yt.customerId&&$e.add(Yt.customerId)});const dr=$e.size;sn({totalProducts:st,totalOrders:ft,totalRevenue:tt,totalCustomers:dr})}catch(Y){console.error("Error fetching stats:",Y)}},he=async W=>{h(W),S("products"),ce(null),await Ke(W.id)},de=async W=>{try{if(ce(null),C){const Y=Ht(t,"products",C.id);await ss(Y,{...W,updatedAt:new Date})}else{const Y=Ie(t,"products");await is(Y,{...W,createdAt:new Date,updatedAt:new Date})}L(null),E(!1),u&&await wt(u.id)}catch(Y){console.error("Error saving product:",Y),ce("Failed to save product. Please try again.")}},ue=async W=>{try{ce(null);const Y=Ht(t,"products",W);await ia(Y),u&&await wt(u.id)}catch(Y){console.error("Error deleting product:",Y),ce("Failed to delete product. Please try again.")}},xe=async W=>{try{if(ce(null),R){const Y=Ht(t,"categories",R.id);await ss(Y,{...W,updatedAt:new Date})}else{const Y=Ie(t,"categories");await is(Y,{...W,createdAt:new Date,updatedAt:new Date})}w(null),v(!1),u&&await Bt(u.id)}catch(Y){console.error("Error saving category:",Y),ce("Failed to save category. Please try again.")}},Ce=async W=>{try{ce(null);const Y=Ht(t,"categories",W);await ia(Y),u&&await Bt(u.id)}catch(Y){console.error("Error deleting category:",Y),ce("Failed to delete category. Please try again.")}},fe=async W=>{try{if(ce(null),x){const Y=Ht(t,"departments",x.id);await ss(Y,{...W,updatedAt:new Date})}else{const Y=Ie(t,"departments");await is(Y,{...W,createdAt:new Date,updatedAt:new Date})}_(null),Z(!1),u&&await M(u.id)}catch(Y){console.error("Error saving department:",Y),ce("Failed to save department. Please try again.")}},ct=async W=>{try{ce(null);const Y=Ht(t,"departments",W);await ia(Y),u&&await M(u.id)}catch(Y){console.error("Error deleting department:",Y),ce("Failed to delete department. Please try again.")}},Qr=async W=>{try{ce(null);const Y=Ht(t,"shops",W);await ia(Y),(u==null?void 0:u.id)===W&&(h(null),S("profile")),await ye(),ee(null)}catch(Y){console.error("Error deleting shop:",Y),ce("Failed to delete shop. Please try again.")}},Ze=W=>{Je(W),G(!0)},_t=async W=>{try{ce(null);const{product:Y,customMessage:mt,promotionImages:an,promotionTitle:st,discountPercentage:et,validUntil:ie,tags:ut,isScheduled:ft,scheduledDate:tt,selectedDepartments:$e}=W,dr=et>0?`
💥 <b>${et}% OFF!</b>`:"",Hn=et>0?`
~~$${Y.price.toFixed(2)}~~ `:"",Yt=et>0?`<b>$${(Y.price*(1-et/100)).toFixed(2)}</b>`:`<b>$${Y.price.toFixed(2)}</b>`,Ti=ie?`
⏰ <b>Valid until:</b> ${ie.toLocaleDateString()}`:"",Ii=ut.length>0?`

${ut.join(" ")}`:"",ki={text:`
🔥 <b>${st}</b>${dr}

🛍️ <b>${Y.name}</b>

${mt||Y.description}

💰 <b>Price:</b> ${Hn}${Yt}
📦 <b>Available:</b> ${Y.stock} in stock
${Y.sku?`🏷️ <b>SKU:</b> ${Y.sku}`:""}${Ti}

🛒 <b>Order Now!</b> Don't miss this amazing deal!${Ii}

<i>🚀 Limited time offer - Order today!</i>
      `.trim(),images:an.length>0?an:Y.images.length>0?[Y.images[0]]:void 0,parseMode:"HTML"},Ss=$e.length>0?k.filter(jn=>$e.includes(jn.id)):k.filter(jn=>jn.isActive),Ai=Z2.TELEGRAM_BOT_TOKEN||"7141155447:AAGU2K74kX3ICzSIPB566tly3LUDo423JrU";for(const jn of Ss){const Ci={botToken:Ai,chatId:jn.telegramChatId};ft&&tt?await Pg.scheduleMessage(Ci,ki,tt):await Pg.sendPromotionMessage(Ci,ki)}G(!1),Je(null)}catch(Y){console.error("Error promoting product:",Y),ce("Failed to promote product. Please check your Telegram bot configuration.")}};return n?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-8 bg-gray-300 rounded w-1/2"}),i.jsx("div",{className:"h-32 bg-gray-300 rounded"})]})}):s?i.jsxs("div",{className:"p-3 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h1",{className:"text-xl font-bold text-telegram-text",children:"Admin Panel"}),i.jsx("div",{className:"text-xs text-telegram-hint",children:s.displayName||s.email})]}),Ue&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-3 py-2 rounded-lg text-sm",children:Ue}),i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-telegram-button rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(yi,{className:"w-6 h-6 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-base font-semibold text-telegram-text",children:s.displayName||"User"}),i.jsx("p",{className:"text-sm text-telegram-hint",children:s.email}),i.jsxs("p",{className:"text-sm text-telegram-hint capitalize",children:["Role: ",s.role]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-telegram-hint",children:"Shops"}),i.jsx("div",{className:"text-lg font-bold text-telegram-button",children:o.length})]})]})}),o.length>0&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-base font-semibold text-telegram-text",children:"Your Shops"}),i.jsxs("button",{onClick:()=>q(!0),className:"bg-telegram-button text-telegram-button-text px-3 py-2 rounded-lg text-sm flex items-center space-x-1",children:[i.jsx(yn,{className:"w-3 h-3"}),i.jsx("span",{children:"Add Shop"})]})]}),o.map(W=>{var Y,mt;return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-3",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[W.logo&&i.jsx("img",{src:W.logo,alt:W.name,className:"w-10 h-10 rounded-lg object-cover flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-telegram-text",children:W.name}),i.jsx("p",{className:"text-xs text-telegram-hint mt-1 line-clamp-2",children:W.description})]})]}),i.jsxs("div",{className:"flex items-center space-x-3 mt-2 text-xs text-telegram-hint",children:[i.jsxs("span",{className:"flex items-center",children:[i.jsx(qe,{className:"w-3 h-3 mr-1"}),((Y=W.stats)==null?void 0:Y.totalProducts)||0," products"]}),i.jsxs("span",{className:"flex items-center",children:[i.jsx(Vn,{className:"w-3 h-3 mr-1"}),((mt=W.stats)==null?void 0:mt.totalOrders)||0," orders"]}),i.jsx("span",{className:`px-2 py-1 rounded-full ${W.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:W.isActive?"Active":"Inactive"})]})]}),i.jsxs("div",{className:"flex space-x-1 ml-2",children:[i.jsx("button",{onClick:()=>I(W),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded-lg",title:"Edit Shop",children:i.jsx(S0,{className:"w-3 h-3"})}),i.jsx("button",{onClick:()=>he(W),className:"p-2 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded-lg",title:"Manage Shop",children:i.jsx(Wl,{className:"w-3 h-3"})}),i.jsx("button",{onClick:()=>ee(W.id),className:"p-2 text-red-500 hover:bg-red-500 hover:text-white rounded-lg",title:"Delete Shop",children:i.jsx(co,{className:"w-3 h-3"})})]})]})},W.id)})]}),o.length===0&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx($r,{className:"w-12 h-12 mx-auto text-telegram-hint mb-3"}),i.jsx("h3",{className:"text-base font-medium text-telegram-text mb-2",children:"No Shops Yet"}),i.jsx("p",{className:"text-sm text-telegram-hint mb-4",children:"You don't own any shops yet. Create your first shop to get started."}),i.jsx("button",{onClick:()=>q(!0),className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg text-sm",children:"Create Your First Shop"})]}),u&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:()=>h(null),className:"p-2 text-telegram-hint hover:text-telegram-text rounded-lg",children:i.jsx(cs,{className:"w-4 h-4"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-bold text-telegram-text",children:u.name}),i.jsx("p",{className:"text-xs text-telegram-hint",children:"Shop Management"})]})]})}),i.jsx("div",{className:"flex bg-telegram-secondary-bg rounded-lg p-1 overflow-x-auto",children:[{id:"products",label:"Products",icon:qe},{id:"categories",label:"Categories",icon:Gl},{id:"departments",label:"Departments",icon:Ya},{id:"analytics",label:"Analytics",icon:Wl},{id:"orders",label:"Orders",icon:Vn},{id:"settings",label:"Settings",icon:Cm}].map(W=>i.jsxs("button",{onClick:()=>S(W.id),className:`flex items-center space-x-1 px-3 py-2 rounded-md flex-1 justify-center min-w-0 ${D===W.id?"bg-telegram-button text-telegram-button-text":"text-telegram-hint hover:text-telegram-text"}`,children:[i.jsx(W.icon,{className:"w-3 h-3 flex-shrink-0"}),i.jsx("span",{className:"text-xs font-medium truncate",children:W.label})]},W.id))}),D==="products"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-base font-semibold text-telegram-text",children:"Products"}),i.jsxs("button",{onClick:()=>E(!0),className:"bg-telegram-button text-telegram-button-text px-3 py-2 rounded-lg flex items-center space-x-1 text-sm",children:[i.jsx(yn,{className:"w-3 h-3"}),i.jsx("span",{children:"Add Product"})]})]}),i.jsx("div",{className:"space-y-2",children:f.map(W=>i.jsx(F2,{product:W,onEdit:L,onDelete:ue,onPromote:Ze},W.id))}),f.length===0&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx(qe,{className:"w-12 h-12 mx-auto text-telegram-hint mb-3"}),i.jsx("h3",{className:"text-base font-medium text-telegram-text mb-2",children:"No Products Yet"}),i.jsx("p",{className:"text-sm text-telegram-hint mb-4",children:"Add your first product to get started."}),i.jsx("button",{onClick:()=>E(!0),className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg text-sm",children:"Add Product"})]})]}),D==="categories"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-base font-semibold text-telegram-text",children:"Categories"}),i.jsxs("button",{onClick:()=>v(!0),className:"bg-telegram-button text-telegram-button-text px-3 py-2 rounded-lg flex items-center space-x-1 text-sm",children:[i.jsx(yn,{className:"w-3 h-3"}),i.jsx("span",{children:"Add Category"})]})]}),i.jsx("div",{className:"space-y-2",children:p.map(W=>i.jsx(Q2,{category:W,onEdit:w,onDelete:Ce},W.id))}),p.length===0&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx(Gl,{className:"w-12 h-12 mx-auto text-telegram-hint mb-3"}),i.jsx("h3",{className:"text-base font-medium text-telegram-text mb-2",children:"No Categories Yet"}),i.jsx("p",{className:"text-sm text-telegram-hint mb-4",children:"Add categories to organize your products."}),i.jsx("button",{onClick:()=>v(!0),className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg text-sm",children:"Add Category"})]})]}),D==="departments"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-base font-semibold text-telegram-text",children:"Departments"}),i.jsxs("button",{onClick:()=>Z(!0),className:"bg-telegram-button text-telegram-button-text px-3 py-2 rounded-lg flex items-center space-x-1 text-sm",children:[i.jsx(yn,{className:"w-3 h-3"}),i.jsx("span",{children:"Add Department"})]})]}),i.jsx("div",{className:"space-y-2",children:k.map(W=>i.jsx(K2,{department:W,onEdit:_,onDelete:ct},W.id))}),k.length===0&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx(Ya,{className:"w-12 h-12 mx-auto text-telegram-hint mb-3"}),i.jsx("h3",{className:"text-base font-medium text-telegram-text mb-2",children:"No Departments Yet"}),i.jsx("p",{className:"text-sm text-telegram-hint mb-4",children:"Add departments for Telegram notifications."}),i.jsx("button",{onClick:()=>Z(!0),className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg text-sm",children:"Add Department"})]})]}),D==="analytics"&&i.jsx(X2,{shop:u,stats:vt}),D==="orders"&&i.jsx(P2,{selectedShopId:u.id}),D==="settings"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-base font-semibold text-telegram-text",children:"Shop Settings"}),s&&i.jsx(J2,{userId:s.uid,onTokenUpdate:W=>ne(W)})]})]}),(C||j)&&i.jsx(U2,{product:C||void 0,shopId:(u==null?void 0:u.id)||"",categories:p,onSave:de,onCancel:()=>{L(null),E(!1)}}),(R||A)&&s&&u&&i.jsx(W2,{category:R||void 0,userId:s.uid,shopId:u.id,onSave:xe,onCancel:()=>{w(null),v(!1)}}),(x||ae)&&s&&u&&i.jsx(G2,{department:x||void 0,userId:s.uid,shopId:u.id,botToken:At,onSave:fe,onCancel:()=>{_(null),Z(!1)}}),b&&i.jsx(Y2,{shop:b,onSave:async W=>{try{const Y=Ht(t,"shops",W.id);await ss(Y,{...W,updatedAt:new Date}),I(null),await ye()}catch(Y){console.error("Error updating shop:",Y),ce("Failed to update shop. Please try again.")}},onCancel:()=>I(null)}),O&&Ne&&i.jsx(H2,{product:Ne,departments:k,botToken:At,onClose:()=>{G(!1),Je(null)},onPromote:_t}),U&&s&&i.jsx(M2,{userId:s.uid,onSave:async W=>{try{ce(null);const Y=Ie(t,"shops");await is(Y,{...W,createdAt:new Date,updatedAt:new Date}),q(!1),await ye()}catch(Y){console.error("Error creating shop:",Y),ce("Failed to create shop. Please try again.")}},onCancel:()=>q(!1)}),X&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-telegram-bg rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-telegram-text",children:"Delete Shop"}),i.jsx("button",{onClick:()=>ee(null),className:"text-telegram-hint",children:i.jsx(yt,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("p",{className:"text-telegram-text mb-2",children:"Are you sure you want to delete this shop? This action cannot be undone."}),i.jsx("p",{className:"text-sm text-red-600",children:"All products, categories, departments, and orders associated with this shop will be permanently deleted."})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>ee(null),className:"flex-1 bg-telegram-hint text-white py-3 rounded-lg font-medium",children:"Cancel"}),i.jsx("button",{onClick:()=>Qr(X),className:"flex-1 bg-red-500 text-white py-3 rounded-lg font-medium",children:"Delete Shop"})]})]})})]}):i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(yi,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"User Not Found"}),i.jsx("p",{className:"text-telegram-hint",children:Ue||"Unable to load user data. Please try again."})]})})},tS=({user:t,onComplete:e})=>{const{db:n}=js(),[r,s]=V.useState(!1),[a,o]=V.useState(null),[c,u]=V.useState({displayName:`${t.firstName} ${t.lastName}`.trim(),email:""}),h=async f=>{f.preventDefault(),s(!0),o(null);try{const g=new Date,p={createdAt:g,displayName:c.displayName,email:c.email,telegramId:t.telegramId||parseInt(t.id),updatedAt:g},N=Ie(n,"users"),k=await is(N,p),T={...p,uid:k.id};e(T)}catch(g){console.error("Error creating user:",g),o("Failed to create account. Please try again.")}finally{s(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-telegram-button/10 via-telegram-bg to-telegram-secondary-bg flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"h-16 w-16 bg-telegram-button rounded-2xl flex items-center justify-center",children:i.jsx($r,{className:"h-8 w-8 text-telegram-button-text"})})}),i.jsx("h2",{className:"mt-6 text-3xl font-bold text-telegram-text",children:"Welcome to Multi-Shop!"}),i.jsx("p",{className:"mt-2 text-sm text-telegram-hint",children:"Complete your profile to get started"})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[a&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-sm",children:a}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-telegram-text mb-2",children:"Full Name"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(yi,{className:"h-5 w-5 text-telegram-hint"})}),i.jsx("input",{id:"displayName",name:"displayName",type:"text",required:!0,value:c.displayName,onChange:f=>u({...c,displayName:f.target.value}),className:"block w-full pl-10 pr-3 py-3 border border-telegram-hint/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-telegram-button focus:border-transparent transition-colors duration-200 bg-telegram-secondary-bg text-telegram-text",placeholder:"Enter your full name"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-telegram-text mb-2",children:"Email Address"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Im,{className:"h-5 w-5 text-telegram-hint"})}),i.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:c.email,onChange:f=>u({...c,email:f.target.value}),className:"block w-full pl-10 pr-3 py-3 border border-telegram-hint/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-telegram-button focus:border-transparent transition-colors duration-200 bg-telegram-secondary-bg text-telegram-text",placeholder:"Enter your email"})]})]})]}),i.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-telegram-button-text bg-telegram-button hover:opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-telegram-button disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?i.jsxs(i.Fragment,{children:[i.jsx(xi,{className:"w-5 h-5 mr-2 animate-spin"}),"Creating Account..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Es,{className:"w-5 h-5 mr-2"}),"Complete Registration"]})})]})]})})},nS=({shop:t,onBack:e})=>{var A;const{db:n}=js(),{webApp:r}=Ns(),[s,a]=V.useState([]),[o,c]=V.useState([]),[u,h]=V.useState("all"),[f,g]=V.useState(!0),[p,N]=V.useState(null),[k,T]=V.useState([]),[D,S]=V.useState(null),[b,I]=V.useState(!1);V.useEffect(()=>{C()},[t.id]);const C=async()=>{try{g(!0),N(null);const v=Ie(n,"categories"),ae=Re(v,be("shopId","==",t.id),be("isActive","==",!0),en("order","asc")),Z=await Me(ae),O=[];Z.forEach(ee=>{var B,Ne;const Q=ee.data();O.push({id:ee.id,userId:Q.userId,shopId:Q.shopId,name:Q.name,description:Q.description,image:Q.image,color:Q.color,icon:Q.icon,order:Q.order||0,isActive:Q.isActive!==!1,productCount:Q.productCount||0,createdAt:((B=Q.createdAt)==null?void 0:B.toDate())||new Date,updatedAt:((Ne=Q.updatedAt)==null?void 0:Ne.toDate())||new Date})}),c(O);const G=Ie(n,"products"),U=Re(G,be("shopId","==",t.id),be("isActive","==",!0),en("name","asc")),q=await Me(U),X=[];q.forEach(ee=>{var B,Ne;const Q=ee.data();X.push({id:ee.id,shopId:Q.shopId,name:Q.name,description:Q.description,price:Q.price,stock:Q.stock||0,category:Q.category,subcategory:Q.subcategory,images:Q.images||[],sku:Q.sku,isActive:Q.isActive!==!1,lowStockAlert:Q.lowStockAlert||0,tags:Q.tags||[],featured:Q.featured||!1,costPrice:Q.costPrice,weight:Q.weight,dimensions:Q.dimensions,createdAt:((B=Q.createdAt)==null?void 0:B.toDate())||new Date,updatedAt:((Ne=Q.updatedAt)==null?void 0:Ne.toDate())||new Date})}),a(X)}catch(v){console.error("Error loading shop data:",v),N("Failed to load shop catalog. Please try again.")}finally{g(!1)}},L=u==="all"?s:s.filter(v=>v.category===u),R=(v,ae=1)=>{var O;if(k.find(G=>G.productId===v.id))T(k.map(G=>G.productId===v.id?{...G,quantity:G.quantity+ae,total:(G.quantity+ae)*G.price}:G));else{const G={productId:v.id,productName:v.name,quantity:ae,price:v.price,total:v.price*ae,productImage:(O=v.images)==null?void 0:O[0],productSku:v.sku};T([...k,G])}},w=(v,ae)=>{ae<=0?T(k.filter(Z=>Z.productId!==v)):T(k.map(Z=>Z.productId===v?{...Z,quantity:ae,total:ae*Z.price}:Z))},x=()=>k.reduce((v,ae)=>v+ae.total,0),_=()=>k.reduce((v,ae)=>v+ae.quantity,0),j=()=>{const ae=`https://t.me/shop_test12345_bot?start=${t.id}`,Z=`Check out ${t.name}! 🛍️

${t.description}

${ae}`;r!=null&&r.openTelegramLink?r.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(ae)}&text=${encodeURIComponent(Z)}`):navigator.share?navigator.share({title:t.name,text:Z,url:ae}):navigator.clipboard.writeText(Z).then(()=>{r!=null&&r.showAlert?r.showAlert("Shop link copied to clipboard!"):alert("Shop link copied to clipboard!")})},E=()=>{var q;if(!((q=t.settings)!=null&&q.businessHours))return"Unknown";const v=new Date,ae=v.toLocaleDateString("en-US",{weekday:"lowercase"}),Z=v.toTimeString().slice(0,5),{open:O,close:G,days:U}=t.settings.businessHours;return U.includes(ae)&&Z>=O&&Z<=G?"Open":"Closed"};return f?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-8 bg-telegram-secondary-bg rounded w-3/4"}),i.jsx("div",{className:"h-32 bg-telegram-secondary-bg rounded"}),i.jsx("div",{className:"space-y-3",children:[1,2,3].map(v=>i.jsx("div",{className:"h-20 bg-telegram-secondary-bg rounded"},v))})]})}):p?i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"Error Loading Catalog"}),i.jsx("p",{className:"text-telegram-hint mb-4",children:p}),i.jsx("button",{onClick:C,className:"bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg",children:"Try Again"})]})}):b?i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("button",{onClick:()=>I(!1),className:"p-2 rounded-lg bg-telegram-secondary-bg",children:i.jsx(cs,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-telegram-text",children:"Shopping Cart"}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:[k.length," item",k.length!==1?"s":""," • $",x().toFixed(2)]})]})]}),k.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Vn,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"Your cart is empty"}),i.jsx("p",{className:"text-telegram-hint",children:"Add some products to get started!"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-3",children:k.map(v=>i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-telegram-text",children:v.productName}),i.jsxs("p",{className:"text-sm text-telegram-hint",children:["$",v.price.toFixed(2)," each"]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>w(v.productId,v.quantity-1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(Wa,{className:"w-4 h-4"})}),i.jsx("span",{className:"text-telegram-text font-medium w-8 text-center",children:v.quantity}),i.jsx("button",{onClick:()=>w(v.productId,v.quantity+1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(yn,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"font-bold text-telegram-text",children:["$",v.total.toFixed(2)]})})]})]})},v.productId))}),i.jsxs("div",{className:"bg-telegram-secondary-bg rounded-lg p-4 space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-telegram-text",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["$",x().toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between text-telegram-text",children:[i.jsx("span",{children:"Tax (10%):"}),i.jsxs("span",{children:["$",(x()*.1).toFixed(2)]})]}),i.jsx("hr",{className:"border-telegram-hint/20"}),i.jsxs("div",{className:"flex justify-between font-bold text-lg text-telegram-text",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{children:["$",(x()*1.1).toFixed(2)]})]})]}),i.jsx("button",{onClick:()=>{var ae;const v=`Hi! I'd like to place an order from ${t.name}:

${k.map(Z=>`• ${Z.productName} x${Z.quantity} - $${Z.total.toFixed(2)}`).join(`
`)}

Total: $${(x()*1.1).toFixed(2)}`;(ae=t.businessInfo)!=null&&ae.phone?window.open(`https://wa.me/${t.businessInfo.phone.replace(/\D/g,"")}?text=${encodeURIComponent(v)}`,"_blank"):r!=null&&r.openTelegramLink&&r.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(v)}`)},className:"w-full bg-telegram-button text-telegram-button-text py-3 rounded-lg font-semibold",children:"Contact Shop to Order"})]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-telegram-secondary-bg p-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-telegram-bg",children:i.jsx(cs,{className:"w-5 h-5 text-telegram-text"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h1",{className:"text-xl font-bold text-telegram-text",children:t.name}),i.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[i.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${E()==="Open"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${E()==="Open"?"bg-green-500":"bg-orange-500"}`}),i.jsx("span",{children:E()})]}),i.jsx("button",{onClick:j,className:"p-1 text-telegram-button hover:bg-telegram-button hover:text-telegram-button-text rounded",title:"Share Shop",children:i.jsx(Pm,{className:"w-4 h-4"})})]})]}),k.length>0&&i.jsxs("button",{onClick:()=>I(!0),className:"relative p-2 rounded-lg bg-telegram-button text-telegram-button-text",children:[i.jsx(Vn,{className:"w-5 h-5"}),i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:_()})]})]}),i.jsx("p",{className:"text-telegram-hint text-sm mb-3",children:t.description}),t.businessInfo&&i.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-telegram-hint",children:[t.businessInfo.address&&i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(km,{className:"w-3 h-3"}),i.jsx("span",{children:t.businessInfo.address})]}),t.businessInfo.phone&&i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(Am,{className:"w-3 h-3"}),i.jsx("span",{children:t.businessInfo.phone})]}),t.businessInfo.website&&i.jsxs("a",{href:t.businessInfo.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-telegram-button",children:[i.jsx(gi,{className:"w-3 h-3"}),i.jsx("span",{children:"Website"}),i.jsx(p2,{className:"w-2 h-2"})]}),((A=t.settings)==null?void 0:A.businessHours)&&i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(Nn,{className:"w-3 h-3"}),i.jsxs("span",{children:[t.settings.businessHours.open," - ",t.settings.businessHours.close]})]})]})]}),o.length>0&&i.jsx("div",{className:"px-4",children:i.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[i.jsxs("button",{onClick:()=>h("all"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap ${u==="all"?"bg-telegram-button text-telegram-button-text":"bg-telegram-secondary-bg text-telegram-text"}`,children:["All (",s.length,")"]}),o.map(v=>i.jsxs("button",{onClick:()=>h(v.name),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap flex items-center space-x-1 ${u===v.name?"bg-telegram-button text-telegram-button-text":"bg-telegram-secondary-bg text-telegram-text"}`,children:[i.jsx("span",{children:v.icon}),i.jsx("span",{children:v.name}),i.jsxs("span",{children:["(",s.filter(ae=>ae.category===v.name).length,")"]})]},v.id))]})}),i.jsx("div",{className:"px-4 space-y-3",children:L.map(v=>{var O;const ae=k.find(G=>G.productId===v.id),Z=v.stock===0;return i.jsx("div",{className:"bg-telegram-secondary-bg rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0 cursor-pointer",onClick:()=>S(v),children:(O=v.images)!=null&&O[0]?i.jsx("img",{src:v.images[0],alt:v.name,className:"w-full h-full object-cover rounded-lg"}):i.jsx(qe,{className:"w-8 h-8 text-telegram-hint"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h3",{className:"font-semibold text-telegram-text truncate cursor-pointer hover:text-telegram-button",onClick:()=>S(v),children:v.name}),v.featured&&i.jsx(Ka,{className:"w-4 h-4 text-yellow-500 fill-current"})]}),i.jsx("p",{className:"text-sm text-telegram-hint mt-1 line-clamp-2 cursor-pointer",onClick:()=>S(v),children:v.description})]}),i.jsxs("div",{className:"text-right ml-2",children:[i.jsxs("div",{className:"text-lg font-bold text-telegram-button",children:["$",v.price.toFixed(2)]}),Z&&i.jsx("span",{className:"text-xs bg-red-500 text-white px-2 py-1 rounded-full",children:"Out of Stock"})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-3",children:[Z?i.jsx("span",{className:"text-sm text-red-500",children:"Out of Stock"}):ae?i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>w(v.id,ae.quantity-1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(Wa,{className:"w-4 h-4"})}),i.jsx("span",{className:"text-telegram-text font-medium",children:ae.quantity}),i.jsx("button",{onClick:()=>w(v.id,ae.quantity+1),className:"w-8 h-8 rounded-full bg-telegram-button text-telegram-button-text flex items-center justify-center",children:i.jsx(yn,{className:"w-4 h-4"})}),i.jsxs("span",{className:"text-sm text-telegram-hint ml-2",children:["$",(ae.quantity*v.price).toFixed(2)]})]}):i.jsxs("button",{onClick:()=>R(v),className:"flex items-center space-x-2 bg-telegram-button text-telegram-button-text px-4 py-2 rounded-lg",children:[i.jsx(yn,{className:"w-4 h-4"}),i.jsx("span",{children:"Add to Cart"})]}),i.jsx("button",{onClick:()=>S(v),className:"text-sm text-telegram-button hover:underline",children:"View Details"})]})]})]})},v.id)})}),L.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(qe,{className:"w-16 h-16 mx-auto text-telegram-hint mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-telegram-text mb-2",children:"No Products Found"}),i.jsx("p",{className:"text-telegram-hint",children:u==="all"?"This shop has no products yet.":`No products found in the ${u} category.`})]}),D&&i.jsx(C0,{product:D,onClose:()=>S(null),onAddToCart:R,cartItem:k.find(v=>v.productId===D.id),onUpdateCartQuantity:w})]})},rS=({currentView:t,onViewChange:e})=>t==="catalog"?null:i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-telegram-secondary-bg border-t border-gray-200",children:i.jsxs("div",{className:"max-w-md mx-auto flex",children:[i.jsxs("button",{onClick:()=>e("shops"),className:`flex-1 py-3 px-4 flex flex-col items-center space-y-1 transition-colors ${t==="shops"?"text-telegram-button":"text-telegram-hint"}`,children:[i.jsx($r,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs font-medium",children:"Shops"})]}),i.jsxs("button",{onClick:()=>e("profile"),className:`flex-1 py-3 px-4 flex flex-col items-center space-y-1 transition-colors ${t==="profile"?"text-telegram-button":"text-telegram-hint"}`,children:[i.jsx(yi,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs font-medium",children:"Profile"})]}),i.jsxs("button",{onClick:()=>e("admin"),className:`flex-1 py-3 px-4 flex flex-col items-center space-y-1 transition-colors ${t==="admin"?"text-telegram-button":"text-telegram-hint"}`,children:[i.jsx(Cm,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs font-medium",children:"Admin"})]})]})}),Rg=()=>{const[t,e]=V.useState({pendingSync:0,lastSyncTime:0,isOnline:!0}),[n,r]=V.useState(!1),[s,a]=V.useState(!1);V.useEffect(()=>{const f=async()=>{const p=await ul.getSyncStatus();e(p),r(!p.isOnline||p.pendingSync>0)};f();const g=setInterval(f,5e3);return()=>clearInterval(g)},[]);const o=async()=>{a(!0);try{await ul.forcSync();const f=await ul.getSyncStatus();e(f)}catch(f){console.error("Force sync failed:",f)}finally{a(!1)}};if(!n)return null;const c=()=>s?i.jsx($d,{className:"w-4 h-4 animate-spin"}):t.isOnline?t.pendingSync>0?i.jsx(Nn,{className:"w-4 h-4"}):i.jsx(Jn,{className:"w-4 h-4"}):i.jsx(j2,{className:"w-4 h-4"}),u=()=>s?"Syncing...":t.isOnline?t.pendingSync>0?`${t.pendingSync} pending`:"Synced":"Offline",h=()=>s?"text-blue-600 bg-blue-100":t.isOnline?t.pendingSync>0?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100":"text-red-600 bg-red-100";return i.jsx("div",{className:"fixed top-4 right-4 z-50",children:i.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg border shadow-sm ${h()}`,children:[c(),i.jsx("span",{className:"text-sm font-medium",children:u()}),t.isOnline&&t.pendingSync>0&&i.jsx("button",{onClick:o,disabled:s,className:"ml-2 p-1 rounded hover:bg-black hover:bg-opacity-10 disabled:opacity-50",title:"Force sync now",children:i.jsx($d,{className:`w-3 h-3 ${s?"animate-spin":""}`})})]})})},sS={apiKey:"AIzaSyAFZNP_u-9liUsLpcyZ_s2J11GGRWPHENQ",authDomain:"shop-9a928.firebaseapp.com",projectId:"shop-9a928",storageBucket:"shop-9a928.firebasestorage.app",messagingSenderId:"99251699558",appId:"1:99251699558:web:9e0ad0870a8fdd2aef12a7"},iS=ev(sS),Yr=KE(iS);function aS(){const[t,e]=V.useState("shops"),[n,r]=V.useState(null),[s,a]=V.useState(null),[o,c]=V.useState(!0),[u,h]=V.useState(!1),[f,g]=V.useState(null),[p,N]=V.useState(null);V.useEffect(()=>{var b,I,C;if((async()=>{try{console.log("Initializing cache sync service..."),await ul.init(Yr,{syncInterval:3e4,batchSize:50,maxRetries:3}),console.log("Cache sync service initialized successfully")}catch(L){console.error("Failed to initialize cache sync service:",L)}})(),(b=window.Telegram)!=null&&b.WebApp){const L=window.Telegram.WebApp;L.ready(),L.expand(),L.setHeaderColor("#2481cc");const R=(I=L.initDataUnsafe)==null?void 0:I.user,w=(C=L.initDataUnsafe)==null?void 0:C.start_param;if(console.log("Telegram start parameter:",w),N(w||null),R){const x={id:R.id.toString(),firstName:R.first_name,lastName:R.last_name||"",username:R.username||"",languageCode:R.language_code||"en",telegramId:R.id};r(x),T(R.id)}else w&&k(w),c(!1)}else{const R=new URLSearchParams(window.location.search).get("shop");R&&(N(R),k(R)),c(!1)}},[]);const k=async S=>{var b,I,C,L;try{console.log("Handling start parameter:",S);let R=await w0(Ht(Yr,"shops",S));if(R.exists()){const j=R.data(),E={id:R.id,ownerId:j.ownerId,name:j.name,slug:j.slug,description:j.description,logo:j.logo,isActive:j.isActive,businessInfo:j.businessInfo,settings:j.settings,stats:j.stats,createdAt:((b=j.createdAt)==null?void 0:b.toDate())||new Date,updatedAt:((I=j.updatedAt)==null?void 0:I.toDate())||new Date};console.log("Found shop:",E),g(E),e("catalog");return}const w=Ie(Yr,"shops"),x=Re(w,be("slug","==",S),be("isActive","==",!0)),_=await Me(x);if(!_.empty){const j=_.docs[0],E=j.data(),A={id:j.id,ownerId:E.ownerId,name:E.name,slug:E.slug,description:E.description,logo:E.logo,isActive:E.isActive,businessInfo:E.businessInfo,settings:E.settings,stats:E.stats,createdAt:((C=E.createdAt)==null?void 0:C.toDate())||new Date,updatedAt:((L=E.updatedAt)==null?void 0:L.toDate())||new Date};console.log("Found shop by slug:",A),g(A),e("catalog");return}console.log("Shop not found for parameter:",S)}catch(R){console.error("Error handling start parameter:",R)}},T=async S=>{var b,I,C,L;try{c(!0);const R=Ie(Yr,"users");let w=await Me(Re(R,be("telegramId","==",S)));if(w.empty&&(w=await Me(Re(R,be("telegram_id","==",S)))),w.empty)h(!0);else{const x=w.docs[0],_=x.data();a({..._,uid:x.id,createdAt:((I=(b=_.createdAt)==null?void 0:b.toDate)==null?void 0:I.call(b))||new Date,updatedAt:((L=(C=_.updatedAt)==null?void 0:C.toDate)==null?void 0:L.call(C))||new Date})}p&&await k(p)}catch(R){console.error("Error checking user in database:",R)}finally{c(!1)}},D=S=>{a(S),h(!1)};return o?i.jsx(Eu,{children:i.jsx(Su,{db:Yr,children:i.jsx("div",{className:"min-h-screen bg-telegram-bg text-telegram-text flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-8 h-8 border-2 border-telegram-button border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-telegram-hint",children:"Loading..."})]})})})}):u&&n?i.jsx(Eu,{children:i.jsx(Su,{db:Yr,children:i.jsxs("div",{className:"min-h-screen bg-telegram-bg text-telegram-text",children:[i.jsx(Rg,{}),i.jsx(tS,{user:n,onComplete:D})]})})}):i.jsx(Eu,{children:i.jsx(Su,{db:Yr,children:i.jsxs("div",{className:"min-h-screen bg-telegram-bg text-telegram-text",children:[i.jsx(Rg,{}),i.jsxs("div",{className:"max-w-md mx-auto",children:[i.jsxs("header",{className:"sticky top-0 z-10 bg-telegram-button text-telegram-button-text p-4 shadow-lg",children:[i.jsx("h1",{className:"text-xl font-bold text-center",children:"Shop Directory"}),n&&i.jsxs("p",{className:"text-sm text-center opacity-80 mt-1",children:["Welcome, ",n.firstName,"!"]})]}),i.jsxs("main",{className:"pb-20",children:[t==="catalog"&&f&&i.jsx(nS,{shop:f,onBack:()=>{e("shops"),g(null)}}),t==="shops"&&i.jsx(S2,{}),t==="profile"&&i.jsx(I2,{user:n,userData:s}),t==="admin"&&i.jsx(eS,{})]}),(s||n)&&i.jsx(rS,{currentView:t,onViewChange:S=>{S!=="catalog"&&g(null),e(S)}})]})]})})})}var Dg;typeof window<"u"&&((Dg=window.Telegram)!=null&&Dg.WebApp)&&(window.Telegram.WebApp.ready(),window.Telegram.WebApp.expand());Tu.createRoot(document.getElementById("root")).render(i.jsx(Wd.StrictMode,{children:i.jsx(aS,{})}));
//# sourceMappingURL=index-DjCGG0z2.js.map
